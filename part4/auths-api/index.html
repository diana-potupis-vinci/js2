<!DOCTYPE html><html lang="fr"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.9.1"/><meta data-react-helmet="true" name="description" content="Authentification et autorisation d&#x27;accès aux opérations d&#x27;une RESTful API via JWT"/><meta data-react-helmet="true" property="og:url" content="https://e-vinci.github.io/js2/js2/part4/auths-api/"/><meta data-react-helmet="true" property="og:title" content="JWT auths API"/><meta data-react-helmet="true" property="og:description" content="Authentification et autorisation d&#x27;accès aux opérations d&#x27;une RESTful API via JWT"/><meta name="theme-color" content="#303030"/><style data-href="/js2/styles.f278fec856444a50b7ed.css" data-identity="gatsby-global-css">*{box-sizing:border-box;margin:0;padding:0}body{overflow-x:hidden}.body,.section{color:#2e2e28;font-family:Roboto Regular,sans-serif;font-size:large;font-weight:400}.section{display:flex;flex-flow:row wrap;min-height:10px;width:100%}.section__content{box-sizing:border-box;flex:1 1 100%;flex-wrap:wrap;padding-left:1rem;padding-right:1rem;padding-top:1rem}.section__content--no-auto-margin{padding-left:0}@media only screen and (min-width:992px){.section__content{flex-basis:50%}}.section__header{align-self:flex-start;flex:1 1 100%;font-family:Baloo Bhaina\ 2 Bold,sans-serif;font-size:x-large;font-weight:300;line-height:1.5rem;min-height:10px;padding-left:1rem;padding-right:1rem;text-align:center}.section__header--left{padding-left:1rem;text-align:left}.section__footer{align-self:flex-end;flex:1 1 100%;justify-content:center;min-height:5vh;padding-bottom:1rem;padding-left:1rem;padding-right:1rem;text-align:center}.section__background{background-size:cover;display:flex;flex-flow:row wrap;min-height:10px;width:100%}.section a{color:#2e2e28;cursor:pointer;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out}.section a:focus,.section a:hover{color:#656558}.header--overlay{left:0;position:absolute;top:0;width:100%;z-index:10}main{background-color:#fff;color:#2e2e28;flex-grow:1}.footer,main{font-family:Roboto Regular,sans-serif;font-size:large;font-weight:400}.footer{background-color:#2e2e28;color:#fff}.footer__icons li:last-of-type{margin-right:0}.footer__background{align-items:center;display:flex;justify-content:space-between;min-height:8vh;padding:1rem}.footer__logo{height:100%}.footer__logo__text{color:#fff;display:inline-block;font-family:MeriendaOne,sans-serif;font-size:1.7rem;font-weight:300}.footer__logo__image{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2MzAgNjMwIj48cmVjdCB3aWR0aD0iNjMwIiBoZWlnaHQ9IjYzMCIgZmlsbD0iI2Y3ZGYxZSIvPjxwYXRoIGQ9Ik00MjMuMiA0OTIuMTljMTIuNjkgMjAuNzIgMjkuMiAzNS45NSA1OC40IDM1Ljk1IDI0LjUzIDAgNDAuMi0xMi4yNiA0MC4yLTI5LjIgMC0yMC4zLTE2LjEtMjcuNDktNDMuMS0zOS4zbC0xNC44LTYuMzVjLTQyLjcyLTE4LjItNzEuMS00MS03MS4xLTg5LjIgMC00NC40IDMzLjgzLTc4LjIgODYuNy03OC4yIDM3LjY0IDAgNjQuNyAxMy4xIDg0LjIgNDcuNGwtNDYuMSAyOS42Yy0xMC4xNS0xOC4yLTIxLjEtMjUuMzctMzguMS0yNS4zNy0xNy4zNCAwLTI4LjMzIDExLTI4LjMzIDI1LjM3IDAgMTcuNzYgMTEgMjQuOTUgMzYuNCAzNS45NWwxNC44IDYuMzRjNTAuMyAyMS41NyA3OC43IDQzLjU2IDc4LjcgOTMgMCA1My4zLTQxLjg3IDgyLjUtOTguMSA4Mi41LTU0Ljk4IDAtOTAuNS0yNi4yLTEwNy44OC02MC41NHptLTIwOS4xMyA1LjEzYzkuMyAxNi41IDE3Ljc2IDMwLjQ1IDM4LjEgMzAuNDUgMTkuNDUgMCAzMS43Mi03LjYxIDMxLjcyLTM3LjJ2LTIwMS4zaDU5LjJ2MjAyLjFjMCA2MS4zLTM1Ljk0IDg5LjItODguNCA4OS4yLTQ3LjQgMC03NC44NS0yNC41My04OC44MS01NC4wNzV6Ii8+PC9zdmc+);background-position:0,100%;min-width:5vw}.footer__logo__image,.footer__logo__image2{background-repeat:no-repeat;background-size:contain;display:inline-block;margin-left:1rem;min-height:5vh;vertical-align:middle}.footer__logo__image2{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1ODkuODI3IiBoZWlnaHQ9IjM2MS4yMzgiIHZlcnNpb249IjEuMiIgdmlld0JveD0iMCAwIDQ0Mi4zNyAyNzAuOTI5Ij48ZGVmcz48Y2xpcFBhdGggaWQ9InByZWZpeF9fYSI+PHBhdGggZD0ibTIzOS4wMyAyMjYuNjA1LTQyLjEzIDI0LjMxN2E1LjA4NSA1LjA4NSAwIDAgMC0yLjU0NiA0LjQwNnY0OC42NjhjMCAxLjgxNy45NjggMy40OTYgMi41NDYgNC40MDZsNDIuMTMzIDI0LjMzNmE1LjEgNS4xIDAgMCAwIDUuMDkgMGw0Mi4xMjYtMjQuMzM2YTUuMDk2IDUuMDk2IDAgMCAwIDIuNTQtNC40MDZ2LTQ4LjY2OGMwLTEuODE2LS45Ny0zLjQ5Ni0yLjU1LTQuNDA2bC00Mi4xMi0yNC4zMTdhNS4xMjMgNS4xMjMgMCAwIDAtNS4xIDAiLz48L2NsaXBQYXRoPjxsaW5lYXJHcmFkaWVudCBpZD0icHJlZml4X19iIiB4MT0iLS4zNDgiIHgyPSIxLjI1MSIgZ3JhZGllbnRUcmFuc2Zvcm09InJvdGF0ZSgxMTYuMTE0IDUzLjEgMjAyLjk3KSBzY2FsZSg4Ni40OCkiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj48c3RvcCBvZmZzZXQ9Ii4zIiBzdG9wLWNvbG9yPSIjM0U4NjNEIi8+PHN0b3Agb2Zmc2V0PSIuNSIgc3RvcC1jb2xvcj0iIzU1OTM0RiIvPjxzdG9wIG9mZnNldD0iLjgiIHN0b3AtY29sb3I9IiM1QUFENDUiLz48L2xpbmVhckdyYWRpZW50PjxjbGlwUGF0aCBpZD0icHJlZml4X19jIj48cGF0aCBkPSJNMTk1LjM5OCAzMDcuMDg2Yy40MDMuNTIzLjkwNy45NzYgMS41IDEuMzE2bDM2LjE0IDIwLjg3NSA2LjAyIDMuNDZjLjkuNTIgMS45MjYuNzQgMi45MzQuNjY1LjMzNi0uMDI3LjY3Mi0uMDkgMS0uMTgzbDQ0LjQzNC04MS4zNmMtLjM0LS4zNy0uNzM4LS42OC0xLjE4NC0uOTRsLTI3LjU4Ni0xNS45My0xNC41ODItOC4zOWE1LjMxOCA1LjMxOCAwIDAgMC0xLjMyLS41M3ptMCAwIi8+PC9jbGlwUGF0aD48bGluZWFyR3JhZGllbnQgaWQ9InByZWZpeF9fZCIgeDE9Ii0uNDU2IiB4Mj0iLjU4MiIgZ3JhZGllbnRUcmFuc2Zvcm09InJvdGF0ZSgtMzYuNDYgNTUwLjg0NiAtMjE0LjMzNykgc2NhbGUoMTMyLjc5OCkiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj48c3RvcCBvZmZzZXQ9Ii41NyIgc3RvcC1jb2xvcj0iIzNFODYzRCIvPjxzdG9wIG9mZnNldD0iLjcyIiBzdG9wLWNvbG9yPSIjNjE5ODU3Ii8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjNzZBQzY0Ii8+PC9saW5lYXJHcmFkaWVudD48Y2xpcFBhdGggaWQ9InByZWZpeF9fZSI+PHBhdGggZD0iTTI0MS4wNjYgMjI1Ljk1M2E1LjE0IDUuMTQgMCAwIDAtMi4wMzUuNjUybC00Mi4wMSAyNC4yNDcgNDUuMyA4Mi41MWMuNjMtLjA5IDEuMjUtLjMgMS44MS0uNjI0bDQyLjEzLTI0LjMzNmE1LjEwNSA1LjEwNSAwIDAgMCAyLjQ2LTMuNDc2bC00Ni4xOC03OC44OWE1LjI5IDUuMjkgMCAwIDAtMS4wMy0uMTAyYy0uMTQgMC0uMjguMDA3LS40Mi4wMiIvPjwvY2xpcFBhdGg+PGxpbmVhckdyYWRpZW50IGlkPSJwcmVmaXhfX2YiIHgxPSIuMDQzIiB4Mj0iLjk4NCIgZ3JhZGllbnRUcmFuc2Zvcm09InRyYW5zbGF0ZSgxOTIuODYyIDI3OS42NTIpIHNjYWxlKDk3LjQxNykiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj48c3RvcCBvZmZzZXQ9Ii4xNiIgc3RvcC1jb2xvcj0iIzZCQkY0NyIvPjxzdG9wIG9mZnNldD0iLjM4IiBzdG9wLWNvbG9yPSIjNzlCNDYxIi8+PHN0b3Agb2Zmc2V0PSIuNDciIHN0b3AtY29sb3I9IiM3NUFDNjQiLz48c3RvcCBvZmZzZXQ9Ii43IiBzdG9wLWNvbG9yPSIjNjU5RTVBIi8+PHN0b3Agb2Zmc2V0PSIuOSIgc3RvcC1jb2xvcj0iIzNFODYzRCIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxwYXRoIGZpbGw9IiM2ODlmNjMiIGQ9Ik0yMTguNjQ3IDI3MC45M2MtMS40NiAwLTIuOTEtLjM4My00LjE5LTEuMTJsLTEzLjMzNy03Ljg5NmMtMS45OTItMS4xMTQtMS4wMi0xLjUwOC0uMzYzLTEuNzM1IDIuNjU2LS45MyAzLjE5NS0xLjE0IDYuMDMtMi43NS4yOTgtLjE3LjY4OC0uMTEuOTkzLjA3bDEwLjI0NiA2LjA4Yy4zNy4yLjg5NS4yIDEuMjM4IDBsMzkuOTUtMjMuMDZjLjM3LS4yMS42MS0uNjQuNjEtMS4wOHYtNDYuMWMwLS40Ni0uMjQtLjg3LS42MTgtMS4xbC0zOS45MzQtMjMuMDRjLS4zNy0uMjItLjg2LS4yMi0xLjIzIDBsLTM5LjkyNiAyMy4wNGMtLjM4Ny4yMi0uNjMzLjY1LS42MzMgMS4wOXY0Ni4xYzAgLjQ0LjI0Ljg2LjYyIDEuMDdsMTAuOTQgNi4zMmM1Ljk0IDIuOTcgOS41Ny0uNTMgOS41Ny00LjA1di00NS41YzAtLjY1LjUxLTEuMTUgMS4xNi0xLjE1aDUuMDZjLjYzIDAgMS4xNS41IDEuMTUgMS4xNXY0NS41MmMwIDcuOTItNC4zMiAxMi40Ny0xMS44MyAxMi40Ny0yLjMxIDAtNC4xMyAwLTkuMjEtMi41bC0xMC40OC02LjA0YTguNDQ3IDguNDQ3IDAgMCAxLTQuMTktNy4yOXYtNDYuMWMwLTMgMS42LTUuOCA0LjE5LTcuMjhsMzkuOTktMjMuMDdjMi41My0xLjQzIDUuODktMS40MyA4LjQgMGwzOS45NCAyMy4wOGE4LjQyOCA4LjQyOCAwIDAgMSA0LjE5IDcuMjh2NDYuMWMwIDIuOTktMS42MSA1Ljc4LTQuMTkgNy4yOGwtMzkuOTQgMjMuMDdhOC4zOTcgOC4zOTcgMCAwIDEtNC4yMSAxLjEyIi8+PHBhdGggZmlsbD0iIzY4OWY2MyIgZD0iTTIzMC45ODcgMjM5LjE2NGMtMTcuNDggMC0yMS4xNDUtOC4wMjQtMjEuMTQ1LTE0Ljc1NCAwLS42NC41MTYtMS4xNSAxLjE1Ny0xLjE1aDUuMTZjLjU3IDAgMS4wNS40MTUgMS4xNC45NzguNzggNS4yNTggMy4xIDcuOTEgMTMuNjcgNy45MSA4LjQyIDAgMTItMS45MDIgMTItNi4zNjcgMC0yLjU3LTEuMDItNC40OC0xNC4xLTUuNzYtMTAuOTQtMS4wOC0xNy43LTMuNDktMTcuNy0xMi4yNCAwLTguMDYgNi44LTEyLjg2IDE4LjE5LTEyLjg2IDEyLjc5IDAgMTkuMTMgNC40NCAxOS45MyAxMy45OGExLjE2NCAxLjE2NCAwIDAgMS0xLjE2IDEuMjZoLTUuMTljLS41NCAwLTEuMDEtLjM4LTEuMTItLjktMS4yNS01LjUzLTQuMjctNy4zLTEyLjQ4LTcuMy05LjE5IDAtMTAuMjYgMy4yLTEwLjI2IDUuNiAwIDIuOTEgMS4yNiAzLjc2IDEzLjY2IDUuNCAxMi4yOCAxLjYzIDE4LjExIDMuOTMgMTguMTEgMTIuNTYgMCA4LjctNy4yNiAxMy42OS0xOS45MiAxMy42OW00OC42Ni00OC44OWgxLjM0YzEuMSAwIDEuMzEtLjc3IDEuMzEtMS4yMiAwLTEuMTgtLjgxLTEuMTgtMS4yNi0xLjE4aC0xLjM4em0tMS42My0zLjc4aDIuOTdjMS4wMiAwIDMuMDIgMCAzLjAyIDIuMjggMCAxLjU5LTEuMDIgMS45Mi0xLjYzIDIuMTIgMS4xOS4wOCAxLjI3Ljg2IDEuNDMgMS45Ni4wOC42OS4yMSAxLjg4LjQ1IDIuMjhoLTEuODNjLS4wNS0uNC0uMzMtMi42LS4zMy0yLjcyLS4xMi0uNDktLjI5LS43My0uOS0uNzNoLTEuNTF2My40NmgtMS42N3ptLTMuNTcgNC4zYzAgMy41OCAyLjg5IDYuNDggNi40NCA2LjQ4IDMuNTggMCA2LjQ3LTIuOTYgNi40Ny02LjQ4IDAtMy41OS0yLjkzLTYuNDQtNi40OC02LjQ0LTMuNSAwLTYuNDQgMi44MS02LjQ0IDYuNDNtMTQuMTYuMDNjMCA0LjI0LTMuNDcgNy43LTcuNyA3LjctNC4yIDAtNy43LTMuNDItNy43LTcuNyAwLTQuMzYgMy41OC03LjcgNy43LTcuNyA0LjE1IDAgNy42OSAzLjM1IDcuNjkgNy43Ii8+PHBhdGggZmlsbD0iI0ZGRiIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNOTQuOTM2IDkwLjU1YzAtMS44NC0uOTctMy41My0yLjU1OC00LjQ0NWwtNDIuMzU2LTI0LjM3YTQuOTQ2IDQuOTQ2IDAgMCAwLTIuMzI4LS42N2gtLjQzOGMtLjgxMi4wMy0xLjYxMy4yNS0yLjM0LjY3TDIuNTYyIDg2LjEwNUE1LjE1NCA1LjE1NCAwIDAgMCAwIDkwLjU1NWwuMDkzIDY1LjY0YzAgLjkxLjQ3IDEuNzYgMS4yNyAyLjIxLjc4LjQ4IDEuNzYuNDggMi41NCAwbDI1LjE4LTE0LjQyYzEuNTktLjk0NiAyLjU2LTIuNjE4IDIuNTYtNC40NFYxMDguODhhNS4xIDUuMSAwIDAgMSAyLjU1NS00LjQzbDEwLjcyLTYuMTc0YTUuMDg2IDUuMDg2IDAgMCAxIDIuNTYtLjY4OGMuODc2IDAgMS43Ny4yMjYgMi41NDQuNjg3bDEwLjcxNSA2LjE3MmMxLjU4Ni45MSAyLjU2IDIuNiAyLjU2IDQuNDN2MzAuNjYzYzAgMS44Mi45ODMgMy41IDIuNTY1IDQuNDRsMjUuMTY0IDE0LjQxYTIuNSAyLjUgMCAwIDAgMi41NiAwIDIuNTY4IDIuNTY4IDAgMCAwIDEuMjY4LTIuMjF6bTE5OS44NjggMzQuMTc2YzAgLjQ1Ny0uMjQzLjg4LS42NCAxLjEwNmwtMTQuNTQ4IDguMzg2YTEuMjgyIDEuMjgyIDAgMCAxLTEuMjc3IDBsLTE0LjU1LTguMzg2Yy0uNC0uMjI3LS42NC0uNjUtLjY0LTEuMTA2VjEwNy45M2MwLS40NTguMjQtLjg4LjYzLTEuMTFsMTQuNTQtOC40Yy40LS4yMy44OS0uMjMgMS4yOSAwbDE0LjU1IDguNGMuNC4yMy42NC42NTIuNjQgMS4xMXpNMjk4LjczNC4zMjRhMi41NjggMi41NjggMCAwIDAtMi41NDQuMDI3Yy0uNzguNDYtMS4yNjIgMS4zLTEuMjYyIDIuMjF2NjVhMS43ODggMS43ODggMCAwIDEtMi42ODQgMS41NUwyODEuNjM0IDYzYTUuMTA4IDUuMTA4IDAgMCAwLTUuMTEyIDBsLTQyLjM3IDI0LjQ1M2E1LjEwNSA1LjEwNSAwIDAgMC0yLjU2IDQuNDJ2NDguOTJjMCAxLjgzLjk3NyAzLjUxIDIuNTYgNC40M2w0Mi4zNyAyNC40N2MxLjU4Mi45MSAzLjUzLjkxIDUuMTE3IDBsNDIuMzctMjQuNDhjMS41OC0uOTIgMi41Ni0yLjYgMi41Ni00LjQzVjE4Ljg2M2E1LjEyOCA1LjEyOCAwIDAgMC0yLjYzLTQuNDd6bTE0MS4wOTMgMTA3LjE2NGE1LjExNiA1LjExNiAwIDAgMCAyLjU0My00LjQyMlY5MS4yMWMwLTEuODI0LS45Ny0zLjUwNy0yLjU0Ny00LjQyNWwtNDIuMS0yNC40NGE1LjExMyA1LjExMyAwIDAgMC01LjEzIDBsLTQyLjM2IDI0LjQ1Yy0xLjU5LjkyLTIuNTYgMi42LTIuNTYgNC40M3Y0OC45YzAgMS44NC45OSAzLjU0IDIuNTggNC40NWw0Mi4wOSAyMy45OWMxLjU1Ljg5IDMuNDUuOSA1LjAyLjAzbDI1LjQ2LTE0LjE1Yy44LS40NSAxLjMxLTEuMyAxLjMxLTIuMjIgMC0uOTItLjQ5LTEuNzgtMS4yOS0yLjIzbC00Mi42Mi0yNC40NmMtLjgtLjQ1LTEuMjktMS4zLTEuMjktMi4yMXYtMTUuMzRjMC0uOTE2LjQ4LTEuNzYgMS4yOC0yLjIxNmwxMy4yNi03LjY1Yy43OS0uNDYgMS43Ni0uNDYgMi41NSAwbDEzLjI3IDcuNjVjLjc5LjQ1IDEuMjggMS4zIDEuMjggMi4yMXYxMi4wNmMwIC45MS40OSAxLjc2IDEuMjggMi4yMi43OS40NSAxLjc3LjQ1IDIuNTYtLjAxem0wIDAiLz48cGF0aCBmaWxsPSIjNjg5ZjYzIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0zOTQuNTM4IDEwNS4yYS45Ny45NyAwIDAgMSAuOTggMGw4LjEzIDQuNjljLjMwNC4xNzYuNDkuNS40OS44NXY5LjM5YzAgLjM1LS4xODYuNjc0LS40OS44NWwtOC4xMyA0LjY5YS45Ny45NyAwIDAgMS0uOTggMGwtOC4xMjUtNC42OWEuOTc5Ljk3OSAwIDAgMS0uNS0uODV2LTkuMzljMC0uMzUuMTgtLjY3NC40OS0uODV6bTAgMCIvPjxnIGNsaXAtcGF0aD0idXJsKCNwcmVmaXhfX2EpIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNzguMzA2IC0xNjQuMDE2KSI+PHBhdGggZmlsbD0idXJsKCNwcmVmaXhfX2IpIiBkPSJtMzMxLjM2MyAyNDYuNzkzLTExOC43MTUtNTguMTktNjAuODcgMTI0LjE3NEwyNzAuNDkgMzcwLjk3em0wIDAiLz48L2c+PGcgY2xpcC1wYXRoPSJ1cmwoI3ByZWZpeF9fYykiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC03OC4zMDYgLTE2NC4wMTYpIj48cGF0aCBmaWxsPSJ1cmwoI3ByZWZpeF9fZCkiIGQ9Im0xNDQuMDcgMjY0LjAwNCA4My44MjUgMTEzLjQ1MyAxMTAuODYtODEuOTA2LTgzLjgzLTExMy40NXptMCAwIi8+PC9nPjxnIGNsaXAtcGF0aD0idXJsKCNwcmVmaXhfX2UpIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNzguMzA2IC0xNjQuMDE2KSI+PHBhdGggZmlsbD0idXJsKCNwcmVmaXhfX2YpIiBkPSJNMTk3LjAyIDIyNS45MzR2MTA3LjQzaDkxLjY4M3YtMTA3LjQzem0wIDAiLz48L2c+PC9zdmc+);background-position:50%;min-width:10vw}.master{display:flex;flex-direction:column;min-height:100vh;position:relative}.page{word-wrap:break-word;overflow-wrap:break-word;word-break:break-word}.page--auto-margin{padding:1rem}.page--auto-margin ol,.page--auto-margin ul{line-height:1.5;margin-bottom:1rem;padding-left:1.3rem;padding-right:1.3rem}@media only screen and (min-width:992px){.page{margin-left:30vw;width:auto}}.page a{color:#2e2e28;cursor:pointer;-webkit-hyphens:auto;hyphens:auto}.page a:focus,.page a:hover{color:#656558}.page h1,.page h2,.page h3,.page h4,.page h5{margin-bottom:.5rem}.page p{line-height:1.5;margin-bottom:1rem}.page p+ul{margin-top:-1rem}.page table{border-collapse:collapse;margin-top:.5rem}.page table td,.page table th{border:thin solid gray;min-width:3rem;padding:.2rem;text-align:left;vertical-align:top}.page pre{margin-bottom:1rem}.page figcaption{margin-bottom:1rem}.page caption,.page figcaption{font-style:italic;opacity:.7}.grid{position:relative}.grid__background-image-wrapper__image{padding:0}.grid__content{display:block;left:0;position:absolute;top:0}.table{border:0;border-bottom:1px solid #ccc;border-collapse:collapse;border-spacing:2px;border-top:3px solid;color:#000;margin:2rem 0;table-layout:fixed;text-indent:0;width:100%}.table td{border:1px solid #ccc;border-bottom:0;border-left:0;border-right:0;padding:.75rem;vertical-align:top;width:75%}.table th{word-wrap:break-word;border:1px solid #ccc;border-bottom:0;border-left:0;-webkit-hyphens:auto;hyphens:auto;padding:.75rem .75rem .75rem 0;text-align:left;vertical-align:top;width:25%}.background{display:flex;z-index:0}.background__image{display:grid}.background--header{z-index:10}.menu{align-items:center;display:flex;list-style:none;margin:0;width:100%}.menu a{color:#fff;font-size:1.3rem}.menu a:hover{color:#bfbfbf;transition:color .3s ease-in}.menu li{margin-right:1rem}.card{background-color:#f9e54f;border-radius:.5rem;display:block;-webkit-hyphens:auto;hyphens:auto;margin-bottom:.5rem;padding:.5rem;width:100%;word-break:break-word}.card--fill-wrapper{height:100%}.card--dark-summary{background-color:#2e2e28;border-radius:0;color:#fff}.card__header{display:block;font-family:Baloo Bhaina\ 2 Bold,sans-serif;font-size:x-large;font-weight:300;line-height:1.5rem;padding:.5rem;text-align:center}.card__content{display:grid;grid-template-columns:1fr 2fr;width:100%}@media only screen and (min-width:576px){.card__content{grid-template-columns:150px 2fr}}.card__content--long-titles{grid-template-columns:2fr 1fr}@media only screen and (min-width:576px){.card__content--long-titles{grid-template-columns:2fr 150px}}.card__content--orange{color:orange!important}.card__content__title{color:#fff;font-weight:300;padding-bottom:.5rem;padding-right:.5rem}.card__content__description{padding-bottom:.5rem}.card__content__description a{color:#2e2e28;cursor:pointer;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out}.card__content__description a:focus,.card__content__description a:hover{color:#656558}.card__content__description input{height:1.3rem;vertical-align:middle;width:1.3rem}.card__content__description__subitems{list-style:none}.card__content__description__subitems__item{border:.5px solid #fff;border-radius:.5rem;margin-bottom:.5rem;padding:.5rem}.card__content__description__subitems__item:last-child{margin-bottom:0}.navbar{align-items:center;background-color:#f7de1e;display:flex;flex-basis:100%;flex-wrap:wrap;font-family:MeriendaOne,sans-serif;font-size:large;font-weight:300;justify-content:space-between;margin:0;padding:1rem;position:relative;width:100%;z-index:100}@media only screen and (min-width:992px){.navbar{justify-content:flex-start}}.navbar__toggler{background-color:transparent;border:1px solid #fff;border-radius:.25rem;cursor:pointer;display:inline-block;font-size:1.25rem;line-height:1;padding:.25rem .75rem;transition:box-shadow .15s ease-in-out}@media only screen and (min-width:992px){.navbar__toggler{display:none}}.navbar__toggler__icon{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' viewBox='0 0 30 30'%3e%3cpath stroke='hsl(0, 0%, 100%)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e")!important;background-position:50%;background-repeat:no-repeat;display:inline-block;height:1.5em;vertical-align:middle;width:1.5em}.navbar__brand{color:#fff;font-size:1.7rem;margin-right:1rem;padding-bottom:.3125rem;padding-top:.3125rem;text-decoration:none;white-space:nowrap}.navbar__menu{align-items:center;display:none;flex-basis:100%;flex-grow:1}.navbar__menu--collapse{display:flex}@media only screen and (min-width:992px){.navbar__menu{display:flex;flex-basis:auto}}.navbar__menu__list{display:flex;flex-direction:column;list-style:none}@media only screen and (min-width:992px){.navbar__menu__list{flex-direction:row}}.navbar__menu__list__item{display:list-item;padding-bottom:.5rem;padding-top:.5rem;position:relative}@media only screen and (min-width:992px){.navbar__menu__list__item{padding-left:.5rem;padding-right:.5rem}}.navbar__menu__list__item__link{color:#fff;cursor:pointer;display:block;text-decoration:none;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out}.navbar__menu__list__item__link:focus,.navbar__menu__list__item__link:hover{color:#ccc}.navbar__menu__list__item__link--dropdown-toggle:after{border-bottom:0;border-left:.3em solid transparent;border-right:.3em solid transparent;border-top:.3em solid;content:"";display:inline-block;margin-left:.255em;vertical-align:.255em}.navbar__menu__list__item__dropdown-menu{background-clip:padding-box;background-color:#fff;border:1px solid #2e2e28;border-radius:.25rem;color:#2e2e28;display:none;left:0;list-style:none;margin-top:.125rem;min-width:10rem;padding:.5rem 0;position:static;text-align:left;top:100%;z-index:1000}@media only screen and (min-width:992px){.navbar__menu__list__item__dropdown-menu{position:absolute}}.navbar__menu__list__item__dropdown-menu--collapsed{display:block}.navbar__menu__list__item__dropdown-menu__item{display:list-item;padding:.5rem;position:relative}.navbar__menu__list__item__dropdown-menu__item:focus,.navbar__menu__list__item__dropdown-menu__item:hover{background-color:#e0e0dc}.navbar__menu__list__item__dropdown-menu__item__link{color:#2e2e28;cursor:pointer;display:block;text-decoration:none;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out}.navbar__menu__list__item__dropdown-menu__item__link:focus,.navbar__menu__list__item__dropdown-menu__item__link:hover{color:#656558}@media only screen and (min-width:992px){.navbar{display:flex;flex-basis:auto}}.navbar--transparent-background{background-color:transparent;background-image:none}.navbar--top-of-page{left:0;position:absolute;top:0}.carousel__wrapper{background-color:#f7de1e;background-image:linear-gradient(180deg,#f7de1e 25%,#faec80);box-sizing:border-box;height:auto;margin-top:1rem;max-width:100%;width:100%}.carousel__wrapper__background{display:block}.carousel__wrapper__background--transparent{background-color:transparent;background-image:none}.quote{display:flex;height:100%;justify-content:center;max-width:100vw;padding:30px 20px 60px;width:100%}.quote--close-to-others{padding-bottom:1rem;padding-top:0}.quote__content{align-self:flex-start;border-bottom:1px solid;border-top:1px solid;color:#fff;padding:30px 0;position:relative}.quote__content--dark-and-wide{color:#2e2e28;padding:30px 0;width:100%}.quote__content h3{color:#fff;position:relative}.quote__content h4{color:#2e2e28;margin:0;padding-top:20px;position:relative}.quote__content h4:before{content:"— "}.quote__content:after{bottom:-43px;color:#fff;content:"”";font-size:10rem;line-height:0;position:absolute;right:30px}.schedule{color:#2e2e28;display:flex;flex-direction:column;font-family:Roboto Regular,sans-serif;font-size:large;font-weight:400;gap:.5rem;width:100%}.schedule__header1,.schedule__header2,.schedule__header3,.schedule__header4{display:block;font-family:Baloo Bhaina\ 2 Bold,sans-serif;font-size:x-large;font-size:large;font-weight:300;line-height:1.5rem;text-align:left}.schedule__title{display:block;font-family:Baloo Bhaina\ 2 Bold,sans-serif;font-size:x-large;font-size:medium;font-weight:300;line-height:1.5rem}.schedule__title1:not(.schedule__title),.schedule__title2:not(.schedule__title),.schedule__title3:not(.schedule__title),.schedule__title4:not(.schedule__title){display:none}.schedule__session{background-color:#f9e54f;border-radius:.5rem;display:flex;flex-direction:row;flex-wrap:wrap;min-height:5rem;padding:.5rem;width:100%}.schedule__session__title{align-self:flex-start;color:#fff;font-weight:700;text-align:center;width:100%}.schedule__session__time{align-self:flex-end;font-weight:700;text-align:center;width:100%}@media only screen and (min-width:576px){.schedule{color:#2e2e28;display:grid;font-family:Roboto Regular,sans-serif;font-size:large;font-weight:400;grid-template:"headertitle header1 header2  header3  header4" "scheduletitle1 monday1 wednesday1 thursday1 friday1" "scheduletitle2 monday2 wednesday2 thursday2 friday2" "scheduletitle3 monday3 wednesday3 thursday3 friday3" "scheduletitle4 monday4 wednesday4 thursday4 friday4";grid-template-columns:repeat(5,1fr);width:100%}.schedule__title1{display:block;font-size:large;grid-area:scheduletitle1}.schedule__title2{display:block;font-size:large;grid-area:scheduletitle2}.schedule__title3{display:block;font-size:large;grid-area:scheduletitle3}.schedule__title4{display:block;font-size:large;grid-area:scheduletitle4}.schedule__header1{grid-area:header1;text-align:center}.schedule__header2{grid-area:header2;text-align:center}.schedule__header3{grid-area:header3;text-align:center}.schedule__header4{grid-area:header4;text-align:center}.schedule__monday1{grid-area:monday1}.schedule__monday2{grid-area:monday2}.schedule__monday3{grid-area:monday3}.schedule__monday4{grid-area:monday4}.schedule__wednesday1{grid-area:wednesday1}.schedule__wednesday2{grid-area:wednesday2}.schedule__wednesday3{grid-area:wednesday3}.schedule__wednesday4{grid-area:wednesday4}.schedule__thursday1{grid-area:thursday1}.schedule__thursday2{grid-area:thursday2}.schedule__thursday3{grid-area:thursday3}.schedule__thursday4{grid-area:thursday4}.schedule__friday1{grid-area:friday1}.schedule__friday2{grid-area:friday2}.schedule__friday3{grid-area:friday3}.schedule__friday4{grid-area:friday4}.schedule__title:not(.schedule__title1):not(.schedule__title2):not(.schedule__title3):not(.schedule__title4){display:none}}.list{padding-left:1rem;padding-top:1rem}.index{grid-gap:1rem;display:grid;grid-template-columns:1fr}@media only screen and (min-width:576px){.index{grid-template-columns:1fr 1fr}}@media only screen and (min-width:1200px){.index{grid-template-columns:1fr 1fr 1fr}}.index__search{display:block;grid-column-end:-1;grid-column-start:1;margin-bottom:1rem;margin-top:1rem;padding:.5rem;width:100%}.index__button{background-color:#2e2e28;border:none;border-radius:.25rem;color:#fff;cursor:pointer;display:inline-block;margin-top:1rem;padding:.375rem .75rem;text-align:center;vertical-align:middle}.index__button:hover{background-color:#4a4a40}.index__card{background-color:#f9e54f;border-radius:.5rem;display:block;-webkit-hyphens:auto;hyphens:auto;padding:.5rem;width:100%;word-break:break-word}.index__card__header{display:block;font-family:Baloo Bhaina\ 2 Bold,sans-serif;font-size:x-large;font-weight:300;line-height:1.5rem;padding:.5rem;text-align:center}.index__card__content{display:grid;grid-template-columns:1fr 2fr;width:100%}.index__card__content__title{color:#fff;font-weight:300;padding-bottom:.5rem;padding-right:.5rem}.index__card__content__description{padding-bottom:.5rem}.index__card__content__description a{color:#2e2e28;cursor:pointer;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out}.index__card__content__description a:focus,.index__card__content__description a:hover{color:#656558}.index__card__content__description input{height:1.3rem;vertical-align:middle;width:1.3rem}.index__card__content__description__subitems{list-style:none}.index__card__content__description__subitems__item{border:.5px solid #fff;border-radius:.5rem;margin-bottom:.5rem;padding:.5rem}.index__card__content__description__subitems__item:last-child{margin-bottom:0}.index__card__content__description--is-being-edited{background-color:#fff;margin-bottom:.5rem;padding:.3rem}.index__card__content__description--is-inline{display:inline-block}.index__card--is-being-edited{animation:gradient 2s linear infinite;animation-direction:alternate;background:linear-gradient(45deg,#f7de1e,#f7cc1e,#f7b91e,#f7a71e,#f7951e,#f7831e);background-size:600% 100%}@keyframes gradient{0%{background-position:0}to{background-position:100%}}.index .fa-plus-circle{margin-right:.5rem}.index .fa-check-circle{color:green;font-size:1.5rem}.index .fa-minus-circle,.index .fa-times-circle{color:red;font-size:1.5rem}.index .fa-comment-dots,.index .fa-edit,.index .fa-eye,.index .fa-save,.index .fa-times,.index .fa-trash-alt,.index .fa-user-plus,.index .fa-user-times{cursor:pointer;margin-bottom:.5rem;margin-right:.5rem}.index .fa-comment-dots:hover,.index .fa-edit:hover,.index .fa-eye:hover,.index .fa-save:hover,.index .fa-times:hover,.index .fa-trash-alt:hover,.index .fa-user-plus:hover,.index .fa-user-times:hover{color:#4a4a40}.index--long-text{grid-column-end:-1;grid-column-start:1}@media only screen and (min-width:576px){.index--long-text .index__card__content{grid-template-columns:200px 1fr!important}}.spinner__overlay{background:rgba(0,0,0,.7);bottom:0;left:0;position:fixed;right:0;top:0;z-index:5}.spinner__animation{color:#f7de1e;left:50%;position:fixed;top:50%;transform:translate(-50%,-50%);z-index:10}.summary{grid-gap:1rem;display:grid;grid-template-columns:1fr;padding-top:1rem}@media only screen and (min-width:576px){.summary{grid-template-columns:1fr 1fr}}.summary__card-wrapper{display:block;width:100%}.summary__card-wrapper:only-child{grid-column-end:-1;grid-column-start:1;margin-left:auto;margin-right:auto;width:100%}@media only screen and (min-width:576px){.summary__card-wrapper:only-child{width:50%}}@media only screen and (min-width:1200px){.summary__card-wrapper:only-child{width:33%}}.summary .fa-comment,.summary .fa-heart{margin-right:.5rem}.summary .fa-heart{color:red}.summary .fa-comment{color:green}.counter{background-color:#2e2e28;display:flex;justify-content:space-evenly;padding-bottom:.5rem;padding-top:.5rem}.counter__symbol{margin-right:.2rem}.counter__symbol--red{color:red}.counter__symbol--orange{color:orange}.counter__symbol--green{color:green}.codeblock{margin-bottom:.5rem;margin-top:.5rem;overflow:auto}.codeblock pre[class*=language-]{float:left;min-width:100%;padding:.5rem}.codeblock__header{border-bottom:thin solid #9acd32;display:flex;justify-content:flex-start;margin-bottom:.5rem;padding-bottom:.3rem;padding-top:.3rem}.codeblock__header__copy-button{background:none;border:none;color:#fff;cursor:pointer;padding-right:1rem}.codeblock__header__language-name{color:#9acd32}.codeblock__body__line{display:block;min-width:100%}.codeblock__body__line--highlighted{background-color:#353b45}.codeblock__body__line__number{display:table-cell;opacity:.5;-webkit-user-select:none;user-select:none;width:2.5rem}.codeblock__body__line__content{display:table-cell}.scrollable-image{overflow:auto}.scrollable-image__wrapper{display:inline-block;width:100%}.page-menu{padding-bottom:1.3rem;width:-webkit-max-content;width:max-content}@media only screen and (min-width:992px){.page-menu{height:calc(100% - 120px);left:0;overflow-y:auto;position:fixed;top:160px;width:30vw;z-index:10}.page-menu--sticky{position:relative;top:0;width:-webkit-max-content;width:max-content}}.page-menu__item{background-color:#fff;border:2px solid #33332d;border-radius:0 50px 50px 0;cursor:pointer;display:flex;flex-wrap:wrap;justify-content:flex-start;overflow:hidden;padding:.5rem;position:relative;z-index:10}.page-menu__item:not(:last-child){border-bottom:none}.page-menu__item--selected,.page-menu__item:hover{background-color:#2e2e28;color:#fff!important}.path-viewer{display:flex;flex-direction:row;flex-wrap:wrap;margin-bottom:1.3rem}.path-viewer__item{background-color:#fff;border:2px solid #33332d;border-radius:0 50px 50px 0;cursor:pointer;margin-bottom:2px;overflow:hidden;padding:.5rem;position:relative;z-index:10}.path-viewer__item--selected,.path-viewer__item:hover{background-color:#2e2e28;color:#fff!important}.path-viewer__item--selected{cursor:text!important}@font-face{font-display:swap;font-family:Kavoon;src:url(/js2/static/Kavoon-Regular-942c5ec99a683f33cbd21f88d0c771dc.ttf)}@font-face{font-display:swap;font-family:MeriendaOne;font-size:15vh;src:url(/js2/static/MeriendaOne-Regular-e9c591ea2539ec7dc624851057cb737b.ttf)}@font-face{font-display:swap;font-family:Apercu Pro Regular;src:url("/js2/static/Apercu Pro Regular-c90f8890213c974793f9a1f665d86410.otf")}@font-face{font-display:swap;font-family:Roboto Regular;src:url(/js2/static/Roboto-Regular-a8d6ac03c7b96b7acb6228ff2676139d.ttf)}@font-face{font-display:swap;font-family:Baloo Bhaina\ 2 Bold;src:url(/js2/static/BalooBhaina2-Bold-0c4963b78753a15075509a388f17234e.ttf)}h1{font-size:2rem;line-height:2rem}h1,h2{color:#2e2e28;font-family:Baloo Bhaina\ 2 Bold,sans-serif;font-weight:300}h2{font-size:1.5rem;line-height:1.5rem}h3{font-family:Baloo Bhaina\ 2 Bold,sans-serif;font-size:1.3rem;font-style:italic;font-weight:300;line-height:1.3rem}.text,h3{color:#2e2e28}.text{font-family:Roboto Regular,sans-serif;font-size:large;font-weight:400}.text--light{color:#fff!important}.text--italic{font-style:italic!important}.text--emphasized{font-family:Baloo Bhaina\ 2 Bold,sans-serif;font-size:x-large;font-weight:300;line-height:1.5rem}.text--hand-written{font-family:MeriendaOne,sans-serif;font-size:large;font-weight:300}a{color:#2e2e28;cursor:pointer;-webkit-hyphens:auto;hyphens:auto}a:focus,a:hover{color:#656558}code{color:#d63384}.ml-0{margin-left:0!important}.ml-1{margin-left:.25rem!important}.ml-2{margin-left:.5rem!important}.ml-3{margin-left:1rem!important}.ml-4{margin-left:1.5rem!important}.ml-5{margin-left:3rem!important}.mt-0{margin-top:0!important}.mt-1{margin-top:.25rem!important}.mt-2{margin-top:.5rem!important}.mt-3{margin-top:1rem!important}.mt-4{margin-top:1.5rem!important}.mt-5{margin-top:3rem!important}.mb-0{margin-bottom:0!important}.mb-1{margin-bottom:.25rem!important}.mb-2{margin-bottom:.5rem!important}.mb-3{margin-bottom:1rem!important}.mb-4{margin-bottom:1.5rem!important}.mb-5{margin-bottom:3rem!important}.mr-0{margin-right:0!important}.mr-1{margin-right:.25rem!important}.mr-2{margin-right:.5rem!important}.mr-3{margin-right:1rem!important}.mr-4{margin-right:1.5rem!important}.mr-5{margin-right:3rem!important}.pl-0{padding-left:0!important}.pl-1{padding-left:.25rem!important}.pl-2{padding-left:.5rem!important}.pl-3{padding-left:1rem!important}.pl-4{padding-left:1.5rem!important}.pl-5{padding-left:3rem!important}.pt-0{padding-top:0!important}.pt-1{padding-top:.25rem!important}.pt-2{padding-top:.5rem!important}.pt-3{padding-top:1rem!important}.pt-4{padding-top:1.5rem!important}.pt-5{padding-top:3rem!important}.pb-0{padding-bottom:0!important}.pb-1{padding-bottom:.25rem!important}.pb-2{padding-bottom:.5rem!important}.pb-3{padding-bottom:1rem!important}.pb-4{padding-bottom:1.5rem!important}.pb-5{padding-bottom:3rem!important}.pr-0{padding-right:0!important}.pr-1{padding-right:.25rem!important}.pr-2{padding-right:.5rem!important}.pr-3{padding-right:1rem!important}.pr-4{padding-right:1.5rem!important}.pr-5{padding-right:3rem!important}.vh-5{height:5vh}.vh-10{height:10vh}.vh-15{height:15vh}.vh-20{height:20vh}.vh-25{height:25vh}.vh-30{height:30vh}.vh-35{height:35vh}.vh-40{height:40vh}.vh-45{height:45vh}.vh-50{height:50vh}.vh-55{height:55vh}.vh-60{height:60vh}.vh-65{height:65vh}.vh-70{height:70vh}.vh-75{height:75vh}.vh-80{height:80vh}.vh-85{height:85vh}.vh-90{height:90vh}.vh-95{height:95vh}.vh-100{height:100vh}.vw-5{flex-basis:5vw;width:5vw}.vw-10{flex-basis:10vw;width:10vw}.vw-15{flex-basis:15vw;width:15vw}.vw-20{flex-basis:20vw;width:20vw}.vw-25{flex-basis:25vw;width:25vw}.vw-30{flex-basis:30vw;width:30vw}.vw-35{flex-basis:35vw;width:35vw}.vw-40{flex-basis:40vw;width:40vw}.vw-45{flex-basis:45vw;width:45vw}.vw-50{flex-basis:50vw;width:50vw}.vw-55{flex-basis:55vw;width:55vw}.vw-60{flex-basis:60vw;width:60vw}.vw-65{flex-basis:65vw;width:65vw}.vw-70{flex-basis:70vw;width:70vw}.vw-75{flex-basis:75vw;width:75vw}.vw-80{flex-basis:80vw;width:80vw}.vw-85{flex-basis:85vw;width:85vw}.vw-90{flex-basis:90vw;width:90vw}.vw-95{flex-basis:95vw;width:95vw}.vw-100{flex-basis:100vw;width:100vw}.w-5{flex-basis:5%;width:5%}.w-10{flex-basis:10%;width:10%}.w-15{flex-basis:15%;width:15%}.w-20{flex-basis:20%;width:20%}.w-25{flex-basis:25%;width:25%}.w-30{flex-basis:30%;width:30%}.w-35{flex-basis:35%;width:35%}.w-40{flex-basis:40%;width:40%}.w-45{flex-basis:45%;width:45%}.w-50{flex-basis:50%;width:50%}.w-55{flex-basis:55%;width:55%}.w-60{flex-basis:60%;width:60%}.w-65{flex-basis:65%;width:65%}.w-70{flex-basis:70%;width:70%}.w-75{flex-basis:75%;width:75%}.w-80{flex-basis:80%;width:80%}.w-85{flex-basis:85%;width:85%}.w-90{flex-basis:90%;width:90%}.w-95{flex-basis:95%;width:95%}.w-100{flex-basis:100%;width:100%}.svg-inline--fa,svg:not(:root).svg-inline--fa{overflow:visible}.svg-inline--fa{display:inline-block;font-size:inherit;height:1em;vertical-align:-.125em}.svg-inline--fa.fa-lg{vertical-align:-.225em}.svg-inline--fa.fa-w-1{width:.0625em}.svg-inline--fa.fa-w-2{width:.125em}.svg-inline--fa.fa-w-3{width:.1875em}.svg-inline--fa.fa-w-4{width:.25em}.svg-inline--fa.fa-w-5{width:.3125em}.svg-inline--fa.fa-w-6{width:.375em}.svg-inline--fa.fa-w-7{width:.4375em}.svg-inline--fa.fa-w-8{width:.5em}.svg-inline--fa.fa-w-9{width:.5625em}.svg-inline--fa.fa-w-10{width:.625em}.svg-inline--fa.fa-w-11{width:.6875em}.svg-inline--fa.fa-w-12{width:.75em}.svg-inline--fa.fa-w-13{width:.8125em}.svg-inline--fa.fa-w-14{width:.875em}.svg-inline--fa.fa-w-15{width:.9375em}.svg-inline--fa.fa-w-16{width:1em}.svg-inline--fa.fa-w-17{width:1.0625em}.svg-inline--fa.fa-w-18{width:1.125em}.svg-inline--fa.fa-w-19{width:1.1875em}.svg-inline--fa.fa-w-20{width:1.25em}.svg-inline--fa.fa-pull-left{margin-right:.3em;width:auto}.svg-inline--fa.fa-pull-right{margin-left:.3em;width:auto}.svg-inline--fa.fa-border{height:1.5em}.svg-inline--fa.fa-li{width:2em}.svg-inline--fa.fa-fw{width:1.25em}.fa-layers svg.svg-inline--fa{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.fa-layers{display:inline-block;height:1em;position:relative;text-align:center;vertical-align:-.125em;width:1em}.fa-layers svg.svg-inline--fa{-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter,.fa-layers-text{display:inline-block;position:absolute;text-align:center}.fa-layers-text{left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter{background-color:#ff253a;border-radius:1em;-webkit-box-sizing:border-box;box-sizing:border-box;color:#fff;height:1.5em;line-height:1;max-width:5em;min-width:1.5em;overflow:hidden;padding:.25em;right:0;text-overflow:ellipsis;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-bottom-right{bottom:0;right:0;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom right;transform-origin:bottom right}.fa-layers-bottom-left{bottom:0;left:0;right:auto;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom left;transform-origin:bottom left}.fa-layers-top-right{right:0;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-top-left{left:0;right:auto;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top left;transform-origin:top left}.fa-lg{font-size:1.33333em;line-height:.75em;vertical-align:-.0667em}.fa-xs{font-size:.75em}.fa-sm{font-size:.875em}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:2.5em;padding-left:0}.fa-ul>li{position:relative}.fa-li{left:-2em;line-height:inherit;position:absolute;text-align:center;width:2em}.fa-border{border:.08em solid #eee;border-radius:.1em;padding:.2em .25em .15em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left,.fab.fa-pull-left,.fal.fa-pull-left,.far.fa-pull-left,.fas.fa-pull-left{margin-right:.3em}.fa.fa-pull-right,.fab.fa-pull-right,.fal.fa-pull-right,.far.fa-pull-right,.fas.fa-pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s linear infinite;animation:fa-spin 2s linear infinite}.fa-pulse{-webkit-animation:fa-spin 1s steps(8) infinite;animation:fa-spin 1s steps(8) infinite}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.fa-rotate-90{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";-webkit-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";-webkit-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";-webkit-transform:scaleX(-1);transform:scaleX(-1)}.fa-flip-vertical{-webkit-transform:scaleY(-1);transform:scaleY(-1)}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical,.fa-flip-vertical{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)"}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical{-webkit-transform:scale(-1);transform:scale(-1)}:root .fa-flip-both,:root .fa-flip-horizontal,:root .fa-flip-vertical,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-rotate-90{-webkit-filter:none;filter:none}.fa-stack{display:inline-block;height:2em;position:relative;width:2.5em}.fa-stack-1x,.fa-stack-2x{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.svg-inline--fa.fa-stack-1x{height:1em;width:1.25em}.svg-inline--fa.fa-stack-2x{height:2em;width:2.5em}.fa-inverse{color:#fff}.sr-only{clip:rect(0,0,0,0);border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.sr-only-focusable:active,.sr-only-focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}.svg-inline--fa .fa-primary{fill:var(--fa-primary-color,currentColor);opacity:1;opacity:var(--fa-primary-opacity,1)}.svg-inline--fa .fa-secondary{fill:var(--fa-secondary-color,currentColor)}.svg-inline--fa .fa-secondary,.svg-inline--fa.fa-swap-opacity .fa-primary{opacity:.4;opacity:var(--fa-secondary-opacity,.4)}.svg-inline--fa.fa-swap-opacity .fa-secondary{opacity:1;opacity:var(--fa-primary-opacity,1)}.svg-inline--fa mask .fa-primary,.svg-inline--fa mask .fa-secondary{fill:#000}.fad.fa-inverse{color:#fff}</style><title data-react-helmet="true">JWT auths API</title><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/js2/favicon-32x32.png" type="image/png"/><link rel="icon" href="/js2/favicon.svg" type="image/svg+xml"/><link rel="manifest" href="/js2/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/js2/icons/icon-48x48.png"/><link rel="apple-touch-icon" sizes="72x72" href="/js2/icons/icon-72x72.png"/><link rel="apple-touch-icon" sizes="96x96" href="/js2/icons/icon-96x96.png"/><link rel="apple-touch-icon" sizes="144x144" href="/js2/icons/icon-144x144.png"/><link rel="apple-touch-icon" sizes="192x192" href="/js2/icons/icon-192x192.png"/><link rel="apple-touch-icon" sizes="256x256" href="/js2/icons/icon-256x256.png"/><link rel="apple-touch-icon" sizes="384x384" href="/js2/icons/icon-384x384.png"/><link rel="apple-touch-icon" sizes="512x512" href="/js2/icons/icon-512x512.png"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="master"><header class="header "><nav class="navbar "><a class="navbar__brand" href="/js2/">web2course</a><button class="navbar__toggler" type="button" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar__toggler__icon"></span></button><div class="navbar__menu " id="navbarSupportedContent"><ul class="navbar__menu__list"><li class="navbar__menu__list__item"><a class="navbar__menu__list__item__link navbar__menu__list__item__link--dropdown-toggle">Contenu du cours</a><ul class="navbar__menu__list__item__dropdown-menu " aria-labelledby="navbarDropdown"><li class="navbar__menu__list__item__dropdown-menu__item"><a class="navbar__menu__list__item__dropdown-menu__item__link" href="/js2/part0/">Partie 0 : Info &amp; intro</a></li><li class="navbar__menu__list__item__dropdown-menu__item"><a class="navbar__menu__list__item__dropdown-menu__item__link" href="/js2/part1/">Partie 1 : Services web</a></li><li class="navbar__menu__list__item__dropdown-menu__item"><a class="navbar__menu__list__item__dropdown-menu__item__link" href="/js2/part2/">Partie 2 : IHM</a></li><li class="navbar__menu__list__item__dropdown-menu__item"><a class="navbar__menu__list__item__dropdown-menu__item__link" href="/js2/part3/">Partie 3 : Déploiement</a></li><li class="navbar__menu__list__item__dropdown-menu__item"><a class="navbar__menu__list__item__dropdown-menu__item__link" href="/js2/part4/">Partie 4 : Sécurisation</a></li><li class="navbar__menu__list__item__dropdown-menu__item"><a class="navbar__menu__list__item__dropdown-menu__item__link" href="/js2/essentials/">L&#x27;essentiel</a></li><li class="navbar__menu__list__item__dropdown-menu__item"><a class="navbar__menu__list__item__dropdown-menu__item__link" href="/js2/references/">Bibliographie</a></li></ul></li><li class="navbar__menu__list__item"><a class="navbar__menu__list__item__link navbar__menu__list__item__link--dropdown-toggle">Vitrines de projets</a><ul class="navbar__menu__list__item__dropdown-menu " aria-labelledby="navbarDropdown"><li class="navbar__menu__list__item__dropdown-menu__item"><a class="navbar__menu__list__item__dropdown-menu__item__link" href="/js2/public-projects/showcase2022/">Projets web 2022</a></li></ul></li><li class="navbar__menu__list__item"><a class="navbar__menu__list__item__link" href="/js2/about/">About</a></li><li class="navbar__menu__list__item"><a class="navbar__menu__list__item__link" href="/js2/repo/">Repositories</a></li><li class="navbar__menu__list__item"><span class="navbar__menu__list__item__link"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:24px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg%20height=&#x27;22&#x27;%20width=&#x27;24&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAACE3AAAhNwEzWJ96AAAD40lEQVR42l2Tf2wURRTHp3d/iHWXghRNg/iDBA1po0mjJkY0Rlt3bWLS6D8SYwQT/c8fdLdFU7GKJHjF0p2rFkN7iyYWq3DX3s6WaimkkhRrWhSiINLdQjUaG2YrWiVX7naemdm5A5nk5c3u2/3s9833LUIIId12eZRFmTyrp8j3uu1O6rbbKGsxzSYx3Sa83qDZ7re67Z7QbXejZrtIk++WliZe4AXyoG67cHVoKbdWQnlUazZhV2qE58eKHy0B9ZQb16KbbfLhRS1FFuV+VEuVgKRY1203J/c7pMq4gDkeRRv6D8drcT9q2DvUKB8KtRRhWooUuAotRZ7QUuQRuS9cXXu8lzzzdN8Ieqg7HVdMSwDL0LoGNHzuT9Rx7Ax6dE/WldACB8v9T7rtnip+TNagYe/QoZtau1FFS1KIUw1chogfoNFf/kb7z8xVn/0Hbmv+cur5+hSBul4S1vUSVt9LCnW94hrq5T1Zg3s6+l5EL2y7dVlLV015U2dMNTFCxKerHY8eI36Qy3r00sjsxYWXshOXq60DcH93ltUkB1jV+5mwamcmrE4OsHs/HGD37c7C2sSnhfKmzgXVxJcUw8qpJp5UTLyGt/yZ41EgfsB4PjgzD/tO/Q7r97isJpmBle0ZuDGRFlHZnoa7uwahtivDlm/5ABTDAtXEPDOeVROnecsnOcjxaI74QX5wmuYPzf5VaD18Mrxl535W2T7AVrZnRCxPpNmdOAt3bP+YlW/eVVBNnFcMK6+aOCfgBj7BgW8SPwDHF1CQaoF4FB7o+Sos3/4FV8lWJNJQ8V4aViU+Z8uakyV118S7whTHC14nfvC149Ex4gdHB6fp6Mj5i78mp87DmiRhle0ZWJFIs7u6h9mqd2y4fvOu31QTjyqGdVQ18ZhqYp63KqYV46YIKPGCKPsBGpqZvy7r0dPD5+ahbfznwlOZCXhu6Dhr7B8LVcMCxcTe8pauGxTDQiJMjLjDiiFcDpDjB3E+4MQP4pFi2sZbH/KD/L7Tf8ArR34MXz7yQ3j7NhuWvNaRXxoZsYPDVBPHJTAaG8cvKYtJ2FrHo//yc8x6lB2cCcLO72bh4R4XlrzaES5txkye36JqWOskVMAEsPj7FdURP+iR5uQdjzLXDyBz9sLcza2758qbOjmISWf5/hP+u/GzU4owvqK2aSxSS8eF63yMPJobnL4Ak/TyJrTp7Q0VkbuLQh1v28THOUgxcdn/gALqBXFpzJbS6ETgKQBAT340yFsavzLMQuFW1YjOD127BMwTSvkRvEE8+o3j0T7iB6sXABBav5E7WsXbVE08oRj4LdWwyiSwBPoPG+UO5GZCPnYAAAAASUVORK5CYII=" alt=""/><picture><source type="image/webp" data-srcset="/js2/static/309e0fb8b4416829acfed4f7a501206b/0c9a1/logo_vinci.webp 6w,/js2/static/309e0fb8b4416829acfed4f7a501206b/14c62/logo_vinci.webp 12w,/js2/static/309e0fb8b4416829acfed4f7a501206b/40fc0/logo_vinci.webp 24w,/js2/static/309e0fb8b4416829acfed4f7a501206b/9ce7e/logo_vinci.webp 48w" sizes="(min-width: 24px) 24px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 24px) 24px, 100vw" decoding="async" loading="lazy" data-src="/js2/static/309e0fb8b4416829acfed4f7a501206b/5a745/logo_vinci.png" data-srcset="/js2/static/309e0fb8b4416829acfed4f7a501206b/120b9/logo_vinci.png 6w,/js2/static/309e0fb8b4416829acfed4f7a501206b/06be0/logo_vinci.png 12w,/js2/static/309e0fb8b4416829acfed4f7a501206b/5a745/logo_vinci.png 24w,/js2/static/309e0fb8b4416829acfed4f7a501206b/62498/logo_vinci.png 48w" alt=""/></picture><noscript><picture><source type="image/webp" srcSet="/js2/static/309e0fb8b4416829acfed4f7a501206b/0c9a1/logo_vinci.webp 6w,/js2/static/309e0fb8b4416829acfed4f7a501206b/14c62/logo_vinci.webp 12w,/js2/static/309e0fb8b4416829acfed4f7a501206b/40fc0/logo_vinci.webp 24w,/js2/static/309e0fb8b4416829acfed4f7a501206b/9ce7e/logo_vinci.webp 48w" sizes="(min-width: 24px) 24px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 24px) 24px, 100vw" decoding="async" loading="lazy" src="/js2/static/309e0fb8b4416829acfed4f7a501206b/5a745/logo_vinci.png" srcSet="/js2/static/309e0fb8b4416829acfed4f7a501206b/120b9/logo_vinci.png 6w,/js2/static/309e0fb8b4416829acfed4f7a501206b/06be0/logo_vinci.png 12w,/js2/static/309e0fb8b4416829acfed4f7a501206b/5a745/logo_vinci.png 24w,/js2/static/309e0fb8b4416829acfed4f7a501206b/62498/logo_vinci.png 48w" alt=""/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></span></li></ul></div></nav></header><main class="main"><div class="page page--auto-margin"><div class="path-viewer"><a class="path-viewer__item " id="item_web_2_course" href="/js2/"> web2course </a><a class="path-viewer__item " id="item_partie_4" href="/js2/part4/"> Partie 4 </a><a aria-current="page" class="path-viewer__item path-viewer__item--selected" id="item_a_jwt_auths_api" href="/js2/part4/auths-api/"> a) JWT auths &amp; API </a></div>
<h1>a) Authentification et autorisation d&#x27;accès aux opérations d&#x27;une RESTful API via JWT</h1>
<div class="page-menu "><a class="page-menu__item " id="item_cest_quoi_lauthentification_et_lautorisation" href="/js2/part4/auths-api/#cest_quoi_lauthentification_et_lautorisation"> C&#x27;est quoi l&#x27;authentification et l&#x27;autorisation ? </a><a class="page-menu__item " id="item_stateful_vs_stateless_authentication" href="/js2/part4/auths-api/#stateful_vs_stateless_authentication"> Stateful VS stateless authentication </a><a class="page-menu__item " id="item_cest_quoi_les_tokens_jwt" href="/js2/part4/auths-api/#cest_quoi_les_tokens_jwt"> C&#x27;est quoi les tokens JWT ? </a><a class="page-menu__item " id="item_authentification_autorisation_stateless_via_jwt_expres" href="/js2/part4/auths-api/#authentification_autorisation_stateless_via_jwt_expres"> Authentification &amp; autorisation stateless via JWT &amp; Expres </a><a class="page-menu__item " id="item_🍬_cacher_ses_secrets" href="/js2/part4/auths-api/#🍬_cacher_ses_secrets"> 🍬 Cacher ses secrets </a><a class="page-menu__item " id="item_mecanisme_dautorisation_et_verification_du_token" href="/js2/part4/auths-api/#mecanisme_dautorisation_et_verification_du_token"> Mécanisme d&#x27;autorisation et vérification du token </a><a class="page-menu__item " id="item_client_rest_avec_jwt" href="/js2/part4/auths-api/#client_rest_avec_jwt"> Client REST avec JWT </a><a class="page-menu__item " id="item_protection_des_operations_decriture_dune_api" href="/js2/part4/auths-api/#protection_des_operations_decriture_dune_api"> Protection des opérations d&#x27;écriture d&#x27;une API </a></div>
<h1><span><a id="cest_quoi_lauthentification_et_lautorisation" class="internal-page-title"></a> C&#x27;est quoi l&#x27;authentification et l&#x27;autorisation ? </span></h1>
<h2>Authentification, c&#x27;est quoi ?</h2>
<p>L&#x27;authentification, c&#x27;est le processus de vérifier qui est l&#x27;utilisateur d&#x27;une application.</p>
<p>Pour authentifier un utilisateur, on va généralement passer via un formulaire de connexion, lui demandant un username et un password.</p>
<h2>Autorisation, c&#x27;est quoi ?</h2>
<p>L&#x27;autorisation, c&#x27;est le processus de vérifier ce à quoi un utilisateur à accès.</p>
<p>Une API va autoriser les accès à certaines opérations en fonction des privilèges associés aux utilisateurs. Il y aura des opérations qui seront autorisées :</p>
<ul>
<li>pour tous les utilisateurs, tant anonymes qu&#x27;authentifiés ; imaginez par exemple les opérations de lecture de produits sur un site &quot;vitrine&quot;. Il ne faut pas devoir créer de compte utilisateur pour pouvoir afficher les produits du site.</li>
<li>pour tous les utilisateurs authentifiés, peu importe leurs privilèges ; imaginez le fait de pouvoir poster des messages dans un forum ; il faut avoir un compte pour pouvoir le faire, mais il ne faut pas de privilèges spécifiques (pas besoin d&#x27;être admin).</li>
<li>pour seulement un ou plusieurs utilisateur(s) authentifié(s) ayant les privilèges requis ; imaginez une opération de lecture de tous les profils des utilisateurs d&#x27;une banque ; il faut avoir un compte admin de la banque pour pouvoir le faire. Ca serait catastrophique si n&#x27;importe quel utilisateur authentifié pourrait accéder aux profils de tous les utilisateurs !</li>
</ul>
<h2>Différents moyens d&#x27;authentification</h2>
<p>Il existe de nombreux mécanismes d&#x27;authentification.</p>
<p>Traditionnellement, ou anciennement, nous avons l&#x27;authentification qui est supportée à l&#x27;aide de cookies. L&#x27;utilisateur envoie via un formulaire son username et password, le serveur vérifie ceux-ci et crée un id de session et le renvoie à l&#x27;utilisateur via un cookie.<br/>
<!-- -->Après l&#x27;authentification, à chaque requête du client sur ce serveur, le cookie est envoyé, et le serveur, qui a sauvegardé la session, va retrouver la session sur base de l&#x27;id de session présent dans le cookie et va autoriser ou non l&#x27;accès à l&#x27;opération demandée par le client.<br/>
<!-- -->C&#x27;est ce qu&#x27;on appelle une authentification <strong>stateful</strong>.</p>
<p>Un mécanisme d&#x27;authentification <strong>stateful</strong> indique que le serveur est responsable de sauvegarder les données de session des utilisateurs.</p>
<p>On parle de <strong>session</strong> d&#x27;un utilisateur comme étant toute la durée où le client s&#x27;authentifie à l&#x27;application web jusqu&#x27;à ce qu&#x27;il quitte cette application, lorsqu&#x27;il ferme son browser.</p>
<p>De manière plus moderne, nous avons des mécanismes d&#x27;authentification qui sont dits <strong>stateless</strong>. Dans ce genre de mécanisme, c&#x27;est le client qui doit sauvegarder les données de session, et donc le browser. L&#x27;authentification à l&#x27;aide de <strong>tokens</strong> devient très populaires.<br/>
<!-- -->Il existe différents moyen de l&#x27;implémenter. Dans le cadre de ce cours, nous focuserons sur la façon la plus habituelle, les <strong>JSON Web Tokens</strong>, ou <strong>JWT</strong>.</p>
<p>Il existe d&#x27;autres mécanismes très modernes qui utilisent des tokens, mis en place par des tiers : <strong>OAuth</strong>, <strong>OpenId</strong>... Ces mécanismes sont offerts par Microsoft, Google, Facebook... Nous ne les verrons pas dans le cadre de cours. Néanmoins, à la fin de ce cours, vous devriez être apte à pouvoir les utiliser, sous réserve de bien lire la documentation.</p>
<h1><span><a id="stateful_vs_stateless_authentication" class="internal-page-title"></a> Stateful VS stateless authentication  </span></h1>
<p>Quels sont les avantages &amp; inconvénients d&#x27;une authentification stateful ? et d&#x27;une authentification stateless ?</p>
<h4>Authentification stateful</h4>
<p><strong>Inconvénients</strong> :</p>
<ul>
<li>La session utilise de la mémoire pour chaque utilisateur.</li>
<li>Le backend n&#x27;a aucune manière de déterminer si le frontend s&#x27;est déconnecté du site ou non : gestion de l&#x27;expiration d&#x27;une session plus compliquée, notamment si le frontend revient après une longue durée.</li>
<li>Toutes les sessions sont perdues en cas de redémarrage du serveur (réauthentification).</li>
<li>Load balancing compliqué ; en effet, si un client fait une requête, pendant toute la durée de la session, s&#x27;il y a plusieurs serveurs qui peuvent y répondre, comment est gérée la session de ce client ? Par quel(s) serveur(s) ? Comment se partagent-ils les données de session ? Ou est-ce que ça doit toujours être le même serveur qui répond au même client ?</li>
</ul>
<p><strong>Avantages</strong> :</p>
<ul>
<li>Peu gourmand en ressource point de vue processing et très rapide ; en effet, une fois qu&#x27;une session est en place, la vérification que le cookie contient le bon id de session se fait vite.</li>
</ul>
<h4>Authentification stateless</h4>
<p><strong>Inconvénients</strong> :
Comme le serveur ne retient plus l&#x27;utilisateur en mémoire, il doit utiliser de la cryptographie pour créer et valider les token ; c&#x27;est donc consommateur en ressource point de vue processing.</p>
<p><strong>Avantages</strong> :</p>
<ul>
<li>Pas de session à gérer, même après redémarrage du serveur, il n&#x27;y a pas de réauthentification nécessaire.</li>
<li>Evolutif, utilisation facile de plusieurs serveurs si du load balancing est nécessaire ; en effet, comme chaque requête du client contient toutes les infos pour se faire autoriser, peu importe quel est le serveur qui va prendre en charge la requête.</li>
</ul>
<p>Notons que la &quot;scalability&quot; horizontale, la possibilité de permettre à une application d&#x27;augmenter sa capacité de répondre à une charge grandissante simplement en ajoutant des machines, est quelque chose de très important à notre époque.<br/>
<!-- -->Certaines applications web ont des centaines de millions d&#x27;utilisateurs ; pour celles-ci, on ne peut pas compter sur la &quot;scalability&quot; verticale, c&#x27;est-à-dire le fait d&#x27;augmenter les ressources d&#x27;une machine, en augmentant sa RAM, son processeur, son espace de stockage...</p>
<p>Dès lors, dans le cadre de ce cours, nous allons préférer les applications web qui peuvent tourner sur des serveurs <strong>stateless</strong>.</p>
<h1><span><a id="cest_quoi_les_tokens_jwt" class="internal-page-title"></a> C&#x27;est quoi les tokens JWT ? </span></h1>
<p>Les JSON Web token, ou JWT, appartiennent à un standard internet permettant l&#x27;échange sécurisé de tokens entre plusieurs parties.</p>
<p>Un JWT contient trois parties encodées en base64 et ressemble à qqch du style :<br/>
<strong><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.</code></strong><br/>
<strong><code>eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.</code></strong><br/>
<strong><code>SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</code></strong></p>
<p>Voici les 3 parties d&#x27;un JWT et leurs caractéristiques :</p>
<ul>
<li>l&#x27;<strong>entête</strong> (ou header) : un objet JSON identifiant le type de token (JWT) et l&#x27;algorithme utilisé pour générer la signature du token (HS256), un algorithme de hachage.</li>
<li>le <strong>payload</strong> : un objet JSON permettant de spécifier le <strong>claim</strong> ; ce sont des paramètres optionnels précisant les affirmations associées au token, comme la date d&#x27;expiration du token, son créateur, le fait que l&#x27;utilisateur est admin... généralement, on y met pas trop d&#x27;info, principalement l&#x27;identifiant de l&#x27;utilisateur ; si l&#x27;API a besoin de plus d&#x27;info concernant l&#x27;utilisateur, elle ira généralement les chercher dans son support de données.</li>
<li>la <strong>signature</strong> : c&#x27;est une signature numérique construite à partir d&#x27;un secret privé ou d&#x27;une clé publique/privée, via l&#x27;algorithme précisé dans la signature.</li>
</ul>
<p>💭 C&#x27;est bien joli tout ça, mais comment ça permet de sécuriser la session d&#x27;un utilisateur ?<br/>
<!-- -->Généralement, l&#x27;API, et elle uniquement, connait le secret privé. Elle va donc créer le token d&#x27;un utilisateur authentifié, en y ajoutant le claim (ou les affirmations) qu&#x27;elle juge utile.<br/>
<!-- -->Lorsque le client reçoit son token, il va le sauvegarder dans son browser.<br/>
<!-- -->Pour chaque requête où il devra se faire autoriser par l&#x27;API, le client enverra son token au sein d&#x27;un header de la requête.<br/>
<!-- -->L&#x27;API utilisera le secret privé, connu d&#x27;elle-même uniquement, pour vérifier la signature du token. Si tout est OK, c&#x27;est que l&#x27;utilisateur est bien authentifié et que son claim est OK.</p>
<p>Imaginez maintenant qu&#x27;un hackeur tente de modifier le token, pour modifier le claim, notamment en changeant l&#x27;id de l&#x27;utilisateur présent dans le payload du token.
Et bien la signature ne correspondra plus à ce token là ! L&#x27;API le détectera.<br/>
<!-- -->Pour que le hackeur réussisse son acte malicieux, il est obligé de connaître le secret privé qui ne doit être connu que de l&#x27;API.<br/>
<!-- -->Les hackeurs devront connaître le secret privé afin de pouvoir générer un nouveau token qui sera validé par l&#x27;API. Pas évident...</p>
<p>Ainsi, on peut imaginer un token comme une enveloppe sécurisé par un cadenas très spécial : ce cadenas, qui est mis sur l&#x27;enveloppe contenant, par exemple, l&#x27;identifiant d&#x27;un utilisateur, est fermé par la clé 🔑 que seulement connaît l&#x27;API.
Si quelqu&#x27;un touche à l&#x27;enveloppe, le cadenas ne s&#x27;ouvrira plus avec la 🔑 de l&#x27;API : la tentative de hackage sera détectée !
Si quelqu&#x27;un tente de créer une enveloppe sécurisé, il le fera avec une autre clé, <strong>🗝</strong> par exemple, car il ne connaît pas 🔑. L&#x27;API, tentant d&#x27;ouvrir l&#x27;enveloppe sécurisée à l&#x27;aide de 🔑, elle ne s&#x27;ouvrira pas : la tentative de hacking sera détectée !</p>
<p>💭 Est-ce que cette métaphore d&#x27;enveloppe sécurisée vous parle ?
Attention que dans la réalité, le payload classique d&#x27;un token sera décodable, que l&#x27;on connaisse ou pas le secret privé. Il est encodé en base64 ! Ne mettez donc jamais de secrets dans le payload d&#x27;un token !<br/>
<!-- -->Si vraiment un jour vous deviez mettre un secret dans un payload, bien que déconseillé, vous pourriez toujours le faire en cryptant le payload.</p>
<p>👍 Le mécanisme de token assure que l&#x27;on aie une très haute probabilité de détecter les altérations faites sur les tokens, les tentatives de forgeage, grâce à la signature de ceux-ci.<br/>
<!-- -->⚡ Par contre, si nous laissons traîner des informations dans le payload d&#x27;un token, comme un password d&#x27;un utilisateur et son username, alors là, c&#x27;est juste un beau cadeau pour les hackeurs, il n&#x27;auront qu&#x27;à utiliser le formulaire de connexion et prendre possession de notre identité 😨.</p>
<p>Il existe un site fort intéressant qui montre la structure d&#x27;un token et qui permet de les décoder : <a href="https://jwt.io/">jwt.io</a> <a href="/js2/references/#r63">[R.63]</a>. Nous l&#x27;utiliserons plus tard pour décoder les tokens générés par nos RESTful API.</p>
<h1><span><a id="authentification_autorisation_stateless_via_jwt_expres" class="internal-page-title"></a> Authentification &amp; autorisation stateless via JWT &amp; Expres </span></h1>
<h2>Introduction</h2>
<p>Via un exemple concret associé à notre RESTful API qui gère les ressources de type &quot;pizzas&quot;, nous allons mettre en place un processus d&#x27;authentification et d&#x27;autorisation JWT.</p>
<p>La librairie que nous allons utiliser dans le cadre de ce cours pour gérer des tokens JWT est <a href="https://www.npmjs.com/package/jsonwebtoken">jsonwebtoken</a>.</p>
<p>Nous allons maintenant continuer le développement de l&#x27;API <a href="https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/fat-model">fat-model</a> pour ajouter des opérations permettant l&#x27;authentification et l&#x27;autorisation d&#x27;utilisateurs.</p>
<p>Au sein de votre repo <strong>web2</strong>, veuillez créer le projet nommé <strong>/web2/tutorials/pizzeria/api/auths</strong> sur base d&#x27;un copié collé de <strong>/web2/tutorials/pizzeria/api/fat-model</strong> (ou <a href="https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/fat-model">fat-model</a>).</p>
<p>Pour la suite du tutoriel, nous considérons que tous les chemins absolus démarrent du répertoire
<strong>/web2/tutorials/pizzeria/api/auths</strong>.</p>
<p>Veuillez installer la librairie <strong>jsonwebtoken</strong> au sein de votre nouveau projet <strong>auths</strong> :</p>
<div class="codeblock"><pre class="prism-code language-bash" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeblock__header"><button class="codeblock__header__copy-button"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" class="svg-inline--fa fa-copy fa-w-14 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><span class="codeblock__header__language-name">bash</span></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token function" style="color:rgb(220, 220, 170)">npm</span><span class="token plain"> i jsonwebtoken</span></div></div></pre></div>
<h2>Mécanisme d&#x27;authentification et création du token</h2>
<p>Toujours à l&#x27;aide d&#x27;Express, nous allons créer un router <strong>auths</strong> qui mettra à disposition les opérations de <strong>login</strong> et de <strong>register</strong>.
Voici le contrat associé à ces nouvelles opérations :</p>
<h5>Opérations sur les ressources de type &quot;auths&quot;</h5>
<p>| URI | Méthode HTTP | Opération |
|---|---|---|---|
| <strong>auths/login</strong> | POST | Vérifier les credentials d&#x27;une ressource de type &quot;users&quot; et renvoyer le username et un token JWT si les credentials sont OK |
| <strong>auths/register</strong> | POST | Créer une ressource de type &quot;users&quot; et renvoyer le username et un token JWT |</p>
<br/>
<p>Le modèle <strong>users</strong> s&#x27;occupera de créer les utilisateur, de vérifier leurs credentials ainsi que de créer des token.</p>
<p>Voici le workflow attendu pour une opération de <strong>login</strong> ou de <strong>register</strong> :</p>
<div class="scrollable-image"><div class="scrollable-image__wrapper" style="min-width:879px;max-width:879x"><div data-gatsby-image-wrapper="" style="height:100%;width:100%;z-index:2;display:block" class="gatsby-image-wrapper"><div aria-hidden="true" style="padding-top:50.170648464163826%"></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/js2/static/cd56be61925d779c9a23f9ecdea56e09/5510b/login.webp 750w,/js2/static/cd56be61925d779c9a23f9ecdea56e09/da356/login.webp 879w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="height:100%;width:100%;display:block;opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/js2/static/cd56be61925d779c9a23f9ecdea56e09/fb68f/login.png" data-srcset="/js2/static/cd56be61925d779c9a23f9ecdea56e09/e56fa/login.png 750w,/js2/static/cd56be61925d779c9a23f9ecdea56e09/fb68f/login.png 879w" alt="GatsbyImage"/></picture><noscript><picture><source type="image/webp" srcSet="/js2/static/cd56be61925d779c9a23f9ecdea56e09/5510b/login.webp 750w,/js2/static/cd56be61925d779c9a23f9ecdea56e09/da356/login.webp 879w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="height:100%;width:100%;display:block;opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/js2/static/cd56be61925d779c9a23f9ecdea56e09/fb68f/login.png" srcSet="/js2/static/cd56be61925d779c9a23f9ecdea56e09/e56fa/login.png 750w,/js2/static/cd56be61925d779c9a23f9ecdea56e09/fb68f/login.png 879w" alt="GatsbyImage"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div></div>
<figcaption>Appel à une RESTful API pour s&#x27;authentifier et obtenir un JWT</figcaption>
<p>Ce que l&#x27;on voit dans l&#x27;image ci-dessus :</p>
<ul>
<li>si le modèle considère que l&#x27;utilisateur est authentifiable, que ses credentials sont OK, alors il va utiliser une librairie <strong>jwt</strong> et la méthode <strong>sign</strong> pour créer un token.</li>
<li>le token est envoyé dans le body de la réponse à l&#x27;utilisateur.</li>
</ul>
<p>Ce que l&#x27;on ne voit pas dans l&#x27;image ci-dessus :</p>
<ul>
<li>c&#x27;est le job du client de sauvegarder le token. Si l&#x27;application cliente est un browser, alors celui-ci pourra être sauvegardé dans le web storage du browser.</li>
<li>l&#x27;application cliente peut être faite avec n&#x27;importe quelle technologie. Par exemple, nous pourrons utiliser REST Client pour faire une requête à l&#x27;API...</li>
</ul>
<p>Dans notre RESTful API, nous avons décidé que lorsqu&#x27;un client s&#x27;enregistre, quand il fait appel à l&#x27;opération <strong>register</strong> pour créer un compte, l&#x27;API considère automatiquement que cet utilisateur est authentifié. Tout comme la méthode <strong>login</strong>, la méthode <strong>register</strong> créera et renverra un token JWT à l&#x27;utilisateur.</p>
<p>NB : Il est possible d&#x27;envisager un workflow différent : après le <strong>register</strong>, l&#x27;application demanderait à l&#x27;utilisateur un <strong>login</strong>, <strong>register</strong> ne renvoyant jamais de token à l&#x27;utilisateur.</p>
<p>Nous allons à présent mettre en place le code permettant d&#x27;implémenter le workflow que l&#x27;on vient de découvrir.</p>
<p>Veuillez créer le modèle <strong>users</strong> en créant le fichier <strong>/models/users.js</strong> et y inclure ce code :</p>
<div class="codeblock"><pre class="prism-code language-js" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeblock__header"><button class="codeblock__header__copy-button"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" class="svg-inline--fa fa-copy fa-w-14 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><span class="codeblock__header__language-name">js</span></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">1</span><div class="codeblock__body__line__content"><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> jwt </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">require</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;jsonwebtoken&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">2</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">require</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;node:path&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">3</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> parse</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> serialize </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">require</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;../utils/json&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">4</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">5</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> jwtSecret </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ilovemypizza!&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">6</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> lifetimeJwt </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">24</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">60</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">60</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// in ms : 24 * 60 * 60 * 1000 = 24h</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">7</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">8</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> jsonDbPath </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">join</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">__dirname</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;/../data/users.json&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">9</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">10</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> defaultUsers </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">11</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">12</span><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token literal-property property">id</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">13</span><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token literal-property property">username</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;admin&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">14</span><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token literal-property property">password</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;admin&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">15</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">16</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">17</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">18</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">login</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">username</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> password</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">19</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> userFound </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">readOneUserFromUsername</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">20</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">userFound</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token keyword nil" style="color:rgb(86, 156, 214)">undefined</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">21</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">userFound</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">password</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">!==</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token keyword nil" style="color:rgb(86, 156, 214)">undefined</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">22</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">23</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> jwt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sign</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">24</span><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> username </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// session data added to the payload (payload : part 2 of a JWT)</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">25</span><div class="codeblock__body__line__content"><span class="token plain">    jwtSecret</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// secret used for the signature (signature part 3 of a JWT)</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">26</span><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token literal-property property">expiresIn</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> lifetimeJwt </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// lifetime of the JWT (added to the JWT payload)</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">27</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">28</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">29</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> authenticatedUser </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">30</span><div class="codeblock__body__line__content"><span class="token plain">    username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">31</span><div class="codeblock__body__line__content"><span class="token plain">    token</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">32</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">33</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">34</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> authenticatedUser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">35</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">36</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">37</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">register</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">username</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> password</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">38</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> userFound </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">readOneUserFromUsername</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">39</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">userFound</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token keyword nil" style="color:rgb(86, 156, 214)">undefined</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">40</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">41</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token function" style="color:rgb(220, 220, 170)">createOneUser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">42</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">43</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> jwt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sign</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">44</span><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> username </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// session data added to the payload (payload : part 2 of a JWT)</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">45</span><div class="codeblock__body__line__content"><span class="token plain">    jwtSecret</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// secret used for the signature (signature part 3 of a JWT)</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">46</span><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token literal-property property">expiresIn</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> lifetimeJwt </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// lifetime of the JWT (added to the JWT payload)</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">47</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">48</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">49</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> authenticatedUser </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">50</span><div class="codeblock__body__line__content"><span class="token plain">    username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">51</span><div class="codeblock__body__line__content"><span class="token plain">    token</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">52</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">53</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">54</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> authenticatedUser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">55</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">56</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">57</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">readOneUserFromUsername</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">58</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> users </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">parse</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">jsonDbPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> defaultUsers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">59</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> indexOfUserFound </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> users</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">findIndex</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">user</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">username</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">===</span><span class="token plain"> username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">60</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">indexOfUserFound </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token keyword nil" style="color:rgb(86, 156, 214)">undefined</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">61</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">62</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> users</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">indexOfUserFound</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">63</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">64</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">65</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">createOneUser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">username</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> password</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">66</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> users </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">parse</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">jsonDbPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> defaultUsers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">67</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">68</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> createdUser </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">69</span><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token literal-property property">id</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">getNextId</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">70</span><div class="codeblock__body__line__content"><span class="token plain">    username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">71</span><div class="codeblock__body__line__content"><span class="token plain">    password</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">72</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">73</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">74</span><div class="codeblock__body__line__content"><span class="token plain">  users</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">push</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">createdUser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">75</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">76</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token function" style="color:rgb(220, 220, 170)">serialize</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">jsonDbPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> users</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">77</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">78</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> createdUser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">79</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">80</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">81</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">getNextId</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">82</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> users </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">parse</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">jsonDbPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> defaultUsers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">83</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> lastItemIndex </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> users</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">length </span><span class="token operator" style="color:rgb(212, 212, 212)">!==</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> users</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token keyword nil" style="color:rgb(86, 156, 214)">undefined</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">84</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">lastItemIndex </span><span class="token operator" style="color:rgb(212, 212, 212)">===</span><span class="token plain"> </span><span class="token keyword nil" style="color:rgb(86, 156, 214)">undefined</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">85</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> lastId </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> users</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">lastItemIndex</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">86</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> nextId </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> lastId </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">87</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> nextId</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">88</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">89</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">90</span><div class="codeblock__body__line__content"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">91</span><div class="codeblock__body__line__content"><span class="token plain">  login</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">92</span><div class="codeblock__body__line__content"><span class="token plain">  register</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">93</span><div class="codeblock__body__line__content"><span class="token plain">  readOneUserFromUsername</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">94</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></div></pre></div>
<p>Dans le code ci-dessus, <strong>jwtSecret</strong> est le secret privé connu uniquement du serveur. C&#x27;est la même secret qu&#x27;il faudra utiliser pour vérifier un token.</p>
<p><strong><code>jwt.sign()</code></strong> permet de créer le token et ses 3 parties :</p>
<ul>
<li>le payload du token, la 2ème partie du token, est complété principalement via le permier argument de <strong>sign()</strong> ; ici, le token affirme que l&#x27;utilisateur possédant le <strong>username</strong> donné est authentifié.</li>
<li>le payload du token sera aussi modifié sur base de la durée d&#x27;expiration du token, selon l&#x27;argument <strong>expiresIn</strong>.</li>
<li><strong>jwtSecret</strong> est utilisé pour créer la 3ème partie du token, sa signature.</li>
</ul>
<p>Il faut maintenant que nous créions le router <strong>auths</strong> offrant les opérations de <strong>login</strong> et de <strong>register</strong>, en faisant appel au modèle <strong>users</strong>.<br/>
<!-- -->Veuillez créer le fichier <strong>/routes/auths.js</strong> et y inclure le code suivant :</p>
<div class="codeblock"><pre class="prism-code language-js" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeblock__header"><button class="codeblock__header__copy-button"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" class="svg-inline--fa fa-copy fa-w-14 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><span class="codeblock__header__language-name">js</span></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> express </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">require</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;express&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> register</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> login </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">require</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;../models/users&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> router </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> express</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access maybe-class-name" style="color:rgb(220, 220, 170)">Router</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">/* Register a user */</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">router</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">post</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;/register&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> username </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> req</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">body</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">username</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">length </span><span class="token operator" style="color:rgb(212, 212, 212)">!==</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> req</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">username</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token keyword nil" style="color:rgb(86, 156, 214)">undefined</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> password </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> req</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">body</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">password</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">length </span><span class="token operator" style="color:rgb(212, 212, 212)">!==</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> req</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">password</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token keyword nil" style="color:rgb(86, 156, 214)">undefined</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">username </span><span class="token operator" style="color:rgb(212, 212, 212)">||</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">password</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sendStatus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">400</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// 400 Bad Request</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> authenticatedUser </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">register</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">authenticatedUser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sendStatus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">409</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// 409 Conflict</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">json</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">authenticatedUser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">/* Login a user */</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">router</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">post</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;/login&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> username </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> req</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">body</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">username</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">length </span><span class="token operator" style="color:rgb(212, 212, 212)">!==</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> req</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">username</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token keyword nil" style="color:rgb(86, 156, 214)">undefined</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> password </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> req</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">body</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">password</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">length </span><span class="token operator" style="color:rgb(212, 212, 212)">!==</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> req</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">password</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token keyword nil" style="color:rgb(86, 156, 214)">undefined</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">username </span><span class="token operator" style="color:rgb(212, 212, 212)">||</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">password</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sendStatus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">400</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// 400 Bad Reques</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> authenticatedUser </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">login</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">authenticatedUser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sendStatus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">401</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// 401 Unauthorized</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">json</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">authenticatedUser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> router</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></div></pre></div>
<p>Il n&#x27;y a rien de bien spécial à ce code. On fait simplement appel aux opérations du modèle <strong>users</strong>.</p>
<p>Attention, il faut rajouter le nouveau router au sein de <strong>app.js</strong> pour que notre API puisse offrir les nouvelles opérations. Veuillez ajouter ce code dans <strong>/app.js</strong> :</p>
<div class="codeblock"><pre class="prism-code language-js" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeblock__header"><button class="codeblock__header__copy-button"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" class="svg-inline--fa fa-copy fa-w-14 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><span class="codeblock__header__language-name">js</span></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> express </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">require</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;express&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> cookieParser </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">require</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;cookie-parser&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> logger </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">require</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;morgan&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> usersRouter </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">require</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;./routes/users&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> pizzaRouter </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">require</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;./routes/pizzas&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> authsRouter </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">require</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;./routes/auths&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> app </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">express</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">use</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">logger</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;dev&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">use</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">express</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">json</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">use</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">express</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">urlencoded</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token literal-property property">extended</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">use</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">cookieParser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">use</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;/users&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> usersRouter</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">use</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;/pizzas&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> pizzaRouter</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">use</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;/auths&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> authsRouter</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></div></pre></div>
<p>Veuillez démarrer votre API <strong>auths</strong>.</p>
<p>💭 Comment tester ces nouvelles opérations ?
Hé bien rien de neuf, on va utiliser REST Client.</p>
<p>Veuillez créer le fichier <strong>/REST Client/auths.http</strong> et y ajouter le code suivant :</p>
<div class="codeblock"><pre class="prism-code language-http" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeblock__header"><button class="codeblock__header__copy-button"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" class="svg-inline--fa fa-copy fa-w-14 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><span class="codeblock__header__language-name">http</span></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">@baseUrl = http://localhost:3000</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">### Try to login an unknow user</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">POST {{baseUrl}}/auths/login</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">Content-Type: application/json</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">{</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;username&quot;:&quot;unknown&quot;,</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;password&quot;:&quot;admin&quot;</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">}</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">### Login the default admin</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">POST {{baseUrl}}/auths/login</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">Content-Type: application/json</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">{</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;username&quot;:&quot;admin&quot;,</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;password&quot;:&quot;admin&quot;</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">}</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">### Create the manager user</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">POST {{baseUrl}}/auths/register</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">Content-Type: application/json</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">{</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;username&quot;:&quot;manager&quot;,</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;password&quot;:&quot;manager&quot;</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">}</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">### Login the manager user</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">POST {{baseUrl}}/auths/login</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">Content-Type: application/json</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">{</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;username&quot;:&quot;manager&quot;,</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;password&quot;:&quot;manager&quot;</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">}</span></div></div></pre></div>
<p>Veuillez exécuter les différentes requêtes. Tout devrait fonctionner, vous devriez récupérer le username et le token d&#x27;un utilisateur authentifié.</p>
<p>Pour le fun, nous allons décoder un token. Veuillez copier le token de ce que renvoie votre API pour la requête de login de l&#x27;utilisateur <strong>manager</strong> (qqch qui doit ressembler à une string du genre : <code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Im1hbmFnZXIiLCJpYXQiOjE2NjEyNDg1MjksImV4cCI6MTc0NzY0ODUyOX0.JvYzM0gtmVkqFr9R3f1Bf6ow_QuyHJY-vedJ39N7JKw</code>).</p>
<p>Veuillez vous rendre sur le site <a href="https://jwt.io/">JWT</a> et coller votre token dans le champs <strong>Encoded</strong>. Dans la colonne <strong>Decoded</strong>, vous devriez voir l&#x27;algorithme utilisé par la méthode <strong>sign</strong>, ainsi que les données présentes dans le payload, dont <code>&quot;username&quot;: &quot;manager&quot;</code> !<br/>
<!-- -->Vous comprenez pourquoi on n&#x27;ajoute pas des secrets dans un token 😉.</p>
<h1><span><a id="🍬_cacher_ses_secrets" class="internal-page-title"></a> 🍬 Cacher ses secrets </span></h1>
<p>Dans ce cours-ci, nous ne verrons pas directement comment faire en sorte que le secret,  permettant de signer &amp; vérifier les token, ne soit pas présent sur le web repository de vos API (par exemple ici le modèle <strong>users.js</strong> hardcode ce secret). En effet, pour des raisons de sécurité, si votre secret est visible pour tous les développeurs qui accède à votre repository public, c&#x27;est un problème.<br/>
<!-- -->Si vous souhaitez découvrir comment faire en sorte de rendre invisible des informations sensibles sur un web repository, tout en pouvant bénéficiant de ces infos dans votre environnement de développement, vous pouvez utiliser la librairie <a href="https://www.npmjs.com/package/dotenv">dotenv</a> qui permet de gérer facilement des variables d&#x27;environnement. C&#x27;est ce genre de librairies qui est utilisée par les professionnels pour cacher leurs secrets et certaines variables de configuration, comme le password pour se connecter à une DB, l&#x27;URL vers une API, le port de l&#x27;application...</p>
<h1><span><a id="mecanisme_dautorisation_et_verification_du_token" class="internal-page-title"></a> Mécanisme d&#x27;autorisation et vérification du token</span></h1>
<p>Suite au <strong>register</strong> ou au <strong>login</strong> de l&#x27;utilisateur, tel qu&#x27;il a été décidé pour notre RESTful API, celui-ci a reçu un token. C&#x27;est le job de l&#x27;application cliente de trouver un moyen de sauvegarder ce token.</p>
<p>Lorsqu&#x27;une application client souhaite créer une pizza, on souhaite autoriser cette opération qu&#x27;à l&#x27;administrateur du site gérant la pizzéria.<br/>
<!-- -->Nous décidons donc pour l&#x27;opération de création de pizza que l&#x27;utilisateur doit non seulement être authentifié, mais qu&#x27;en plus, il doit être l&#x27;admin.</p>
<p>Pour que l&#x27;application client qui fait la requête à l&#x27;API puisse s&#x27;autoriser, elle doit ajouter un <strong>authorization header</strong> à sa requête contenant comme valeur le token reçu lors du <strong>login</strong> ou du <strong>register</strong> :</p>
<div class="scrollable-image"><div class="scrollable-image__wrapper" style="min-width:879px;max-width:879x"><div data-gatsby-image-wrapper="" style="height:100%;width:100%;z-index:2;display:block" class="gatsby-image-wrapper"><div aria-hidden="true" style="padding-top:66.66666666666666%"></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/js2/static/7019197416b607b814455c5cde2bfd8d/b344d/authorizeOK.webp 747w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="height:100%;width:100%;display:block;opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/js2/static/7019197416b607b814455c5cde2bfd8d/8a955/authorizeOK.png" data-srcset="/js2/static/7019197416b607b814455c5cde2bfd8d/8a955/authorizeOK.png 747w" alt="GatsbyImage"/></picture><noscript><picture><source type="image/webp" srcSet="/js2/static/7019197416b607b814455c5cde2bfd8d/b344d/authorizeOK.webp 747w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="height:100%;width:100%;display:block;opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/js2/static/7019197416b607b814455c5cde2bfd8d/8a955/authorizeOK.png" srcSet="/js2/static/7019197416b607b814455c5cde2bfd8d/8a955/authorizeOK.png 747w" alt="GatsbyImage"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div></div>
<figcaption>Appel à une opération d&#x27;une RESTful API nécessitant une autorisation JWT : autorisation valide</figcaption>
<p>Le router de &quot;pizzas&quot;, avant même de passer la requête à la route <strong>POST /pizzas</strong>, va lancer la fonction middleware d&#x27;autorisation nommée <strong>authorize</strong>. La fonction middleware <strong>authorize</strong> va s&#x27;occuper de vérifier le token envoyé par le client dans un header à l&#x27;aide de la méthode <strong>verifiy</strong> de la librairie <strong>jwt</strong>.</p>
<p>💭 Si le token est valide, est-ce que ça signifie que l&#x27;utilisateur est bien authentifié ?
Hé bien non, car imaginez qu&#x27;entre le moment où l&#x27;utilisateur se soit logué, il ait été supprimé de l&#x27;application par un admin... dans ce cas-ci, on ne veut pas l&#x27;autoriser à ajouter une pizza au menu de la pizzeria ! Il n&#x27;est p-e même plus un employé, il souhaite p-e écrire du contenu malicieux 😨</p>
<p>Donc si le token est valide, <strong>authorize</strong> fera appel au modèle de <strong>users</strong> pour vérifier que l&#x27;utilisateur existe bien dans le support de données (fichiers JSON, base de données ou autres) et pour obtenir toutes les infos sur cet utilisateur. Si l&#x27;utilisateur existe, alors cela signifie que l&#x27;utilisateur est bien authentifié. La fonction middleware <strong>authorize</strong> va passer la main à une autre fonction middleware pour vérifier que l&#x27;utilisateur est bien l&#x27;admin.</p>
<p>💭 Comment est-ce que <strong>authorize</strong> peut faire appel au modèle pour vérifier que l&#x27;utilisateur existe bien ? Est-ce que cela signifie que le token doit contenir tout un tas de données sur l&#x27;utilisateur ?
👍 En règle générale, on va juste mettre un identifiant de l&#x27;utilisateur dans ce qu&#x27;on appelle le <strong>payload</strong> du token. C&#x27;est ensuite l&#x27;API, suite au décodage de l&#x27;identifiant de l&#x27;utilisateur, qui fera appel au support de données pour retrouver toutes les données de l&#x27;utilisateur.</p>
<p>NB : notez que l&#x27;on pourrait aussi laisser la fonction <strong>createOnePizza</strong> s&#x27;occuper de vérifier que l&#x27;utilisateur demandant la création de la pizza soit bien l&#x27;admin. Ici, comme il s&#x27;agit de vérifier que le contrat de l&#x27;API soit respecté, c&#x27;est-à-dire que l&#x27;utilisateur soit bien authentifié &amp; admin, alors on préfère réaliser cette action en dehors du modèle, car dans nos choix architecturaux au niveau de nos RESTful API, nous avons décidé que ce n&#x27;est pas le modèle qui s&#x27;occupe de présenter les données aux clients.</p>
<p>La fonction middleware <strong>isAdmin</strong> va vérifier que l&#x27;utilisateur est bien l&#x27;admin. Si c&#x27;est OK, elle passera la main à la fonction middleware qui gère la route <strong>POST /pizzas</strong> au sein du router de pizzas en faisant l&#x27;appel à la fonction <strong>next</strong>.</p>
<p>Maintenant que le client a les bons privilèges, l&#x27;opération de création de la pizza peut donc être autorisée. L&#x27;opération de <strong>createOnePizza</strong> du modèle renverra la nouvelle pizza au router qui s&#x27;occupera de présenter la nouvelle pizza au client, au format JSON.</p>
<p>Par contre, voici le workflow si le token n&#x27;est pas valide :</p>
<div class="scrollable-image"><div class="scrollable-image__wrapper" style="min-width:879px;max-width:879x"><div data-gatsby-image-wrapper="" style="height:100%;width:100%;z-index:2;display:block" class="gatsby-image-wrapper"><div aria-hidden="true" style="padding-top:60.93943139678616%"></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/js2/static/ce4d88f5a75edb2b72efaaa71f7b0efc/35881/authorizeNOK.webp 750w,/js2/static/ce4d88f5a75edb2b72efaaa71f7b0efc/a88f0/authorizeNOK.webp 809w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="height:100%;width:100%;display:block;opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/js2/static/ce4d88f5a75edb2b72efaaa71f7b0efc/e5078/authorizeNOK.png" data-srcset="/js2/static/ce4d88f5a75edb2b72efaaa71f7b0efc/8770b/authorizeNOK.png 750w,/js2/static/ce4d88f5a75edb2b72efaaa71f7b0efc/e5078/authorizeNOK.png 809w" alt="GatsbyImage"/></picture><noscript><picture><source type="image/webp" srcSet="/js2/static/ce4d88f5a75edb2b72efaaa71f7b0efc/35881/authorizeNOK.webp 750w,/js2/static/ce4d88f5a75edb2b72efaaa71f7b0efc/a88f0/authorizeNOK.webp 809w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="height:100%;width:100%;display:block;opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/js2/static/ce4d88f5a75edb2b72efaaa71f7b0efc/e5078/authorizeNOK.png" srcSet="/js2/static/ce4d88f5a75edb2b72efaaa71f7b0efc/8770b/authorizeNOK.png 750w,/js2/static/ce4d88f5a75edb2b72efaaa71f7b0efc/e5078/authorizeNOK.png 809w" alt="GatsbyImage"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div></div>
<figcaption>Appel à une opération d&#x27;une RESTful API nécessitant une autorisation JWT : autorisation invalide</figcaption>
<p>Dans ce cas là, <strong>authorize</strong> ne passe pas la main à <strong>isAdmin</strong> ni même à la fonction middleware qui gère la route <strong>POST /pizzas</strong>.<br/>
<!-- -->La fonction middleware <strong>authorize</strong> renvoie directement un code d&#x27;erreur <strong>401 Unauthorized</strong> au client.</p>
<p>Vous pourriez aussi imaginer le workflow où le client envoie un token valide, mais l&#x27;utilisateur associé n&#x27;est pas admin. Dans ce cas-ci, <strong>authorize</strong> ferait appel à <strong>isAdmin</strong>, mais <strong>isAdmin</strong> renverrait directement un code d&#x27;erreur <strong>403 Forbidden</strong> au client.<br/>
<!-- -->En effet, l&#x27;API indiquerait ainsi qu&#x27;elle aurait vérifié que l&#x27;utilisateur est bien authentifié, mais que celui ne possède pas les privilèges suffisant pour accéder à l&#x27;opération demandée.</p>
<p>😨 Wow, le workflow d&#x27;autorisation pour la création d&#x27;une pizza est assez long.  Nous allons maintenant l&#x27;implémenter. Nous vous inquiétez pas, ce qui importe dans le code qui va suivre, ce n&#x27;est pas de savoir écrire tout le code, mais de bien comprendre le mécanisme. En effet, en règle générale, vous allez utiliser des librairies vous permettant d&#x27;autoriser les accès aux opérations de vos API. Vous écrirez donc rarement le mécanisme d&#x27;autorisation, par contre, vous devrez pouvoir utiliser ces mécanismes.</p>
<p>Veuillez créer les nouvelles fonctions middleware <strong>authorize</strong> et <strong>isAdmin</strong> au sein d&#x27;un nouveau fichier <strong>/utils/auths.js</strong> :</p>
<div class="codeblock"><pre class="prism-code language-js" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeblock__header"><button class="codeblock__header__copy-button"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" class="svg-inline--fa fa-copy fa-w-14 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><span class="codeblock__header__language-name">js</span></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">1</span><div class="codeblock__body__line__content"><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> jwt </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">require</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;jsonwebtoken&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">2</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> readOneUserFromUsername </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">require</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;../models/users&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">3</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">4</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> jwtSecret </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ilovemypizza!&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">5</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">6</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(220, 220, 170)">authorize</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> res</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> next</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">7</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> req</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">get</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;authorization&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">8</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sendStatus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">401</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">9</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">10</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">11</span><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> decoded </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> jwt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">verify</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> jwtSecret</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">12</span><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> username </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> decoded</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">13</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">14</span><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> existingUser </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">readOneUserFromUsername</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">15</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">16</span><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">existingUser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sendStatus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">401</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">17</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">18</span><div class="codeblock__body__line__content"><span class="token plain">    req</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">user</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> existingUser</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// request.user object is available in all other middleware functions</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">19</span><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">next</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">20</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">21</span><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(78, 201, 176)">console</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">error</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;authorize: &#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">22</span><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sendStatus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">401</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">23</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">24</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">25</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">26</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(220, 220, 170)">isAdmin</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> res</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> next</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">27</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> username </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> req</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">user</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">28</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">29</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">username </span><span class="token operator" style="color:rgb(212, 212, 212)">!==</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;admin&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sendStatus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">403</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">30</span><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">next</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">31</span><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">32</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">33</span><div class="codeblock__body__line__content"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> authorize</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> isAdmin </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></div></pre></div>
<p>Quelques explications sur le code de la fonction middleware <strong>authorize</strong> :</p>
<ul>
<li>Grâce à <code>req.get(&#x27;authorization&#x27;)</code>, on récupère le token qui a été envoyé par le client au sein de l&#x27;<strong>authorization header</strong> de la requête, c&#x27;est une string.</li>
<li>La méthode <code>jwt.verify(token, jwtSecret)</code> vérifie tant la signature du token que le fait que le token n&#x27;a pas encore expiré. Elle utilise le secret <strong>jwtSecret</strong> qui doit être le même que celui pris en compte lors de la création du token.</li>
<li>Elle charge toutes les données de l&#x27;utilisateur authentifié au sein de l&#x27;objet <strong>request</strong>, dans <strong>user</strong>. Cela est une bonne pratique, cela permet, pour toute la durée du traitement de cette requête, de mettre à disposition ces données à toutes les fonctions middleware.<br/>
<!-- -->💭 Mais pourquoi faire cela ?
Imaginez que vous faites un appel à une base de données externes à chaque fois que vous souhaitez obtenir les informations d&#x27;un utilisateur... Cela est très consommateur en temps... Lorsque vous allez utiliser d&#x27;autres fonctions middleware comme <strong>isAdmin</strong>, vous n&#x27;avez plus besoin de faire appel à la base de données.</li>
<li>💭 Qu&#x27;est-ce que ce code : <code>const { username } = decoded;</code> ?<br/>
<!-- -->C&#x27;est ce que l&#x27;on appelle du <strong>destructuring assignement</strong>, c&#x27;est une façon très concise en JS de créer des variables à partir de propriétés d&#x27;objets ou des valeurs d&#x27;arrays.<br/>
<!-- -->Imaginez ici que la valeur de <code>decoded</code> soit <code>{ username: &#x27;admin&#x27;, iat: 1661251095, exp: 1747651095 }</code>. Ce code <code>const { username } = decoded;</code> est l&#x27;équivalent de <code>const username = decoded.username;</code>. OK, mais ça n&#x27;a pas vraiment de valeur ajoutée ici, c&#x27;est juste un poil plus concis... Cela devient vraiment intéressant quand vous souhaitez créer plusieurs variables, comme pour l&#x27;exemple donné, on pourrait créer 3 variables ainsi <code>const { username, iat, exp } = decoded;</code> au lieu d&#x27;écrire :</li>
</ul>
<div class="codeblock"><pre class="prism-code language-js" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeblock__header"><button class="codeblock__header__copy-button"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" class="svg-inline--fa fa-copy fa-w-14 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><span class="codeblock__header__language-name">js</span></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> username </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> decoded</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> iat </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> decoded</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">iat</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> exp </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> decoded</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">exp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></div></pre></div>
<ul>
<li>Pour en savoir plus sur la puissance du <strong>destructuring assignement</strong>, vous pouvez consulter la <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment">documentation de MDN</a> <a href="/js2/references/#r64">[R.64]</a>.</li>
<li>Si tout est OK, <strong>isAdmin</strong> fait appel à <strong>next()</strong>, qui sera la prochaine fonction middleware qui est présente après l&#x27;appel de <strong>authorize</strong>.</li>
</ul>
<p>La fonction middleware <strong>isAdmin</strong> récupère les données de l&#x27;utilisateur authentifié via l&#x27;objet <code>req.user</code> et le <strong>destructuring assignement</strong>.<br/>
<!-- -->Si l&#x27;utilisateur n&#x27;est pas <strong>admin</strong>, c&#x27;est le code &#x27;<strong>403 Forbidden</strong>&#x27; qui est renvoyé à l&#x27;application cliente, signifiant que l&#x27;utilisateur est bien authentifié, mais il n&#x27;a pas les privilèges pour accéder à l&#x27;opération demandée (création de pizza).<br/>
<!-- -->Si tout est OK, <strong>isAdmin</strong> fait appel à <strong>next()</strong>, qui sera la prochaine fonction middleware qui est présente après l&#x27;appel de <strong>isAdmin</strong>.</p>
<p>Où allons-nous utiliser ces nouvelles fonctions middleware ?</p>
<p>Nous pouvons le faire au niveau que nous souhaitons, soit au niveau :</p>
<ul>
<li>de l&#x27;application, pour toutes les routes, via <code>app.use(authorize)</code>.</li>
<li>d&#x27;un router, pour toutes les routes associées ; par exemple, on pourrait dire que toutes les routes du router de pizzas sont protégées par une autorisation JWT. On écrirait : <code>app.use(&quot;/pizzas&quot;, authorize, pizzaRouter);</code>. Cela signifierait que toutes les opérations sur des ressources de type &quot;pizzas&quot; ne seraient autorisées que si l&#x27;utilisateur est authentifié. Cela serait problématique pour deux raisons :<!-- -->
<ul>
<li>On veut pouvoir afficher le menu des pizzas pour tous les utilisateurs, même s&#x27;ils sont anonymes.</li>
<li>On ne veut pas simplement vérifier qu&#x27;un utilisateur est authentifié pour créer une pizza, on veut aussi vérifier qu&#x27;il est admin.</li>
</ul>
</li>
<li>d&#x27;une route, pour une opération de notre RESTful API. C&#x27;est ce que nous souhaitons faire ici. Veuillez mettre à jour le code du router de &quot;pizzas&quot; au sein de <strong>/routes/pizzas.js</strong> :</li>
</ul>
<div class="codeblock"><pre class="prism-code language-js" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeblock__header"><button class="codeblock__header__copy-button"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" class="svg-inline--fa fa-copy fa-w-14 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><span class="codeblock__header__language-name">js</span></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token comment" style="color:rgb(106, 153, 85)">// See existing code</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> authorize</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> isAdmin </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">require</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;../utils/auths&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// See existing code</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Create a pizza to be added to the menu.</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">router</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">post</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;/&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> authorize</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> isAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> title </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> req</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">body</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">title</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">length </span><span class="token operator" style="color:rgb(212, 212, 212)">!==</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> req</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">title</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token keyword nil" style="color:rgb(86, 156, 214)">undefined</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> content </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> req</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">body</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">content</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">length </span><span class="token operator" style="color:rgb(212, 212, 212)">!==</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">?</span><span class="token plain"> req</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">content</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token keyword nil" style="color:rgb(86, 156, 214)">undefined</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">title </span><span class="token operator" style="color:rgb(212, 212, 212)">||</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">content</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sendStatus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">400</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// error code &#x27;400 Bad request&#x27;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> createdPizza </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">createOnePizza</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> content</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">json</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">createdPizza</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></div></pre></div>
<p>Ainsi, nous avons juste fait l&#x27;appel de deux fonctions middleware pour vérifier :</p>
<ul>
<li><strong>que l&#x27;utilisateur est authentifié</strong> via <strong>authorize</strong> ; si tout est OK au niveau du token fournit par l&#x27;application cliente, <strong>authorize</strong> fait appel via <strong>next()</strong> à la prochaine fonction middleware. Dans ce cas-ci, c&#x27;est <strong>isAdmin</strong>. S&#x27;il y a un problème, <strong>authorize</strong> termine le traitement de la requête en envoyant un code d&#x27;erreur au client et les prochaines fonctions middleware (<strong>isAdmin</strong>, puis la fonction arrow) ne sont pas exécutées.</li>
<li><strong>que l&#x27;utilisateur est admin</strong> via <strong>isAdmin</strong> ; si tout est OK, que l&#x27;utilisateur authentifié est l&#x27;admin, <strong>isAdmin</strong> fait appel via <strong>next()</strong> à la prochaine fonction middleware. Dans ce cas-ci, c&#x27;est la fonction arrow qui appelle <code>createOnePizza</code> pour créer la pizza, la fonction traitant l&#x27;opération demandée. Si l&#x27;utilisateur authentifié n&#x27;est pas l&#x27;admin, alors <strong>isAdmin</strong> termine le traitement en envoyant un code d&#x27;erreur au client et la fonction traitant de l&#x27;opération de création n&#x27;est pas exécutée.</li>
</ul>
<p>Comment pouvons-nous tester l&#x27;opération de création d&#x27;une pizza ? Via REST Client.
Tentons le coup à l&#x27;aide de cette requête (elle est déjà présente dans <strong>/REST Client/pizzas.http</strong>) :</p>
<div class="codeblock"><pre class="prism-code language-http" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeblock__header"><button class="codeblock__header__copy-button"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" class="svg-inline--fa fa-copy fa-w-14 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><span class="codeblock__header__language-name">http</span></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">POST {{baseUrl}}/pizzas</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">Content-Type: application/json</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">{</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;title&quot;:&quot;Magic Green&quot;,</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;content&quot;:&quot;Epinards, Brocolis, Olives vertes, Basilic&quot;</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">}</span></div></div></pre></div>
<p>Après avoir exécuté cette requête, vous devriez avoir reçu un status code &#x27;<strong>401 Unauthorized</strong>&#x27;.
Et bien oui, nous n&#x27;avons pas envoyé de token, nous ne pouvons donc pas être autorisé.<br/>
<!-- -->Au prochain point nous allons voir comment utiliser REST Client pour sauvegarder de l&#x27;information, comme un token, suite à une requête vers une API.</p>
<h1><span><a id="client_rest_avec_jwt" class="internal-page-title"></a> Client REST avec JWT </span></h1>
<p>Précédemment, nous avons appris à utiliser REST Client, l&#x27;extension de VS Code, pour faire des requêtes vers des API.</p>
<p>Voici quelques notions supplémentaire pour utiliser REST Client avec des <strong>JWT</strong> :</p>
<ul>
<li>Il est possible de créer des <strong>Request Variables</strong> afin de récupérer la réponse associée
à une requête au sein d&#x27;une variable.</li>
<li>On va donc pouvoir récupérer le token, suite à une requête d&#x27;authentification,
au sein d&#x27;une <strong>Request Variable</strong>, pour ensuite fournir ce token dans le
« <strong>Authorization header</strong> » de toutes les requêtes demandant une autorisation JWT.</li>
</ul>
<p>Si vous souhaitez plus d&#x27;infos sur les <strong>Request Variables</strong>, vous pouvez consulter la <a href="https://github.com/Huachao/vscode-restclient#request-variables">documentation de REST Client</a> <a href="/js2/references/#r55">[R.55]</a>.</p>
<p>Voici comment mettre à jour le script <strong>/REST Client/pizzas.http</strong> pour créer une pizza en passant le token de l&#x27;utilisateur <strong>admin</strong> :</p>
<div class="codeblock"><pre class="prism-code language-http" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeblock__header"><button class="codeblock__header__copy-button"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" class="svg-inline--fa fa-copy fa-w-14 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><span class="codeblock__header__language-name">http</span></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">### Create a pizza by using the admin account</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">#### First login as the admin</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">##### Define a request variable nammed admin :</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"># @name admin</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">POST {{baseUrl}}/auths/login</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">Content-Type: application/json</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">{</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;username&quot;:&quot;admin&quot;,</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;password&quot;:&quot;admin&quot;</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">}</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">#### Create a pizza with the admin token</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">POST {{baseUrl}}/pizzas</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">Content-Type: application/json</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">Authorization: {{admin.response.body.token}}</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">{</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;title&quot;:&quot;Magic Green&quot;,</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;content&quot;:&quot;Epinards, Brocolis, Olives vertes, Basilic&quot;</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">}</span></div></div></pre></div>
<p>Pour tester l&#x27;opération de création de pizza, veuillez d&#x27;abord exécuter la première requête, puis la seconde donnée ci-dessus.</p>
<p>A ce stade-ci, il serait aussi intéressant de tester certains cas d&#x27;erreurs associés aux tokens. Veuillez compléter le script <strong>/REST Client/pizzas.http</strong> avec :</p>
<div class="codeblock"><pre class="prism-code language-http" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeblock__header"><button class="codeblock__header__copy-button"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" class="svg-inline--fa fa-copy fa-w-14 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><span class="codeblock__header__language-name">http</span></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">### 1. Create a pizza without a token</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">POST {{baseUrl}}/pizzas</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">Content-Type: application/json</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">{</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;title&quot;:&quot;Magic Green&quot;,</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;content&quot;:&quot;Epinards, Brocolis, Olives vertes, Basilic&quot;</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">}</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">### 2. Create a pizza without being the admin, use manager account</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">#### 2.1 First login as the manager</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">##### 2.1.1 Define a request variable nammed manager</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"># @name manager</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">POST {{baseUrl}}/auths/login</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">Content-Type: application/json</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">{</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;username&quot;:&quot;manager&quot;,</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;password&quot;:&quot;manager&quot;</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">}</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">##### 2.1.2 Define a file variable to simplify the access to the token of manager</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">@managerToken = {{manager.response.body.token}}</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">#### 2.2 Try to create a pizza with the manager token</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">POST {{baseUrl}}/pizzas</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">Content-Type: application/json</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">Authorization: {{managerToken}}</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">{</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;title&quot;:&quot;Magic Green&quot;,</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    &quot;content&quot;:&quot;Epinards, Brocolis, Olives vertes, Basilic&quot;</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">}</span></div></div></pre></div>
<p>Nous voyons qu&#x27;à l&#x27;aide de REST Client, nous pouvons utiliser une <strong>File Variable</strong> pour allouer une partie de la réponse faite à une requête.<br/>
<!-- -->Dans ce cas, on peut faire appel à l&#x27;API en passant le token via la <strong>File Variable</strong> nommé <strong>managerToken</strong> (<code>Authorization: {{managerToken}}</code>) au lieu d&#x27;utiliser une partie seulement de la <strong>Request Variable</strong> nommée <strong>manager</strong> (<code>Authorization: {{manager.response.body.token}}</code>).<br/>
<!-- -->Cela permet de créer des requêtes plus concises.</p>
<h1><span><a id="protection_des_operations_decriture_dune_api" class="internal-page-title"></a> Protection des opérations d&#x27;écriture d&#x27;une API </span></h1>
<p>Veuillez mettre à jour votre RESTful API gérant les pizzas afin que toutes les opérations d&#x27;écriture soient protégées par une autorisation JWT, n&#x27;autorisant que l&#x27;utilisateur <strong>admin</strong>.</p>
<p>Voici le code à mettre à jour dans <strong>/routes/pizzas</strong> pour correctement autoriser les opérations de suppression et de modification sur des ressources de type &quot;pizzas&quot;:</p>
<div class="codeblock"><pre class="prism-code language-js" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeblock__header"><button class="codeblock__header__copy-button"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" class="svg-inline--fa fa-copy fa-w-14 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><span class="codeblock__header__language-name">js</span></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token comment" style="color:rgb(106, 153, 85)">// Delete a pizza from the menu based on its id</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">router</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">delete</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;/:id&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> authorize</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> isAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> deletedPizza </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">deleteOnePizza</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">req</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">params</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">deletedPizza</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sendStatus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">404</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">json</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">deletedPizza</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Update a pizza based on its id and new values for its parameters</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">router</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">patch</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;/:id&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> authorize</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> isAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(212, 212, 212)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> title </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> req</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">body</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> content </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> req</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">body</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">content</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">title </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">content</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">||</span><span class="token plain"> title</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">length </span><span class="token operator" style="color:rgb(212, 212, 212)">===</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">||</span><span class="token plain"> content</span><span class="token operator" style="color:rgb(212, 212, 212)">?.</span><span class="token plain">length </span><span class="token operator" style="color:rgb(212, 212, 212)">===</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sendStatus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">400</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> updatedPizza </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">updateOnePizza</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">req</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">params</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> title</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> content </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token plain">updatedPizza</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">sendStatus</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">404</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">json</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">updatedPizza</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><div class="codeblock__body__line__content"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></div></pre></div>
<p>Pour vous assurer que les opérations de suppression et de modification sont bien fonctionnelles, veuillez mettre à jour les requêtes associées afin d&#x27;utiliser un token. Veuillez mettre à jour <strong>/REST Client/pizzas.http</strong> en ajoutant ces deux lignes :</p>
<div class="codeblock"><pre class="prism-code language-http" style="color:#9CDCFE;background-color:#1E1E1E"><div class="codeblock__header"><button class="codeblock__header__copy-button"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="copy" class="svg-inline--fa fa-copy fa-w-14 fa-2x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg></button><span class="codeblock__header__language-name">http</span></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">1</span><div class="codeblock__body__line__content"><span class="token plain">### Create a pizza by using the admin account</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">2</span><div class="codeblock__body__line__content"><span class="token plain">#### First login as the admin</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">3</span><div class="codeblock__body__line__content"><span class="token plain">##### Define a request variable nammed admin</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">4</span><div class="codeblock__body__line__content"><span class="token plain"># @name admin</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">5</span><div class="codeblock__body__line__content"><span class="token plain">POST {{baseUrl}}/auths/login</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">6</span><div class="codeblock__body__line__content"><span class="token plain">Content-Type: application/json</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">7</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">8</span><div class="codeblock__body__line__content"><span class="token plain">{</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">9</span><div class="codeblock__body__line__content"><span class="token plain">    &quot;username&quot;:&quot;admin&quot;,</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">10</span><div class="codeblock__body__line__content"><span class="token plain">    &quot;password&quot;:&quot;admin&quot;</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">11</span><div class="codeblock__body__line__content"><span class="token plain">}</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">12</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">13</span><div class="codeblock__body__line__content"><span class="token plain">#### Create a pizza with the admin token</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">14</span><div class="codeblock__body__line__content"><span class="token plain">POST {{baseUrl}}/pizzas</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">15</span><div class="codeblock__body__line__content"><span class="token plain">Content-Type: application/json</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">16</span><div class="codeblock__body__line__content"><span class="token plain">Authorization: {{admin.response.body.token}}</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">17</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">18</span><div class="codeblock__body__line__content"><span class="token plain">{</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">19</span><div class="codeblock__body__line__content"><span class="token plain">    &quot;title&quot;:&quot;Magic Green&quot;,</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">20</span><div class="codeblock__body__line__content"><span class="token plain">    &quot;content&quot;:&quot;Epinards, Brocolis, Olives vertes, Basilic&quot;</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">21</span><div class="codeblock__body__line__content"><span class="token plain">}</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">22</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">23</span><div class="codeblock__body__line__content"><span class="token plain">### Delete pizza identified by 2 with the admin token</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">24</span><div class="codeblock__body__line__content"><span class="token plain">DELETE {{baseUrl}}/pizzas/2</span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">25</span><div class="codeblock__body__line__content"><span class="token plain">Authorization: {{admin.response.body.token}}</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">26</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">27</span><div class="codeblock__body__line__content"><span class="token plain">### Update the pizza identified by 6 with the admin token</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">28</span><div class="codeblock__body__line__content"><span class="token plain">PATCH {{baseUrl}}/pizzas/6</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">29</span><div class="codeblock__body__line__content"><span class="token plain">Content-Type: application/json</span></div></div><div class="token-line codeblock__body__line codeblock__body__line--highlighted" style="color:#9CDCFE"><span class="codeblock__body__line__number">30</span><div class="codeblock__body__line__content"><span class="token plain">Authorization: {{admin.response.body.token}}</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">31</span><div class="codeblock__body__line__content"><span class="token plain" style="display:inline-block">
</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">32</span><div class="codeblock__body__line__content"><span class="token plain">{</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">33</span><div class="codeblock__body__line__content"><span class="token plain">    &quot;title&quot;:&quot;Magic Green 2&quot;</span></div></div><div class="token-line codeblock__body__line" style="color:#9CDCFE"><span class="codeblock__body__line__number">34</span><div class="codeblock__body__line__content"><span class="token plain">}</span></div></div></pre></div>
<p>Veuillez exécutez les requêtes de type DELETE et de type PATCH afin de vous assurer que l&#x27;API est en ordre.</p>
<p>Si tout fonctionne bien, faites un <strong>commit</strong> de votre repo (<strong>web2</strong>) avec le message
&quot;<strong>auths</strong>&quot;.</p>
<p>En cas de souci, vous pouvez utiliser le code du tutoriel <a href="https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/auths">auths</a>.</p></div></main><footer class="footer "><div class="background footer__background"><div class="footer__logo"><h3 class="footer__logo__text">web2course</h3><div class="footer__logo__image"></div><div class="footer__logo__image2"></div></div><div class="footer__icons"><ul class="menu"><li><a href="mailto: raphael.baroni@vinci.be" data-email="raphael.baroni@vinci.be" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg></a></li></ul></div></div></footer><div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/part4/auths-api/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-def0aae780f8a06d6c8b.js\"],\"component---cache-caches-gatsby-plugin-offline-app-shell-js\":[\"/component---cache-caches-gatsby-plugin-offline-app-shell-js-99547ffeb771d821cc1d.js\"],\"component---src-pages-404-js\":[\"/component---src-pages-404-js-e26b35f6f5bd314f951b.js\"],\"component---src-pages-login-js\":[\"/component---src-pages-login-js-3b547c68e997ecc42b73.js\"],\"component---src-pages-logout-js\":[\"/component---src-pages-logout-js-a4a6d33d406c44ec2755.js\"],\"component---src-pages-my-reviews-page-js\":[\"/component---src-pages-my-reviews-page-js-e4ec076222e468b03704.js\"],\"component---src-pages-project-page-js\":[\"/component---src-pages-project-page-js-45802450867a551cadda.js\"],\"component---src-pages-review-page-js\":[\"/component---src-pages-review-page-js-4ed4756c3de78e99f1c0.js\"],\"component---src-pages-test-fr-js\":[\"/component---src-pages-test-fr-js-2e0e5026d1423d984bd3.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-about-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-about-fr-mdx-234174a47aff34051a3b.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-essentials-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-essentials-fr-mdx-a727f97f7426a0fcb72e.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-index-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-index-fr-mdx-e105a42c9026274ac438.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-0-git-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-0-git-fr-mdx-23eb6d5421c779d8c7f4.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-0-index-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-0-index-fr-mdx-345cd01dbc7a63f426c9.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-0-info-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-0-info-fr-mdx-5a7c5c1c6ea080c1e763.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-0-js-context-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-0-js-context-fr-mdx-1e35c83aa14da11975da.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-0-js-language-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-0-js-language-fr-mdx-644fd3656ecdc2803479.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-1-express-api-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-1-express-api-fr-mdx-f22533146a5555437b7b.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-1-index-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-1-index-fr-mdx-52389c8c1add8a9a4ba8.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-1-json-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-1-json-fr-mdx-84a074fb5a0d618f9b83.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-1-nodejs-app-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-1-nodejs-app-fr-mdx-d107fdad200d3078fdee.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-1-refactoring-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-1-refactoring-fr-mdx-e217038c9d39f3a66295.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-1-tools-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-1-tools-fr-mdx-584105fdd3250173cba3.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-animations-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-animations-fr-mdx-7f59e6900a67c595ce2d.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-comms-security-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-comms-security-fr-mdx-f8f4ae66224f6c95d7ae.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-dom-interaction-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-dom-interaction-fr-mdx-52d546f7ac979b7f1a6d.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-dynamic-ui-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-dynamic-ui-fr-mdx-2e8c3129912e40d0f070.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-em-6-modules-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-em-6-modules-fr-mdx-de6b05454a1029afe162.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-index-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-index-fr-mdx-3e96ecb627004c2885b5.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-js-intro-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-js-intro-fr-mdx-dd39e63f0f0285dda633.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-modern-tools-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-modern-tools-fr-mdx-0e8efccde7c37ff8bf43.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-object-oriented-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-object-oriented-fr-mdx-f6f862913e401de0ef8a.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-promises-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-promises-fr-mdx-60ef84559646b874e3b0.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-routing-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-routing-fr-mdx-aeddd8e95f494c96544d.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-sessions-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-sessions-fr-mdx-ad759356a308a3ef2c9e.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-spa-architectures-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-spa-architectures-fr-mdx-282d12678066fadff160.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-ui-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-2-ui-fr-mdx-7d1fd7f341f69c8fc153.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-3-index-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-3-index-fr-mdx-78a27bac07450898b68a.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-4-auths-api-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-4-auths-api-fr-mdx-d7fbed8cfea8b4d7fd6f.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-4-auths-hmi-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-4-auths-hmi-fr-mdx-308e32466435fd09fe04.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-4-index-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-4-index-fr-mdx-c983d1c28d58e7272798.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-4-security-api-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-4-security-api-fr-mdx-485d41c8835bf241ab0f.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-public-projects-showcase-2020-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-public-projects-showcase-2020-mdx-c18c344c89f13e002b4a.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-public-projects-showcase-2021-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-public-projects-showcase-2021-mdx-a2393394362876bc9a8b.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-public-projects-showcase-2022-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-public-projects-showcase-2022-mdx-a0a502bf912c477f3dc8.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-references-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-references-fr-mdx-3a1e4229d008d60f9f66.js\"],\"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-repo-fr-mdx\":[\"/component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-repo-fr-mdx-8eec926ae0db364fea3a.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="cb4ece2d5a7cd3e9e7fb";</script><script src="/js2/webpack-runtime-e1eda001ed9e66dcb479.js" async></script><script src="/js2/framework-2e5b211a15610374bd3d.js" async></script><script src="/js2/cb1608f2-79a359b845df824af80c.js" async></script><script src="/js2/app-def0aae780f8a06d6c8b.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>