{"version":3,"file":"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-modules-7-fr-mdx-8b1da1db1302332be20d.js","mappings":"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","sources":["webpack://myjscourse/./src/mdx-pages/modules/7.fr.mdx","webpack://myjscourse/./src/templates/mdx-pages.js"],"sourcesContent":["/*@jsxRuntime classic @jsx React.createElement @jsxFrag React.Fragment*/\nimport {useMDXComponents as _provideComponents} from \"@mdx-js/react\";\nimport React from \"react\";\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h1: \"h1\",\n    p: \"p\",\n    br: \"br\",\n    ul: \"ul\",\n    li: \"li\",\n    a: \"a\",\n    h2: \"h2\",\n    h3: \"h3\",\n    strong: \"strong\",\n    h4: \"h4\",\n    code: \"code\",\n    pre: \"pre\",\n    h5: \"h5\"\n  }, _provideComponents(), props.components), {ScrollableImage} = _components;\n  if (!ScrollableImage) _missingMdxReference(\"ScrollableImage\", true);\n  return React.createElement(React.Fragment, null, React.createElement(_components.h1, null, \"Module 7 : SPA & sécurisation\"), \"\\n\", React.createElement(_components.p, null, \"Ce module vous offre principalement la sécurisation de SPA à l'aide d'authentification & autorisation JWT.\"), \"\\n\", React.createElement(_components.p, null, \"Dans un premier temps, nous allons voir comment sécuriser les accès aux opérations d'une API.\", React.createElement(_components.br), \"\\n\", \"Puis, nous allons voir comment intégrer ces API sécurisées au sein d'IHM.\"), \"\\n\", React.createElement(_components.p, null, \"En résumé, on souhaite sécuriser l'accès\\r\\naux utilisateurs, de façon moderne, à certaines opérations sur des ressources.\"), \"\\n\", React.createElement(_components.p, null, \"Voici les sujets traités :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"a) \", React.createElement(_components.a, {\n    href: \"#a\"\n  }, \"Authentification sécurisée et autorisation d'accès aux opérations d'une RESTful API via JWT\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"a.1) \", React.createElement(_components.a, {\n    href: \"#a1\"\n  }, \"Authentification et autorisation : généralités\")), \"\\n\", React.createElement(_components.li, null, \"a.2) \", React.createElement(_components.a, {\n    href: \"#a2\"\n  }, \"Token JWT\")), \"\\n\", React.createElement(_components.li, null, \"a.3) \", React.createElement(_components.a, {\n    href: \"#a3\"\n  }, \"Authentification & autorisation stateless via JWT & Express\")), \"\\n\", React.createElement(_components.li, null, \"a.4) \", React.createElement(_components.a, {\n    href: \"#a4\"\n  }, \"Client REST\")), \"\\n\"), \"\\n\"), \"\\n\", React.createElement(_components.li, null, \"b) \", React.createElement(_components.a, {\n    href: \"#b\"\n  }, \"Utilisation de JWT au sein d'une IHM\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"b.1) \", React.createElement(_components.a, {\n    href: \"#b1\"\n  }, \"Authentifier un utilisateur via une IHM & JWT\")), \"\\n\", React.createElement(_components.li, null, \"b.2) \", React.createElement(_components.a, {\n    href: \"#b2\"\n  }, \"Autoriser l'appel à une opération protégée\")), \"\\n\", React.createElement(_components.li, null, \"b.3) \", React.createElement(_components.a, {\n    href: \"#b3\"\n  }, \"Problèmes de sécurité\")), \"\\n\"), \"\\n\"), \"\\n\", React.createElement(_components.li, null, \"c) \", React.createElement(_components.a, {\n    href: \"#c\"\n  }, \"Exercice 7.1 : Authentification & autorisation au sein de myMovies\")), \"\\n\", React.createElement(_components.li, null, \"d) \", React.createElement(_components.a, {\n    href: \"#d\"\n  }, \"Sécurisation de RESTful API\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"d.1) \", React.createElement(_components.a, {\n    href: \"#d1\"\n  }, \"Introduction\")), \"\\n\", React.createElement(_components.li, null, \"d.2) \", React.createElement(_components.a, {\n    href: \"#d2\"\n  }, \"Protection contre les attaques XSS\")), \"\\n\", React.createElement(_components.li, null, \"d.3) \", React.createElement(_components.a, {\n    href: \"#d3\"\n  }, \"Sécurisation des passwords\")), \"\\n\"), \"\\n\"), \"\\n\", React.createElement(_components.li, null, \"e) \", React.createElement(_components.a, {\n    href: \"#e\"\n  }, \"Exercice 7.2 : Sécurisation de l'API de myMovies\")), \"\\n\", React.createElement(_components.li, null, \"f) \", React.createElement(_components.a, {\n    href: \"#f\"\n  }, \"🍬 Exercice 7.3 : Auto-refresh de myMovies\")), \"\\n\", React.createElement(_components.li, null, \"g) \", React.createElement(_components.a, {\n    href: \"#g\"\n  }, \"🍬 Exercice 7.4 : Gestion de la navigation lors de l'auto-refresh de myMovies\")), \"\\n\"), \"\\n\", React.createElement(_components.h1, null, React.createElement(\"a\", {\n    id: \"a\"\n  }), \"a) Authentification sécurisée et autorisation d'accès aux opérations d'une RESTful API via JWT\"), \"\\n\", React.createElement(_components.h2, null, React.createElement(\"a\", {\n    id: \"a1\"\n  }), \" a.1) Authentification et autorisation : généralités\"), \"\\n\", React.createElement(_components.h3, null, \"a.1.1) Authentification, c'est quoi ?\"), \"\\n\", React.createElement(_components.p, null, \"L'authentification, c'est le processus de vérifier qui est l'utilisateur d'une application.\"), \"\\n\", React.createElement(_components.p, null, \"Pour authentifier un utilisateur, on va généralement passer via un formulaire de connexion, lui demandant un username et un password.\"), \"\\n\", React.createElement(_components.h3, null, \"a.1.2) Autorisation, c'est quoi ?\"), \"\\n\", React.createElement(_components.p, null, \"L'autorisation, c'est le processus de vérifier ce à quoi un utilisateur à accès.\"), \"\\n\", React.createElement(_components.p, null, \"Une API va autoriser les accès à certaines opérations en fonction des privilèges associés aux utilisateurs. Il y aura des opérations qui seront autorisées :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"pour tous les utilisateurs, tant anonymes qu'authentifiés ; imaginez par exemple les opérations de lecture de produits sur un site \\\"vitrine\\\". Il ne faut pas devoir créer de compte utilisateur pour pouvoir afficher les produits du site.\"), \"\\n\", React.createElement(_components.li, null, \"pour tous les utilisateurs authentifiés, peu importe leurs privilèges ; imaginez le fait de pouvoir poster des messages dans un forum ; il faut avoir un compte pour pouvoir le faire, mais il ne faut pas de privilèges spécifiques (pas besoin d'être admin).\"), \"\\n\", React.createElement(_components.li, null, \"pour seulement un ou plusieurs utilisateur(s) authentifié(s) ayant les privilèges requis ; imaginez une opération de lecture de tous les profils des utilisateurs d'une banque ; il faut avoir un compte admin de la banque pour pouvoir le faire. Ca serait catastrophique si n'importe quel utilisateur authentifié pourrait accéder aux profils de tous les utilisateurs !\"), \"\\n\"), \"\\n\", React.createElement(_components.h3, null, \"a.1.3) Différents moyens d'authentification\"), \"\\n\", React.createElement(_components.p, null, \"Il existe de nombreux mécanismes d'authentification.\"), \"\\n\", React.createElement(_components.p, null, \"Traditionnellement, ou anciennement, nous avons l'authentification qui est supportée à l'aide de cookies. L'utilisateur envoie via un formulaire son username et password, le serveur vérifie ceux-ci et crée un id de session et le renvoie à l'utilisateur via un cookie.\", React.createElement(_components.br), \"\\n\", \"Après l'authentification, à chaque requête du client sur ce serveur, le cookie est envoyé, et le serveur, qui a sauvegardé la session, va retrouver la session sur base de l'id de session présent dans le cookie et va autoriser ou non l'accès à l'opération demandée par le client.\", React.createElement(_components.br), \"\\n\", \"C'est ce qu'on appelle une authentification \", React.createElement(_components.strong, null, \"stateful\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Un mécanisme d'authentification \", React.createElement(_components.strong, null, \"stateful\"), \" indique que le serveur est responsable de sauvegarder les données de session des utilisateurs.\"), \"\\n\", React.createElement(_components.p, null, \"On parle de \", React.createElement(_components.strong, null, \"session\"), \" d'un utilisateur comme étant toute la durée où le client s'authentifie à l'application web jusqu'à ce qu'il quitte cette application, lorsqu'il ferme son browser.\"), \"\\n\", React.createElement(_components.p, null, \"De manière plus moderne, nous avons des mécanismes d'authentification qui sont dits \", React.createElement(_components.strong, null, \"stateless\"), \". Dans ce genre de mécanisme, c'est le client qui doit sauvegarder les données de session, et donc le browser. L'authentification à l'aide de \", React.createElement(_components.strong, null, \"tokens\"), \" devient très populaires.\", React.createElement(_components.br), \"\\n\", \"Il existe différents moyen de l'implémenter. Dans le cadre de ce cours, nous focuserons sur la façon la plus habituelle, les \", React.createElement(_components.strong, null, \"JSON Web Tokens\"), \", ou \", React.createElement(_components.strong, null, \"JWT\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Il existe d'autres mécanismes très modernes qui utilisent des tokens, mis en place par des tiers : \", React.createElement(_components.strong, null, \"OAuth\"), \", \", React.createElement(_components.strong, null, \"OpenId\"), \"... Ces mécanismes sont offerts par Microsoft, Google, Facebook... Nous ne les verrons pas dans le cadre de cours. Néanmoins, à la fin de ce cours, vous devriez être apte à pouvoir les utiliser, sous réserve de bien lire la documentation.\"), \"\\n\", React.createElement(_components.h3, null, \"## \", React.createElement(\"a\", {\n    id: \"a1.4\"\n  }), \"  a.1.4) Stateful VS stateless authentication\"), \"\\n\", React.createElement(_components.p, null, \"Quels sont les avantages & inconvénients d'une authentification stateful ? et d'une authentification stateless ?\"), \"\\n\", React.createElement(_components.h4, null, \"Authentification stateful\"), \"\\n\", React.createElement(_components.p, null, React.createElement(_components.strong, null, \"Inconvénients\"), \" :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"La session utilise de la mémoire pour chaque utilisateur.\"), \"\\n\", React.createElement(_components.li, null, \"Le backend n'a aucune manière de déterminer si le frontend s'est déconnecté du site ou non : gestion de l'expiration d'une session plus compliquée, notamment si le frontend revient après une longue durée.\"), \"\\n\", React.createElement(_components.li, null, \"Toutes les sessions sont perdues en cas de redémarrage du serveur (réauthentification).\"), \"\\n\", React.createElement(_components.li, null, \"Load balancing compliqué ; en effet, si un client fait une requête, pendant toute la durée de la session, s'il y a plusieurs serveurs qui peuvent y répondre, comment est gérée la session de ce client ? Par quel(s) serveur(s) ? Comment se partagent-ils les données de session ? Ou est-ce que ça doit toujours être le même serveur qui répond au même client ?\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, React.createElement(_components.strong, null, \"Avantages\"), \" :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Peu gourmand en ressource point de vue processing et très rapide ; en effet, une fois qu'une session est en place, la vérification que le cookie contient le bon id de session se fait vite.\"), \"\\n\"), \"\\n\", React.createElement(_components.h4, null, \"Authentification stateless\"), \"\\n\", React.createElement(_components.p, null, React.createElement(_components.strong, null, \"Inconvénients\"), \" :\\r\\nComme le serveur ne retient plus l'utilisateur en mémoire, il doit utiliser de la cryptographie pour créer et valider les token ; c'est donc consommateur en ressource point de vue processing.\"), \"\\n\", React.createElement(_components.p, null, React.createElement(_components.strong, null, \"Avantages\"), \" :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Pas de session à gérer, même après redémarrage du serveur, il n'y a pas de réauthentification nécessaire.\"), \"\\n\", React.createElement(_components.li, null, \"Evolutif, utilisation facile de plusieurs serveurs si du load balancing est nécessaire ; en effet, comme chaque requête du client contient toutes les infos pour se faire autoriser, peu importe quel est le serveur qui va prendre en charge la requête.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Notons que la \\\"scalability\\\" horizontale, la possibilité de permettre à une application d'augmenter sa capacité de répondre à une charge grandissante simplement en ajoutant des machines, est quelque chose de très important à notre époque.\", React.createElement(_components.br), \"\\n\", \"Certaines applications web ont des centaines de millions d'utilisateurs ; pour celles-ci, on ne peut pas compter sur la \\\"scalability\\\" verticale, c'est-à-dire le fait d'augmenter les ressources d'une machine, en augmentant sa RAM, son processeur, son espace de stockage...\"), \"\\n\", React.createElement(_components.p, null, \"Dès lors, dans le cadre de ce cours, nous allons préférer les applications web qui peuvent tourner sur des serveurs \", React.createElement(_components.strong, null, \"stateless\"), \".\"), \"\\n\", React.createElement(_components.h2, null, React.createElement(\"a\", {\n    id: \"a2\"\n  }), \"a.2) Token JWT\"), \"\\n\", React.createElement(_components.p, null, \"Les JSON Web token, ou JWT, appartiennent à un standard internet permettant l'échange sécurisé de tokens entre plusieurs parties.\"), \"\\n\", React.createElement(_components.p, null, \"Un JWT contient trois parties encodées en base64 et ressemble à qqch du style :\", React.createElement(_components.br), \"\\n\", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.\")), React.createElement(_components.br), \"\\n\", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.\")), React.createElement(_components.br), \"\\n\", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c\"))), \"\\n\", React.createElement(_components.p, null, \"Voici les 3 parties d'un JWT et leurs caractéristiques :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"l'\", React.createElement(_components.strong, null, \"entête\"), \" (ou header) : un objet JSON identifiant le type de token (JWT) et l'algorithme utilisé pour générer la signature du token (HS256), un algorithme de hachage.\"), \"\\n\", React.createElement(_components.li, null, \"le \", React.createElement(_components.strong, null, \"payload\"), \" : un objet JSON permettant de spécifier le \", React.createElement(_components.strong, null, \"claim\"), \" ; ce sont des paramètres optionnels précisant les affirmations associées au token, comme la date d'expiration du token, son créateur, le fait que l'utilisateur est admin... généralement, on y met pas trop d'info, principalement l'identifiant de l'utilisateur ; si l'API a besoin de plus d'info concernant l'utilisateur, elle ira généralement les chercher dans son support de données.\"), \"\\n\", React.createElement(_components.li, null, \"la \", React.createElement(_components.strong, null, \"signature\"), \" : c'est une signature numérique construite à partir d'un secret privé ou d'une clé publique/privée, via l'algorithme précisé dans la signature.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"💭 C'est bien joli tout ça, mais comment ça permet de sécuriser la session d'un utilisateur ?\", React.createElement(_components.br), \"\\n\", \"Généralement, l'API, et elle uniquement, connait le secret privé. Elle va donc créer le token d'un utilisateur authentifié, en y ajoutant le claim (ou les affirmations) qu'elle juge utile.\", React.createElement(_components.br), \"\\n\", \"Lorsque le client reçoit son token, il va le sauvegarder dans son browser.\", React.createElement(_components.br), \"\\n\", \"Pour chaque requête où il devra se faire autoriser par l'API, le client enverra son token au sein d'un header de la requête.\", React.createElement(_components.br), \"\\n\", \"L'API utilisera le secret privé, connu d'elle-même uniquement, pour vérifier la signature du token. Si tout est OK, c'est que l'utilisateur est bien authentifié et que son claim est OK.\"), \"\\n\", React.createElement(_components.p, null, \"Imaginez maintenant qu'un hackeur tente de modifier le token, pour modifier le claim, notamment en changeant l'id de l'utilisateur présent dans le payload du token.\\r\\nEt bien la signature ne correspondra plus à ce token là ! L'API le détectera.\", React.createElement(_components.br), \"\\n\", \"Pour que le hackeur réussisse son acte malicieux, il est obligé de connaître le secret privé qui ne doit être connu que de l'API.\", React.createElement(_components.br), \"\\n\", \"Les hackeurs devront connaître le secret privé afin de pouvoir générer un nouveau token qui sera validé par l'API. Pas évident...\"), \"\\n\", React.createElement(_components.p, null, \"Ainsi, on peut imaginer un token comme une enveloppe sécurisé par un cadenas très spécial : ce cadenas, qui est mis sur l'enveloppe contenant, par exemple, l'identifiant d'un utilisateur, est fermé par la clé 🔑 que seulement connaît l'API.\\r\\nSi quelqu'un touche à l'enveloppe, le cadenas ne s'ouvrira plus avec la 🔑 de l'API : la tentative de hackage sera détectée !\\r\\nSi quelqu'un tente de créer une enveloppe sécurisé, il le fera avec une autre clé, \", React.createElement(_components.strong, null, \"🗝\"), \" par exemple, car il ne connaît pas 🔑. L'API, tentant d'ouvrir l'enveloppe sécurisée à l'aide de 🔑, elle ne s'ouvrira pas : la tentative de hacking sera détectée !\"), \"\\n\", React.createElement(_components.p, null, \"💭 Est-ce que cette métaphore d'enveloppe sécurisée vous parle ?\\r\\nAttention que dans la réalité, le payload classique d'un token sera décodable, que l'on connaisse ou pas le secret privé. Il est encodé en base64 ! Ne mettez donc jamais de secrets dans le payload d'un token !\", React.createElement(_components.br), \"\\n\", \"Si vraiment un jour vous deviez mettre un secret dans un payload, bien que déconseillé, vous pourriez toujours le faire en cryptant le payload.\"), \"\\n\", React.createElement(_components.p, null, \"👍 Le mécanisme de token assure que l'on aie une très haute probabilité de détecter les altérations faites sur les tokens, les tentatives de forgeage, grâce à la signature de ceux-ci.\", React.createElement(_components.br), \"\\n\", \"⚡ Par contre, si nous laissons traîner des informations dans le payload d'un token, comme un password d'un utilisateur et son username, alors là, c'est juste un beau cadeau pour les hackeurs, il n'auront qu'à utiliser le formulaire de connexion et prendre possession de notre identité 😨.\"), \"\\n\", React.createElement(_components.p, null, \"Il existe un site fort intéressant qui montre la structure d'un token et qui permet de les décoder : \", React.createElement(_components.a, {\n    href: \"https://jwt.io/\"\n  }, \"jwt.io\"), \" \", React.createElement(_components.a, {\n    href: \"/js2/references/#r63\"\n  }, \"[R.63]\"), \". Nous l'utiliserons plus tard pour décoder les tokens générés par nos RESTful API.\"), \"\\n\", React.createElement(_components.h2, null, React.createElement(\"a\", {\n    id: \"a3\"\n  }), \"a.3) Authentification & autorisation stateless via JWT & Express\"), \"\\n\", React.createElement(_components.h3, null, \"a.2.1) Introduction\"), \"\\n\", React.createElement(_components.p, null, \"Via un exemple concret associé à notre RESTful API qui gère les ressources de type \\\"pizzas\\\", nous allons mettre en place un processus d'authentification et d'autorisation JWT.\"), \"\\n\", React.createElement(_components.p, null, \"La librairie que nous allons utiliser dans le cadre de ce cours pour gérer des tokens JWT est \", React.createElement(_components.a, {\n    href: \"https://www.npmjs.com/package/jsonwebtoken\"\n  }, \"jsonwebtoken\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Nous allons maintenant continuer le développement de l'API \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/fat-model\"\n  }, \"fat-model\"), \" pour ajouter des opérations permettant l'authentification et l'autorisation d'utilisateurs.\"), \"\\n\", React.createElement(_components.p, null, \"Au sein de votre repo \", React.createElement(_components.strong, null, \"web2\"), \", veuillez créer le projet nommé \", React.createElement(_components.strong, null, \"/web2/tutorials/pizzeria/api/auths\"), \" sur base d'un copié collé de \", React.createElement(_components.strong, null, \"/web2/tutorials/pizzeria/api/fat-model\"), \" (ou \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/fat-model\"\n  }, \"fat-model\"), \").\"), \"\\n\", React.createElement(_components.p, null, \"Pour la suite du tutoriel, nous considérons que tous les chemins absolus démarrent du répertoire\\r\\n\", React.createElement(_components.strong, null, \"/web2/tutorials/pizzeria/api/auths\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez installer la librairie \", React.createElement(_components.strong, null, \"jsonwebtoken\"), \" au sein de votre nouveau projet \", React.createElement(_components.strong, null, \"auths\"), \" :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-bash\"\n  }, \"npm i jsonwebtoken\\n\")), \"\\n\", React.createElement(_components.h3, null, \"a.3.2) Mécanisme d'authentification et création du token\"), \"\\n\", React.createElement(_components.p, null, \"Toujours à l'aide d'Express, nous allons créer un router \", React.createElement(_components.strong, null, \"auths\"), \" qui mettra à disposition les opérations de \", React.createElement(_components.strong, null, \"login\"), \" et de \", React.createElement(_components.strong, null, \"register\"), \".\\r\\nVoici le contrat associé à ces nouvelles opérations :\"), \"\\n\", React.createElement(_components.h5, null, \"Opérations sur les ressources de type \\\"auths\\\"\"), \"\\n\", React.createElement(_components.p, null, \"| URI | Méthode HTTP | Opération |\\r\\n|---|---|---|---|\\r\\n| \", React.createElement(_components.strong, null, \"auths/login\"), \" | POST | Vérifier les credentials d'une ressource de type \\\"users\\\" et renvoyer le username et un token JWT si les credentials sont OK |\\r\\n| \", React.createElement(_components.strong, null, \"auths/register\"), \" | POST | Créer une ressource de type \\\"users\\\" et renvoyer le username et un token JWT |\"), \"\\n\", React.createElement(\"br\"), \"\\n\", React.createElement(_components.p, null, \"Le modèle \", React.createElement(_components.strong, null, \"users\"), \" s'occupera de créer les utilisateur, de vérifier leurs credentials ainsi que de créer des token.\"), \"\\n\", React.createElement(_components.p, null, \"Voici le workflow attendu pour une opération de \", React.createElement(_components.strong, null, \"login\"), \" ou de \", React.createElement(_components.strong, null, \"register\"), \" :\"), \"\\n\", React.createElement(ScrollableImage, {\n    name: \"login.png\",\n    minWidth: \"879px\",\n    maxWidth: \"879x\"\n  }), \"\\n\", React.createElement(\"figcaption\", null, \"Appel à une RESTful API pour s'authentifier et obtenir un JWT\"), \"\\n\", React.createElement(_components.p, null, \"Ce que l'on voit dans l'image ci-dessus :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"si le modèle considère que l'utilisateur est authentifiable, que ses credentials sont OK, alors il va utiliser une librairie \", React.createElement(_components.strong, null, \"jwt\"), \" et la méthode \", React.createElement(_components.strong, null, \"sign\"), \" pour créer un token.\"), \"\\n\", React.createElement(_components.li, null, \"le token est envoyé dans le body de la réponse à l'utilisateur.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Ce que l'on ne voit pas dans l'image ci-dessus :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"c'est le job du client de sauvegarder le token. Si l'application cliente est un browser, alors celui-ci pourra être sauvegardé dans le web storage du browser.\"), \"\\n\", React.createElement(_components.li, null, \"l'application cliente peut être faite avec n'importe quelle technologie. Par exemple, nous pourrons utiliser REST Client pour faire une requête à l'API...\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Dans notre RESTful API, nous avons décidé que lorsqu'un client s'enregistre, quand il fait appel à l'opération \", React.createElement(_components.strong, null, \"register\"), \" pour créer un compte, l'API considère automatiquement que cet utilisateur est authentifié. Tout comme la méthode \", React.createElement(_components.strong, null, \"login\"), \", la méthode \", React.createElement(_components.strong, null, \"register\"), \" créera et renverra un token JWT à l'utilisateur.\"), \"\\n\", React.createElement(_components.p, null, \"NB : Il est possible d'envisager un workflow différent : après le \", React.createElement(_components.strong, null, \"register\"), \", l'application demanderait à l'utilisateur un \", React.createElement(_components.strong, null, \"login\"), \", \", React.createElement(_components.strong, null, \"register\"), \" ne renvoyant jamais de token à l'utilisateur.\"), \"\\n\", React.createElement(_components.p, null, \"Nous allons à présent mettre en place le code permettant d'implémenter le workflow que l'on vient de découvrir.\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez créer le modèle \", React.createElement(_components.strong, null, \"users\"), \" en créant le fichier \", React.createElement(_components.strong, null, \"/models/users.js\"), \" et y inclure ce code :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"const jwt = require('jsonwebtoken');\\r\\nconst path = require('node:path');\\r\\nconst { parse, serialize } = require('../utils/json');\\r\\n\\r\\nconst jwtSecret = 'ilovemypizza!';\\r\\nconst lifetimeJwt = 24 * 60 * 60 * 1000; // in ms : 24 * 60 * 60 * 1000 = 24h\\r\\n\\r\\nconst jsonDbPath = path.join(__dirname, '/../data/users.json');\\r\\n\\r\\nconst defaultUsers = [\\r\\n  {\\r\\n    id: 1,\\r\\n    username: 'admin',\\r\\n    password: 'admin',\\r\\n  },\\r\\n];\\r\\n\\r\\nfunction login(username, password) {\\r\\n  const userFound = readOneUserFromUsername(username);\\r\\n  if (!userFound) return undefined;\\r\\n  if (userFound.password !== password) return undefined;\\r\\n\\r\\n  const token = jwt.sign(\\r\\n    { username }, // session data added to the payload (payload : part 2 of a JWT)\\r\\n    jwtSecret, // secret used for the signature (signature part 3 of a JWT)\\r\\n    { expiresIn: lifetimeJwt }, // lifetime of the JWT (added to the JWT payload)\\r\\n  );\\r\\n\\r\\n  const authenticatedUser = {\\r\\n    username,\\r\\n    token,\\r\\n  };\\r\\n\\r\\n  return authenticatedUser;\\r\\n}\\r\\n\\r\\nfunction register(username, password) {\\r\\n  const userFound = readOneUserFromUsername(username);\\r\\n  if (userFound) return undefined;\\r\\n\\r\\n  createOneUser(username, password);\\r\\n\\r\\n  const token = jwt.sign(\\r\\n    { username }, // session data added to the payload (payload : part 2 of a JWT)\\r\\n    jwtSecret, // secret used for the signature (signature part 3 of a JWT)\\r\\n    { expiresIn: lifetimeJwt }, // lifetime of the JWT (added to the JWT payload)\\r\\n  );\\r\\n\\r\\n  const authenticatedUser = {\\r\\n    username,\\r\\n    token,\\r\\n  };\\r\\n\\r\\n  return authenticatedUser;\\r\\n}\\r\\n\\r\\nfunction readOneUserFromUsername(username) {\\r\\n  const users = parse(jsonDbPath, defaultUsers);\\r\\n  const indexOfUserFound = users.findIndex((user) => user.username === username);\\r\\n  if (indexOfUserFound < 0) return undefined;\\r\\n\\r\\n  return users[indexOfUserFound];\\r\\n}\\r\\n\\r\\nfunction createOneUser(username, password) {\\r\\n  const users = parse(jsonDbPath, defaultUsers);\\r\\n\\r\\n  const createdUser = {\\r\\n    id: getNextId(),\\r\\n    username,\\r\\n    password,\\r\\n  };\\r\\n\\r\\n  users.push(createdUser);\\r\\n\\r\\n  serialize(jsonDbPath, users);\\r\\n\\r\\n  return createdUser;\\r\\n}\\r\\n\\r\\nfunction getNextId() {\\r\\n  const users = parse(jsonDbPath, defaultUsers);\\r\\n  const lastItemIndex = users?.length !== 0 ? users.length - 1 : undefined;\\r\\n  if (lastItemIndex === undefined) return 1;\\r\\n  const lastId = users[lastItemIndex]?.id;\\r\\n  const nextId = lastId + 1;\\r\\n  return nextId;\\r\\n}\\r\\n\\r\\nmodule.exports = {\\r\\n  login,\\r\\n  register,\\r\\n  readOneUserFromUsername,\\r\\n};\\r\\n\\n\")), \"\\n\", React.createElement(_components.p, null, \"Dans le code ci-dessus, \", React.createElement(_components.strong, null, \"jwtSecret\"), \" est le secret privé connu uniquement du serveur. C'est la même secret qu'il faudra utiliser pour vérifier un token.\"), \"\\n\", React.createElement(_components.p, null, React.createElement(_components.strong, null, React.createElement(_components.code, null, \"jwt.sign()\")), \" permet de créer le token et ses 3 parties :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"le payload du token, la 2ème partie du token, est complété principalement via le permier argument de \", React.createElement(_components.strong, null, \"sign()\"), \" ; ici, le token affirme que l'utilisateur possédant le \", React.createElement(_components.strong, null, \"username\"), \" donné est authentifié.\"), \"\\n\", React.createElement(_components.li, null, \"le payload du token sera aussi modifié sur base de la durée d'expiration du token, selon l'argument \", React.createElement(_components.strong, null, \"expiresIn\"), \".\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"jwtSecret\"), \" est utilisé pour créer la 3ème partie du token, sa signature.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Il faut maintenant que nous créions le router \", React.createElement(_components.strong, null, \"auths\"), \" offrant les opérations de \", React.createElement(_components.strong, null, \"login\"), \" et de \", React.createElement(_components.strong, null, \"register\"), \", en faisant appel au modèle \", React.createElement(_components.strong, null, \"users\"), \".\", React.createElement(_components.br), \"\\n\", \"Veuillez créer le fichier \", React.createElement(_components.strong, null, \"/routes/auths.js\"), \" et y inclure le code suivant :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"const express = require('express');\\r\\nconst { register, login } = require('../models/users');\\r\\n\\r\\nconst router = express.Router();\\r\\n\\r\\n/* Register a user */\\r\\nrouter.post('/register', (req, res) => {\\r\\n  const username = req?.body?.username?.length !== 0 ? req.body.username : undefined;\\r\\n  const password = req?.body?.password?.length !== 0 ? req.body.password : undefined;\\r\\n\\r\\n  if (!username || !password) return res.sendStatus(400); // 400 Bad Request\\r\\n\\r\\n  const authenticatedUser = register(username, password);\\r\\n\\r\\n  if (!authenticatedUser) return res.sendStatus(409); // 409 Conflict\\r\\n\\r\\n  return res.json(authenticatedUser);\\r\\n});\\r\\n\\r\\n/* Login a user */\\r\\nrouter.post('/login', (req, res) => {\\r\\n  const username = req?.body?.username?.length !== 0 ? req.body.username : undefined;\\r\\n  const password = req?.body?.password?.length !== 0 ? req.body.password : undefined;\\r\\n\\r\\n  if (!username || !password) return res.sendStatus(400); // 400 Bad Reques\\r\\n\\r\\n  const authenticatedUser = login(username, password);\\r\\n\\r\\n  if (!authenticatedUser) return res.sendStatus(401); // 401 Unauthorized\\r\\n\\r\\n  return res.json(authenticatedUser);\\r\\n});\\r\\n\\r\\nmodule.exports = router;\\n\")), \"\\n\", React.createElement(_components.p, null, \"Il n'y a rien de bien spécial à ce code. On fait simplement appel aux opérations du modèle \", React.createElement(_components.strong, null, \"users\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Attention, il faut rajouter le nouveau router au sein de \", React.createElement(_components.strong, null, \"app.js\"), \" pour que notre API puisse offrir les nouvelles opérations. Veuillez ajouter ce code dans \", React.createElement(_components.strong, null, \"/app.js\"), \" :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"const express = require('express');\\r\\nconst cookieParser = require('cookie-parser');\\r\\nconst logger = require('morgan');\\r\\n\\r\\nconst usersRouter = require('./routes/users');\\r\\nconst pizzaRouter = require('./routes/pizzas');\\r\\nconst authsRouter = require('./routes/auths');\\r\\n\\r\\nconst app = express();\\r\\n\\r\\napp.use(logger('dev'));\\r\\napp.use(express.json());\\r\\napp.use(express.urlencoded({ extended: false }));\\r\\napp.use(cookieParser());\\r\\n\\r\\napp.use('/users', usersRouter);\\r\\napp.use('/pizzas', pizzaRouter);\\r\\napp.use('/auths', authsRouter);\\r\\n\\r\\nmodule.exports = app;\\n\")), \"\\n\", React.createElement(_components.p, null, \"Veuillez démarrer votre API \", React.createElement(_components.strong, null, \"auths\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"💭 Comment tester ces nouvelles opérations ?\\r\\nHé bien rien de neuf, on va utiliser REST Client.\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez créer le fichier \", React.createElement(_components.strong, null, \"/REST Client/auths.http\"), \" et y ajouter le code suivant :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-http\"\n  }, \"@baseUrl = http://localhost:3000\\r\\n\\r\\n### Try to login an unknow user\\r\\nPOST {{baseUrl}}/auths/login\\r\\nContent-Type: application/json\\r\\n\\r\\n{\\r\\n    \\\"username\\\":\\\"unknown\\\",\\r\\n    \\\"password\\\":\\\"admin\\\"\\r\\n}\\r\\n\\r\\n### Login the default admin\\r\\nPOST {{baseUrl}}/auths/login\\r\\nContent-Type: application/json\\r\\n\\r\\n{\\r\\n    \\\"username\\\":\\\"admin\\\",\\r\\n    \\\"password\\\":\\\"admin\\\"\\r\\n}\\r\\n\\r\\n\\r\\n### Create the manager user\\r\\nPOST {{baseUrl}}/auths/register\\r\\nContent-Type: application/json\\r\\n\\r\\n{\\r\\n    \\\"username\\\":\\\"manager\\\",\\r\\n    \\\"password\\\":\\\"manager\\\"\\r\\n}\\r\\n\\r\\n### Login the manager user\\r\\nPOST {{baseUrl}}/auths/login\\r\\nContent-Type: application/json\\r\\n\\r\\n{\\r\\n    \\\"username\\\":\\\"manager\\\",\\r\\n    \\\"password\\\":\\\"manager\\\"\\r\\n}\\n\")), \"\\n\", React.createElement(_components.p, null, \"Veuillez exécuter les différentes requêtes. Tout devrait fonctionner, vous devriez récupérer le username et le token d'un utilisateur authentifié.\"), \"\\n\", React.createElement(_components.p, null, \"Pour le fun, nous allons décoder un token. Veuillez copier le token de ce que renvoie votre API pour la requête de login de l'utilisateur \", React.createElement(_components.strong, null, \"manager\"), \" (qqch qui doit ressembler à une string du genre : \", React.createElement(_components.code, null, \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Im1hbmFnZXIiLCJpYXQiOjE2NjEyNDg1MjksImV4cCI6MTc0NzY0ODUyOX0.JvYzM0gtmVkqFr9R3f1Bf6ow_QuyHJY-vedJ39N7JKw\"), \").\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez vous rendre sur le site \", React.createElement(_components.a, {\n    href: \"https://jwt.io/\"\n  }, \"JWT\"), \" et coller votre token dans le champs \", React.createElement(_components.strong, null, \"Encoded\"), \". Dans la colonne \", React.createElement(_components.strong, null, \"Decoded\"), \", vous devriez voir l'algorithme utilisé par la méthode \", React.createElement(_components.strong, null, \"sign\"), \", ainsi que les données présentes dans le payload, dont \", React.createElement(_components.code, null, \"\\\"username\\\": \\\"manager\\\"\"), \" !\", React.createElement(_components.br), \"\\n\", \"Vous comprenez pourquoi on n'ajoute pas des secrets dans un token 😉.\"), \"\\n\", React.createElement(_components.h4, null, \"🍬 Cacher ses secrets\"), \"\\n\", React.createElement(_components.p, null, \"Dans ce cours-ci, nous ne verrons pas directement comment faire en sorte que le secret,  permettant de signer & vérifier les token, ne soit pas présent sur le web repository de vos API (par exemple ici le modèle \", React.createElement(_components.strong, null, \"users.js\"), \" hardcode ce secret). En effet, pour des raisons de sécurité, si votre secret est visible pour tous les développeurs qui accède à votre repository public, c'est un problème.\", React.createElement(_components.br), \"\\n\", \"Si vous souhaitez découvrir comment faire en sorte de rendre invisible des informations sensibles sur un web repository, tout en pouvant bénéficiant de ces infos dans votre environnement de développement, vous pouvez utiliser la librairie \", React.createElement(_components.a, {\n    href: \"https://www.npmjs.com/package/dotenv\"\n  }, \"dotenv\"), \" qui permet de gérer facilement des variables d'environnement. C'est ce genre de librairies qui est utilisée par les professionnels pour cacher leurs secrets et certaines variables de configuration, comme le password pour se connecter à une DB, l'URL vers une API, le port de l'application...\"), \"\\n\", React.createElement(_components.h3, null, \"a.3.3) Mécanisme d'autorisation et vérification du token\"), \"\\n\", React.createElement(_components.p, null, \"Suite au \", React.createElement(_components.strong, null, \"register\"), \" ou au \", React.createElement(_components.strong, null, \"login\"), \" de l'utilisateur, tel qu'il a été décidé pour notre RESTful API, celui-ci a reçu un token. C'est le job de l'application cliente de trouver un moyen de sauvegarder ce token.\"), \"\\n\", React.createElement(_components.p, null, \"Lorsqu'une application client souhaite créer une pizza, on souhaite autoriser cette opération qu'à l'administrateur du site gérant la pizzéria.\", React.createElement(_components.br), \"\\n\", \"Nous décidons donc pour l'opération de création de pizza que l'utilisateur doit non seulement être authentifié, mais qu'en plus, il doit être l'admin.\"), \"\\n\", React.createElement(_components.p, null, \"Pour que l'application client qui fait la requête à l'API puisse s'autoriser, elle doit ajouter un \", React.createElement(_components.strong, null, \"authorization header\"), \" à sa requête contenant comme valeur le token reçu lors du \", React.createElement(_components.strong, null, \"login\"), \" ou du \", React.createElement(_components.strong, null, \"register\"), \" :\"), \"\\n\", React.createElement(ScrollableImage, {\n    name: \"authorizeOK.png\",\n    minWidth: \"879px\",\n    maxWidth: \"879x\"\n  }), \"\\n\", React.createElement(\"figcaption\", null, \"Appel à une opération d'une RESTful API nécessitant une autorisation JWT : autorisation valide\"), \"\\n\", React.createElement(_components.p, null, \"Le router de \\\"pizzas\\\", avant même de passer la requête à la route \", React.createElement(_components.strong, null, \"POST /pizzas\"), \", va lancer la fonction middleware d'autorisation nommée \", React.createElement(_components.strong, null, \"authorize\"), \". La fonction middleware \", React.createElement(_components.strong, null, \"authorize\"), \" va s'occuper de vérifier le token envoyé par le client dans un header à l'aide de la méthode \", React.createElement(_components.strong, null, \"verifiy\"), \" de la librairie \", React.createElement(_components.strong, null, \"jwt\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"💭 Si le token est valide, est-ce que ça signifie que l'utilisateur est bien authentifié ?\\r\\nHé bien non, car imaginez qu'entre le moment où l'utilisateur se soit logué, il ait été supprimé de l'application par un admin... dans ce cas-ci, on ne veut pas l'autoriser à ajouter une pizza au menu de la pizzeria ! Il n'est p-e même plus un employé, il souhaite p-e écrire du contenu malicieux 😨\"), \"\\n\", React.createElement(_components.p, null, \"Donc si le token est valide, \", React.createElement(_components.strong, null, \"authorize\"), \" fera appel au modèle de \", React.createElement(_components.strong, null, \"users\"), \" pour vérifier que l'utilisateur existe bien dans le support de données (fichiers JSON, base de données ou autres) et pour obtenir toutes les infos sur cet utilisateur. Si l'utilisateur existe, alors cela signifie que l'utilisateur est bien authentifié. La fonction middleware \", React.createElement(_components.strong, null, \"authorize\"), \" va passer la main à une autre fonction middleware pour vérifier que l'utilisateur est bien l'admin.\"), \"\\n\", React.createElement(_components.p, null, \"💭 Comment est-ce que \", React.createElement(_components.strong, null, \"authorize\"), \" peut faire appel au modèle pour vérifier que l'utilisateur existe bien ? Est-ce que cela signifie que le token doit contenir tout un tas de données sur l'utilisateur ?\\r\\n👍 En règle générale, on va juste mettre un identifiant de l'utilisateur dans ce qu'on appelle le \", React.createElement(_components.strong, null, \"payload\"), \" du token. C'est ensuite l'API, suite au décodage de l'identifiant de l'utilisateur, qui fera appel au support de données pour retrouver toutes les données de l'utilisateur.\"), \"\\n\", React.createElement(_components.p, null, \"NB : notez que l'on pourrait aussi laisser la fonction \", React.createElement(_components.strong, null, \"createOnePizza\"), \" s'occuper de vérifier que l'utilisateur demandant la création de la pizza soit bien l'admin. Ici, comme il s'agit de vérifier que le contrat de l'API soit respecté, c'est-à-dire que l'utilisateur soit bien authentifié & admin, alors on préfère réaliser cette action en dehors du modèle, car dans nos choix architecturaux au niveau de nos RESTful API, nous avons décidé que ce n'est pas le modèle qui s'occupe de présenter les données aux clients.\"), \"\\n\", React.createElement(_components.p, null, \"La fonction middleware \", React.createElement(_components.strong, null, \"isAdmin\"), \" va vérifier que l'utilisateur est bien l'admin. Si c'est OK, elle passera la main à la fonction middleware qui gère la route \", React.createElement(_components.strong, null, \"POST /pizzas\"), \" au sein du router de pizzas en faisant l'appel à la fonction \", React.createElement(_components.strong, null, \"next\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Maintenant que le client a les bons privilèges, l'opération de création de la pizza peut donc être autorisée. L'opération de \", React.createElement(_components.strong, null, \"createOnePizza\"), \" du modèle renverra la nouvelle pizza au router qui s'occupera de présenter la nouvelle pizza au client, au format JSON.\"), \"\\n\", React.createElement(_components.p, null, \"Par contre, voici le workflow si le token n'est pas valide :\"), \"\\n\", React.createElement(ScrollableImage, {\n    name: \"authorizeNOK.png\",\n    minWidth: \"879px\",\n    maxWidth: \"879x\"\n  }), \"\\n\", React.createElement(\"figcaption\", null, \"Appel à une opération d'une RESTful API nécessitant une autorisation JWT : autorisation invalide\"), \"\\n\", React.createElement(_components.p, null, \"Dans ce cas là, \", React.createElement(_components.strong, null, \"authorize\"), \" ne passe pas la main à \", React.createElement(_components.strong, null, \"isAdmin\"), \" ni même à la fonction middleware qui gère la route \", React.createElement(_components.strong, null, \"POST /pizzas\"), \".\", React.createElement(_components.br), \"\\n\", \"La fonction middleware \", React.createElement(_components.strong, null, \"authorize\"), \" renvoie directement un code d'erreur \", React.createElement(_components.strong, null, \"401 Unauthorized\"), \" au client.\"), \"\\n\", React.createElement(_components.p, null, \"Vous pourriez aussi imaginer le workflow où le client envoie un token valide, mais l'utilisateur associé n'est pas admin. Dans ce cas-ci, \", React.createElement(_components.strong, null, \"authorize\"), \" ferait appel à \", React.createElement(_components.strong, null, \"isAdmin\"), \", mais \", React.createElement(_components.strong, null, \"isAdmin\"), \" renverrait directement un code d'erreur \", React.createElement(_components.strong, null, \"403 Forbidden\"), \" au client.\", React.createElement(_components.br), \"\\n\", \"En effet, l'API indiquerait ainsi qu'elle aurait vérifié que l'utilisateur est bien authentifié, mais que celui ne possède pas les privilèges suffisant pour accéder à l'opération demandée.\"), \"\\n\", React.createElement(_components.p, null, \"😨 Wow, le workflow d'autorisation pour la création d'une pizza est assez long.  Nous allons maintenant l'implémenter. Nous vous inquiétez pas, ce qui importe dans le code qui va suivre, ce n'est pas de savoir écrire tout le code, mais de bien comprendre le mécanisme. En effet, en règle générale, vous allez utiliser des librairies vous permettant d'autoriser les accès aux opérations de vos API. Vous écrirez donc rarement le mécanisme d'autorisation, par contre, vous devrez pouvoir utiliser ces mécanismes.\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez créer les nouvelles fonctions middleware \", React.createElement(_components.strong, null, \"authorize\"), \" et \", React.createElement(_components.strong, null, \"isAdmin\"), \" au sein d'un nouveau fichier \", React.createElement(_components.strong, null, \"/utils/auths.js\"), \" :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"const jwt = require('jsonwebtoken');\\r\\nconst { readOneUserFromUsername } = require('../models/users');\\r\\n\\r\\nconst jwtSecret = 'ilovemypizza!';\\r\\n\\r\\nconst authorize = (req, res, next) => {\\r\\n  const token = req.get('authorization');\\r\\n  if (!token) return res.sendStatus(401);\\r\\n\\r\\n  try {\\r\\n    const decoded = jwt.verify(token, jwtSecret);\\r\\n    const { username } = decoded;\\r\\n\\r\\n    const existingUser = readOneUserFromUsername(username);\\r\\n\\r\\n    if (!existingUser) return res.sendStatus(401);\\r\\n\\r\\n    req.user = existingUser; // request.user object is available in all other middleware functions\\r\\n    return next();\\r\\n  } catch (err) {\\r\\n    console.error('authorize: ', err);\\r\\n    return res.sendStatus(401);\\r\\n  }\\r\\n};\\r\\n\\r\\nconst isAdmin = (req, res, next) => {\\r\\n  const { username } = req.user;\\r\\n\\r\\n  if (username !== 'admin') return res.sendStatus(403);\\r\\n  return next();\\r\\n};\\r\\n\\r\\nmodule.exports = { authorize, isAdmin };\\n\")), \"\\n\", React.createElement(_components.p, null, \"Quelques explications sur le code de la fonction middleware \", React.createElement(_components.strong, null, \"authorize\"), \" :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Grâce à \", React.createElement(_components.code, null, \"req.get('authorization')\"), \", on récupère le token qui a été envoyé par le client au sein de l'\", React.createElement(_components.strong, null, \"authorization header\"), \" de la requête, c'est une string.\"), \"\\n\", React.createElement(_components.li, null, \"La méthode \", React.createElement(_components.code, null, \"jwt.verify(token, jwtSecret)\"), \" vérifie tant la signature du token que le fait que le token n'a pas encore expiré. Elle utilise le secret \", React.createElement(_components.strong, null, \"jwtSecret\"), \" qui doit être le même que celui pris en compte lors de la création du token.\"), \"\\n\", React.createElement(_components.li, null, \"Elle charge toutes les données de l'utilisateur authentifié au sein de l'objet \", React.createElement(_components.strong, null, \"request\"), \", dans \", React.createElement(_components.strong, null, \"user\"), \". Cela est une bonne pratique, cela permet, pour toute la durée du traitement de cette requête, de mettre à disposition ces données à toutes les fonctions middleware.\", React.createElement(_components.br), \"\\n\", \"💭 Mais pourquoi faire cela ?\\r\\nImaginez que vous faites un appel à une base de données externes à chaque fois que vous souhaitez obtenir les informations d'un utilisateur... Cela est très consommateur en temps... Lorsque vous allez utiliser d'autres fonctions middleware comme \", React.createElement(_components.strong, null, \"isAdmin\"), \", vous n'avez plus besoin de faire appel à la base de données.\"), \"\\n\", React.createElement(_components.li, null, \"💭 Qu'est-ce que ce code : \", React.createElement(_components.code, null, \"const { username } = decoded;\"), \" ?\", React.createElement(_components.br), \"\\n\", \"C'est ce que l'on appelle du \", React.createElement(_components.strong, null, \"destructuring assignement\"), \", c'est une façon très concise en JS de créer des variables à partir de propriétés d'objets ou des valeurs d'arrays.\", React.createElement(_components.br), \"\\n\", \"Imaginez ici que la valeur de \", React.createElement(_components.code, null, \"decoded\"), \" soit \", React.createElement(_components.code, null, \"{ username: 'admin', iat: 1661251095, exp: 1747651095 }\"), \". Ce code \", React.createElement(_components.code, null, \"const { username } = decoded;\"), \" est l'équivalent de \", React.createElement(_components.code, null, \"const username = decoded.username;\"), \". OK, mais ça n'a pas vraiment de valeur ajoutée ici, c'est juste un poil plus concis... Cela devient vraiment intéressant quand vous souhaitez créer plusieurs variables, comme pour l'exemple donné, on pourrait créer 3 variables ainsi \", React.createElement(_components.code, null, \"const { username, iat, exp } = decoded;\"), \" au lieu d'écrire :\"), \"\\n\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"const username = decoded.username;\\r\\nconst iat = decoded.iat;\\r\\nconst exp = decoded.exp;\\n\")), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Pour en savoir plus sur la puissance du \", React.createElement(_components.strong, null, \"destructuring assignement\"), \", vous pouvez consulter la \", React.createElement(_components.a, {\n    href: \"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment\"\n  }, \"documentation de MDN\"), \" \", React.createElement(_components.a, {\n    href: \"/js2/references/#r64\"\n  }, \"[R.64]\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"Si tout est OK, \", React.createElement(_components.strong, null, \"isAdmin\"), \" fait appel à \", React.createElement(_components.strong, null, \"next()\"), \", qui sera la prochaine fonction middleware qui est présente après l'appel de \", React.createElement(_components.strong, null, \"authorize\"), \".\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"La fonction middleware \", React.createElement(_components.strong, null, \"isAdmin\"), \" récupère les données de l'utilisateur authentifié via l'objet \", React.createElement(_components.code, null, \"req.user\"), \" et le \", React.createElement(_components.strong, null, \"destructuring assignement\"), \".\", React.createElement(_components.br), \"\\n\", \"Si l'utilisateur n'est pas \", React.createElement(_components.strong, null, \"admin\"), \", c'est le code '\", React.createElement(_components.strong, null, \"403 Forbidden\"), \"' qui est renvoyé à l'application cliente, signifiant que l'utilisateur est bien authentifié, mais il n'a pas les privilèges pour accéder à l'opération demandée (création de pizza).\", React.createElement(_components.br), \"\\n\", \"Si tout est OK, \", React.createElement(_components.strong, null, \"isAdmin\"), \" fait appel à \", React.createElement(_components.strong, null, \"next()\"), \", qui sera la prochaine fonction middleware qui est présente après l'appel de \", React.createElement(_components.strong, null, \"isAdmin\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Où allons-nous utiliser ces nouvelles fonctions middleware ?\"), \"\\n\", React.createElement(_components.p, null, \"Nous pouvons le faire au niveau que nous souhaitons, soit au niveau :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"de l'application, pour toutes les routes, via \", React.createElement(_components.code, null, \"app.use(authorize)\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"d'un router, pour toutes les routes associées ; par exemple, on pourrait dire que toutes les routes du router de pizzas sont protégées par une autorisation JWT. On écrirait : \", React.createElement(_components.code, null, \"app.use(\\\"/pizzas\\\", authorize, pizzaRouter);\"), \". Cela signifierait que toutes les opérations sur des ressources de type \\\"pizzas\\\" ne seraient autorisées que si l'utilisateur est authentifié. Cela serait problématique pour deux raisons :\", \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"On veut pouvoir afficher le menu des pizzas pour tous les utilisateurs, même s'ils sont anonymes.\"), \"\\n\", React.createElement(_components.li, null, \"On ne veut pas simplement vérifier qu'un utilisateur est authentifié pour créer une pizza, on veut aussi vérifier qu'il est admin.\"), \"\\n\"), \"\\n\"), \"\\n\", React.createElement(_components.li, null, \"d'une route, pour une opération de notre RESTful API. C'est ce que nous souhaitons faire ici. Veuillez mettre à jour le code du router de \\\"pizzas\\\" au sein de \", React.createElement(_components.strong, null, \"/routes/pizzas.js\"), \" :\"), \"\\n\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"// See existing code\\r\\nconst { authorize, isAdmin } = require('../utils/auths');\\r\\n\\r\\n// See existing code\\r\\n\\r\\n// Create a pizza to be added to the menu.\\r\\nrouter.post('/', authorize, isAdmin, (req, res) => {\\r\\n  const title = req?.body?.title?.length !== 0 ? req.body.title : undefined;\\r\\n  const content = req?.body?.content?.length !== 0 ? req.body.content : undefined;\\r\\n\\r\\n  if (!title || !content) return res.sendStatus(400); // error code '400 Bad request'\\r\\n\\r\\n  const createdPizza = createOnePizza(title, content);\\r\\n\\r\\n  return res.json(createdPizza);\\r\\n});\\n\")), \"\\n\", React.createElement(_components.p, null, \"Ainsi, nous avons juste fait l'appel de deux fonctions middleware pour vérifier :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"que l'utilisateur est authentifié\"), \" via \", React.createElement(_components.strong, null, \"authorize\"), \" ; si tout est OK au niveau du token fournit par l'application cliente, \", React.createElement(_components.strong, null, \"authorize\"), \" fait appel via \", React.createElement(_components.strong, null, \"next()\"), \" à la prochaine fonction middleware. Dans ce cas-ci, c'est \", React.createElement(_components.strong, null, \"isAdmin\"), \". S'il y a un problème, \", React.createElement(_components.strong, null, \"authorize\"), \" termine le traitement de la requête en envoyant un code d'erreur au client et les prochaines fonctions middleware (\", React.createElement(_components.strong, null, \"isAdmin\"), \", puis la fonction arrow) ne sont pas exécutées.\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"que l'utilisateur est admin\"), \" via \", React.createElement(_components.strong, null, \"isAdmin\"), \" ; si tout est OK, que l'utilisateur authentifié est l'admin, \", React.createElement(_components.strong, null, \"isAdmin\"), \" fait appel via \", React.createElement(_components.strong, null, \"next()\"), \" à la prochaine fonction middleware. Dans ce cas-ci, c'est la fonction arrow qui appelle \", React.createElement(_components.code, null, \"createOnePizza\"), \" pour créer la pizza, la fonction traitant l'opération demandée. Si l'utilisateur authentifié n'est pas l'admin, alors \", React.createElement(_components.strong, null, \"isAdmin\"), \" termine le traitement en envoyant un code d'erreur au client et la fonction traitant de l'opération de création n'est pas exécutée.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Comment pouvons-nous tester l'opération de création d'une pizza ? Via REST Client.\\r\\nTentons le coup à l'aide de cette requête (elle est déjà présente dans \", React.createElement(_components.strong, null, \"/REST Client/pizzas.http\"), \") :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-http\"\n  }, \"POST {{baseUrl}}/pizzas\\r\\nContent-Type: application/json\\r\\n\\r\\n{\\r\\n    \\\"title\\\":\\\"Magic Green\\\",\\r\\n    \\\"content\\\":\\\"Epinards, Brocolis, Olives vertes, Basilic\\\"\\r\\n}\\n\")), \"\\n\", React.createElement(_components.p, null, \"Après avoir exécuté cette requête, vous devriez avoir reçu un status code '\", React.createElement(_components.strong, null, \"401 Unauthorized\"), \"'.\\r\\nEt bien oui, nous n'avons pas envoyé de token, nous ne pouvons donc pas être autorisé.\", React.createElement(_components.br), \"\\n\", \"Au prochain point nous allons voir comment utiliser REST Client pour sauvegarder de l'information, comme un token, suite à une requête vers une API.\"), \"\\n\", React.createElement(_components.h2, null, React.createElement(\"a\", {\n    id: \"a4\"\n  }), \"a.4) Client REST\"), \"\\n\", React.createElement(_components.h3, null, \"a.4.1) Client REST avec JWT\"), \"\\n\", React.createElement(_components.p, null, \"Au module 3, nous avons appris à utiliser REST Client, l'extension de VS Code, pour faire des requêtes vers des API.\"), \"\\n\", React.createElement(_components.p, null, \"Voici quelques notions supplémentaire pour utiliser REST Client avec des \", React.createElement(_components.strong, null, \"JWT\"), \" :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Il est possible de créer des \", React.createElement(_components.strong, null, \"Request Variables\"), \" afin de récupérer la réponse associée\\r\\nà une requête au sein d'une variable.\"), \"\\n\", React.createElement(_components.li, null, \"On va donc pouvoir récupérer le token, suite à une requête d'authentification,\\r\\nau sein d'une \", React.createElement(_components.strong, null, \"Request Variable\"), \", pour ensuite fournir ce token dans le\\r\\n« \", React.createElement(_components.strong, null, \"Authorization header\"), \" » de toutes les requêtes demandant une autorisation JWT.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Si vous souhaitez plus d'infos sur les \", React.createElement(_components.strong, null, \"Request Variables\"), \", vous pouvez consulter la \", React.createElement(_components.a, {\n    href: \"https://github.com/Huachao/vscode-restclient#request-variables\"\n  }, \"documentation de REST Client\"), \" \", React.createElement(_components.a, {\n    href: \"/js2/references/#r55\"\n  }, \"[R.55]\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Voici comment mettre à jour le script \", React.createElement(_components.strong, null, \"/REST Client/pizzas.http\"), \" pour créer une pizza en passant le token de l'utilisateur \", React.createElement(_components.strong, null, \"admin\"), \" :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-http\"\n  }, \"### Create a pizza by using the admin account\\r\\n#### First login as the admin\\r\\n##### Define a request variable nammed admin :\\r\\n# @name admin\\r\\nPOST {{baseUrl}}/auths/login\\r\\nContent-Type: application/json\\r\\n\\r\\n{\\r\\n    \\\"username\\\":\\\"admin\\\",\\r\\n    \\\"password\\\":\\\"admin\\\"\\r\\n}\\r\\n\\r\\n#### Create a pizza with the admin token\\r\\nPOST {{baseUrl}}/pizzas\\r\\nContent-Type: application/json\\r\\nAuthorization: {{admin.response.body.token}}\\r\\n\\r\\n{\\r\\n    \\\"title\\\":\\\"Magic Green\\\",\\r\\n    \\\"content\\\":\\\"Epinards, Brocolis, Olives vertes, Basilic\\\"\\r\\n}\\n\")), \"\\n\", React.createElement(_components.p, null, \"Pour tester l'opération de création de pizza, veuillez d'abord exécuter la première requête, puis la seconde donnée ci-dessus.\"), \"\\n\", React.createElement(_components.p, null, \"A ce stade-ci, il serait aussi intéressant de tester certains cas d'erreurs associés aux tokens. Veuillez compléter le script \", React.createElement(_components.strong, null, \"/REST Client/pizzas.http\"), \" avec :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-http\"\n  }, \"### 1. Create a pizza without a token\\r\\nPOST {{baseUrl}}/pizzas\\r\\nContent-Type: application/json\\r\\n\\r\\n{\\r\\n    \\\"title\\\":\\\"Magic Green\\\",\\r\\n    \\\"content\\\":\\\"Epinards, Brocolis, Olives vertes, Basilic\\\"\\r\\n}\\r\\n\\r\\n### 2. Create a pizza without being the admin, use manager account\\r\\n#### 2.1 First login as the manager\\r\\n##### 2.1.1 Define a request variable nammed manager\\r\\n# @name manager\\r\\nPOST {{baseUrl}}/auths/login\\r\\nContent-Type: application/json\\r\\n\\r\\n{\\r\\n    \\\"username\\\":\\\"manager\\\",\\r\\n    \\\"password\\\":\\\"manager\\\"\\r\\n}\\r\\n\\r\\n##### 2.1.2 Define a file variable to simplify the access to the token of manager\\r\\n@managerToken = {{manager.response.body.token}}\\r\\n\\r\\n#### 2.2 Try to create a pizza with the manager token\\r\\nPOST {{baseUrl}}/pizzas\\r\\nContent-Type: application/json\\r\\nAuthorization: {{managerToken}}\\r\\n\\r\\n{\\r\\n    \\\"title\\\":\\\"Magic Green\\\",\\r\\n    \\\"content\\\":\\\"Epinards, Brocolis, Olives vertes, Basilic\\\"\\r\\n}\\n\")), \"\\n\", React.createElement(_components.p, null, \"Nous voyons qu'à l'aide de REST Client, nous pouvons utiliser une \", React.createElement(_components.strong, null, \"File Variable\"), \" pour allouer une partie de la réponse faite à une requête.\", React.createElement(_components.br), \"\\n\", \"Dans ce cas, on peut faire appel à l'API en passant le token via la \", React.createElement(_components.strong, null, \"File Variable\"), \" nommé \", React.createElement(_components.strong, null, \"managerToken\"), \" (\", React.createElement(_components.code, null, \"Authorization: {{managerToken}}\"), \") au lieu d'utiliser une partie seulement de la \", React.createElement(_components.strong, null, \"Request Variable\"), \" nommée \", React.createElement(_components.strong, null, \"manager\"), \" (\", React.createElement(_components.code, null, \"Authorization: {{manager.response.body.token}}\"), \").\", React.createElement(_components.br), \"\\n\", \"Cela permet de créer des requêtes plus concises.\"), \"\\n\", React.createElement(_components.h3, null, \"a.4.2) Finaliser l'API et les requêtes associées\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez mettre à jour votre RESTful API gérant les pizzas afin que toutes les opérations d'écriture soient protégées par une autorisation JWT, n'autorisant que l'utilisateur \", React.createElement(_components.strong, null, \"admin\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Voici le code à mettre à jour dans \", React.createElement(_components.strong, null, \"/routes/pizzas\"), \" pour correctement autoriser les opérations de suppression et de modification sur des ressources de type \\\"pizzas\\\":\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"// Delete a pizza from the menu based on its id\\r\\nrouter.delete('/:id', authorize, isAdmin, (req, res) => {\\r\\n  const deletedPizza = deleteOnePizza(req.params.id);\\r\\n\\r\\n  if (!deletedPizza) return res.sendStatus(404);\\r\\n\\r\\n  return res.json(deletedPizza);\\r\\n});\\r\\n\\r\\n// Update a pizza based on its id and new values for its parameters\\r\\nrouter.patch('/:id', authorize, isAdmin, (req, res) => {\\r\\n  const title = req?.body?.title;\\r\\n  const content = req?.body?.content;\\r\\n\\r\\n  if ((!title && !content) || title?.length === 0 || content?.length === 0) {\\r\\n    return res.sendStatus(400);\\r\\n  }\\r\\n\\r\\n  const updatedPizza = updateOnePizza(req.params.id, { title, content });\\r\\n\\r\\n  if (!updatedPizza) return res.sendStatus(404);\\r\\n\\r\\n  return res.json(updatedPizza);\\r\\n});\\n\")), \"\\n\", React.createElement(_components.p, null, \"Pour vous assurer que les opérations de suppression et de modification sont bien fonctionnelles, veuillez mettre à jour les requêtes associées afin d'utiliser un token. Veuillez mettre à jour \", React.createElement(_components.strong, null, \"/REST Client/pizzas.http\"), \" en ajoutant ces deux lignes :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-http\"\n  }, \"### Create a pizza by using the admin account\\r\\n#### First login as the admin\\r\\n##### Define a request variable nammed admin\\r\\n# @name admin\\r\\nPOST {{baseUrl}}/auths/login\\r\\nContent-Type: application/json\\r\\n\\r\\n{\\r\\n    \\\"username\\\":\\\"admin\\\",\\r\\n    \\\"password\\\":\\\"admin\\\"\\r\\n}\\r\\n\\r\\n#### Create a pizza with the admin token\\r\\nPOST {{baseUrl}}/pizzas\\r\\nContent-Type: application/json\\r\\nAuthorization: {{admin.response.body.token}}\\r\\n\\r\\n{\\r\\n    \\\"title\\\":\\\"Magic Green\\\",\\r\\n    \\\"content\\\":\\\"Epinards, Brocolis, Olives vertes, Basilic\\\"\\r\\n}\\r\\n\\r\\n### Delete pizza identified by 2 with the admin token\\r\\nDELETE {{baseUrl}}/pizzas/2\\r\\nAuthorization: {{admin.response.body.token}}\\r\\n\\r\\n### Update the pizza identified by 6 with the admin token\\r\\nPATCH {{baseUrl}}/pizzas/6\\r\\nContent-Type: application/json\\r\\nAuthorization: {{admin.response.body.token}}\\r\\n\\r\\n{\\r\\n    \\\"title\\\":\\\"Magic Green 2\\\"\\r\\n}\\n\")), \"\\n\", React.createElement(_components.p, null, \"Veuillez exécutez les requêtes de type DELETE et de type PATCH afin de vous assurer que l'API est en ordre.\"), \"\\n\", React.createElement(_components.p, null, \"Si tout fonctionne bien, faites un \", React.createElement(_components.strong, null, \"commit\"), \" de votre repo (\", React.createElement(_components.strong, null, \"web2\"), \") avec le message\\r\\n\\\"\", React.createElement(_components.strong, null, \"auths\"), \"\\\".\"), \"\\n\", React.createElement(_components.p, null, \"En cas de souci, vous pouvez utiliser le code du tutoriel \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/auths\"\n  }, \"auths\"), \".\"), \"\\n\", React.createElement(_components.h1, null, React.createElement(\"a\", {\n    id: \"b\"\n  }), \"b) Authentification & autorisation JWT via une IHM\"), \"\\n\", React.createElement(_components.h2, null, React.createElement(\"a\", {\n    id: \"b1\"\n  }), \"b.1) Authentifier un utilisateur via une IHM & JWT\"), \"\\n\", React.createElement(_components.p, null, \"Pour authentifier un utilisateur via une IHM, il suffit de faire une requête à une RESTful API.\"), \"\\n\", React.createElement(_components.p, null, \"Généralement, l'utilisateur devra d'abord créer son compte. Il utilisera un formulaire demandant au minimum un identifiant (username, adresse e-mail ou autres) et un password.\", React.createElement(_components.br), \"\\n\", \"Dans le cadre d'une SPA, l'IHM fera appel à une opération de type \", React.createElement(_components.strong, null, \"register\"), \" lorsque l'utilisateur soumet le formulaire.\"), \"\\n\", React.createElement(_components.p, null, \"Par la suite, lorsque le compte de l'utilisateur existe, l'IHM fera appel à une opération de type \", React.createElement(_components.strong, null, \"login\"), \" lorsque l'utilisateur tentera de se connecter à l'aide d'un formulaire.\"), \"\\n\", React.createElement(_components.p, null, \"Dans les deux cas, \", React.createElement(_components.strong, null, \"register\"), \" ou \", React.createElement(_components.strong, null, \"login\"), \", le développeur devra connaître les opérations mises à disposition par l'API.\"), \"\\n\", React.createElement(_components.p, null, \"Dans le cadre du site de la pizzeria, nous savons que l'API met à disposition ces deux opérations :\"), \"\\n\", React.createElement(_components.p, null, \"| URI | Méthode HTTP | Opération |\\r\\n|---|---|---|---|\\r\\n| \", React.createElement(_components.strong, null, \"auths/login\"), \" | POST | Vérifier les credentials d'une ressource de type \\\"users\\\" et renvoyer le username et un token JWT si les credentials sont OK |\\r\\n| \", React.createElement(_components.strong, null, \"auths/register\"), \" | POST | Créer une ressource de type \\\"users\\\" et renvoyer le username et un token JWT |\"), \"\\n\", React.createElement(\"br\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez démarrer la dernière version de la RESTful API de la pizzeria. En cas de souci, vous pouvez utiliser ce code-ci :\\r\\n\", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/auths\"\n  }, \"auths\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Nous allons maintenant continuer le développement de l'IHM \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/frontend/frontend-essentials/async-await\"\n  }, \"async-await\"), \" pour que le formulaire de register et de login fassent appelle à l'API et sauve temporairement le token renvoyé.\"), \"\\n\", React.createElement(_components.p, null, \"Au sein de votre repo \", React.createElement(_components.strong, null, \"web2\"), \", veuillez créer le projet nommé \", React.createElement(_components.strong, null, \"/web2/tutorials/pizzeria/hmi/jwt-fetch\"), \" sur base d'un copié collé de \", React.createElement(_components.strong, null, \"/web2/tutorials/pizzeria/hmi/async-await\"), \" (ou \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/frontend/frontend-essentials/basic-fetch\"\n  }, \"async-await\"), \").\"), \"\\n\", React.createElement(_components.p, null, \"Pour la suite du tutoriel, nous considérons que tous les chemins absolus démarrent du répertoire\\r\\n\", React.createElement(_components.strong, null, \"/web2/tutorials/pizzeria/hmi/jwt-fetch\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez mettre à jour le code de la \", React.createElement(_components.strong, null, \"RegisterPage\"), \" afin de faire appel à la méthode \", React.createElement(_components.strong, null, \"POST /auths/register\"), \" et, si tout est OK, renvoyer l'utilisateur vers la \", React.createElement(_components.strong, null, \"HomePage\"), \" via la fonction \", React.createElement(_components.strong, null, \"Navigate\"), \" :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"import { clearPage, renderPageTitle } from '../../utils/render';\\r\\nimport Navigate from '../Router/Navigate';\\r\\n\\r\\nconst RegisterPage = () => {\\r\\n  clearPage();\\r\\n  renderPageTitle('Register');\\r\\n  renderRegisterForm();\\r\\n};\\r\\n\\r\\nfunction renderRegisterForm() {\\r\\n  const main = document.querySelector('main');\\r\\n  const form = document.createElement('form');\\r\\n  form.className = 'p-5';\\r\\n  const username = document.createElement('input');\\r\\n  username.type = 'text';\\r\\n  username.id = 'username';\\r\\n  username.placeholder = 'username';\\r\\n  username.required = true;\\r\\n  username.className = 'form-control mb-3';\\r\\n  const password = document.createElement('input');\\r\\n  password.type = 'password';\\r\\n  password.id = 'password';\\r\\n  password.required = true;\\r\\n  password.placeholder = 'password';\\r\\n  password.className = 'form-control mb-3';\\r\\n  const submit = document.createElement('input');\\r\\n  submit.value = 'Register';\\r\\n  submit.type = 'submit';\\r\\n  submit.className = 'btn btn-danger';\\r\\n  form.appendChild(username);\\r\\n  form.appendChild(password);\\r\\n  form.appendChild(submit);\\r\\n  main.appendChild(form);\\r\\n  form.addEventListener('submit', onRegister);\\r\\n}\\r\\n\\r\\nasync function onRegister(e) {\\r\\n  e.preventDefault();\\r\\n\\r\\n  const username = document.querySelector('#username').value;\\r\\n  const password = document.querySelector('#password').value;\\r\\n\\r\\n  const options = {\\r\\n    method: 'POST',\\r\\n    body: JSON.stringify({\\r\\n      username,\\r\\n      password,\\r\\n    }),\\r\\n    headers: {\\r\\n      'Content-Type': 'application/json',\\r\\n    },\\r\\n  };\\r\\n\\r\\n  const response = await fetch('/api/auths/register', options);\\r\\n\\r\\n  if (!response.ok) throw new Error(`fetch error : ${response.status} : ${response.statusText}`);\\r\\n\\r\\n  const authenticatedUser = await response.json();\\r\\n\\r\\n  console.log('Newly registered & authenticated user : ', authenticatedUser);\\r\\n\\r\\n  Navigate('/');\\r\\n}\\r\\n\\r\\nexport default RegisterPage;\\r\\n\\n\")), \"\\n\", React.createElement(_components.p, null, \"Veuillez exécuter le frontend et vous assurer que l'utilisateur que vous tentez de créer est bien créé par votre API. Si tout fonctionne, vous aurez une confirmation dans la console de votre browser.\"), \"\\n\", React.createElement(_components.p, null, \"Bien, nous souhaitons pour l'instant sauvegarder \", React.createElement(_components.strong, null, \"authenticatedUser\"), \" de manière temporaire, car cet objet contient comme info le username et le token de l'utilisateur.\"), \"\\n\", React.createElement(_components.p, null, \"💭 Comment faire pour que cet objet soit disponible dans d'autres modules ?\\r\\nCette question nous permet d'explorer un propriété importante des \", React.createElement(_components.strong, null, \"export\"), \" d'objets via ECMAScript : ce sont des objets immuables, c'est-à-dire dont vous ne pouvez pas directement changer leurs valeurs. Comment faire alors pour offrir \", React.createElement(_components.strong, null, \"authenticatedUser\"), \" ?\", React.createElement(_components.br), \"\\n\", \"Nous allons offrir quatre nouvelles fonctions :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"une fonction qui renverra l'état d'une variable \", React.createElement(_components.strong, null, \"authenticatedUser\"), \" ;\"), \"\\n\", React.createElement(_components.li, null, \"une fonction qui permettra de modifier la variable \", React.createElement(_components.strong, null, \"authenticatedUser\"), \" ;\"), \"\\n\", React.createElement(_components.li, null, \"une fonction qui indiquera si l'utilisateur est authentifié ou pas ;\"), \"\\n\", React.createElement(_components.li, null, \"une fonction qui permettra de faire un reset de l'utilisateur en cours (on utilisera cette fonction lors d'un logout).\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez créer le fichier \", React.createElement(_components.strong, null, \"/src/utils/auths.js\"), \" et y ajouter le code suivant :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"let currentUser;\\r\\n\\r\\nconst getAuthenticatedUser = () => currentUser;\\r\\n\\r\\nconst setAuthenticatedUser = (authenticatedUser) => {\\r\\n  currentUser = authenticatedUser;\\r\\n};\\r\\n\\r\\nconst isAuthenticated = () => currentUser !== undefined;\\r\\n\\r\\nconst clearAuthenticatedUser = () => {\\r\\n  currentUser = undefined;\\r\\n};\\r\\n\\r\\n// eslint-disable-next-line object-curly-newline\\r\\nexport { getAuthenticatedUser, setAuthenticatedUser, isAuthenticated, clearAuthenticatedUser };\\n\")), \"\\n\", React.createElement(_components.p, null, \"Veuillez mettre à jour le code de la \", React.createElement(_components.strong, null, \"RegisterPage\"), \" afin de sauver en mémoire vive l'utilisateur authentifié. Nous allons aussi préparer la suite afin d'avoir une Navbar qui s'adaptera lorsqu'un utilisateur est authentifié, c'est pourquoi nous allons appeler le composant \", React.createElement(_components.strong, null, \"Navbar\"), \" :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"import { setAuthenticatedUser } from '../../utils/auths';\\r\\nimport { clearPage, renderPageTitle } from '../../utils/render';\\r\\nimport Navbar from '../Navbar/Navbar';\\r\\nimport Navigate from '../Router/Navigate';\\r\\n\\r\\nconst RegisterPage = () => {\\r\\n  clearPage();\\r\\n  renderPageTitle('Register');\\r\\n  renderRegisterForm();\\r\\n};\\r\\n\\r\\nfunction renderRegisterForm() {\\r\\n  const main = document.querySelector('main');\\r\\n  const form = document.createElement('form');\\r\\n  form.className = 'p-5';\\r\\n  const username = document.createElement('input');\\r\\n  username.type = 'text';\\r\\n  username.id = 'username';\\r\\n  username.placeholder = 'username';\\r\\n  username.required = true;\\r\\n  username.className = 'form-control mb-3';\\r\\n  const password = document.createElement('input');\\r\\n  password.type = 'password';\\r\\n  password.id = 'password';\\r\\n  password.required = true;\\r\\n  password.placeholder = 'password';\\r\\n  password.className = 'form-control mb-3';\\r\\n  const submit = document.createElement('input');\\r\\n  submit.value = 'Register';\\r\\n  submit.type = 'submit';\\r\\n  submit.className = 'btn btn-danger';\\r\\n  form.appendChild(username);\\r\\n  form.appendChild(password);\\r\\n  form.appendChild(submit);\\r\\n  main.appendChild(form);\\r\\n  form.addEventListener('submit', onRegister);\\r\\n}\\r\\n\\r\\nasync function onRegister(e) {\\r\\n  e.preventDefault();\\r\\n\\r\\n  const username = document.querySelector('#username').value;\\r\\n  const password = document.querySelector('#password').value;\\r\\n\\r\\n  const options = {\\r\\n    method: 'POST',\\r\\n    body: JSON.stringify({\\r\\n      username,\\r\\n      password,\\r\\n    }),\\r\\n    headers: {\\r\\n      'Content-Type': 'application/json',\\r\\n    },\\r\\n  };\\r\\n\\r\\n  const response = await fetch('/api/auths/register', options);\\r\\n\\r\\n  if (!response.ok) throw new Error(`fetch error : ${response.status} : ${response.statusText}`);\\r\\n\\r\\n  const authenticatedUser = await response.json();\\r\\n\\r\\n  console.log('Newly registered & authenticated user : ', authenticatedUser);\\r\\n\\r\\n  setAuthenticatedUser(authenticatedUser);\\r\\n\\r\\n  Navbar();\\r\\n\\r\\n  Navigate('/');\\r\\n}\\r\\n\\r\\nexport default RegisterPage;\\n\")), \"\\n\", React.createElement(_components.p, null, \"Pour la \", React.createElement(_components.strong, null, \"LoginPage\"), \", les modifications à faire sont les mêmes :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"import { setAuthenticatedUser } from '../../utils/auths';\\r\\nimport { clearPage, renderPageTitle } from '../../utils/render';\\r\\nimport Navbar from '../Navbar/Navbar';\\r\\nimport Navigate from '../Router/Navigate';\\r\\n\\r\\nconst LoginPage = () => {\\r\\n  clearPage();\\r\\n  renderPageTitle('Login');\\r\\n  renderRegisterForm();\\r\\n};\\r\\n\\r\\nfunction renderRegisterForm() {\\r\\n  const main = document.querySelector('main');\\r\\n  const form = document.createElement('form');\\r\\n  form.className = 'p-5';\\r\\n  const username = document.createElement('input');\\r\\n  username.type = 'text';\\r\\n  username.id = 'username';\\r\\n  username.placeholder = 'username';\\r\\n  username.required = true;\\r\\n  username.className = 'form-control mb-3';\\r\\n  const password = document.createElement('input');\\r\\n  password.type = 'password';\\r\\n  password.id = 'password';\\r\\n  password.required = true;\\r\\n  password.placeholder = 'password';\\r\\n  password.className = 'form-control mb-3';\\r\\n  const submit = document.createElement('input');\\r\\n  submit.value = 'Login';\\r\\n  submit.type = 'submit';\\r\\n  submit.className = 'btn btn-danger';\\r\\n  form.appendChild(username);\\r\\n  form.appendChild(password);\\r\\n  form.appendChild(submit);\\r\\n  main.appendChild(form);\\r\\n  form.addEventListener('submit', onLogin);\\r\\n}\\r\\n\\r\\nasync function onLogin(e) {\\r\\n  e.preventDefault();\\r\\n\\r\\n  const username = document.querySelector('#username').value;\\r\\n  const password = document.querySelector('#password').value;\\r\\n\\r\\n  const options = {\\r\\n    method: 'POST',\\r\\n    body: JSON.stringify({\\r\\n      username,\\r\\n      password,\\r\\n    }),\\r\\n    headers: {\\r\\n      'Content-Type': 'application/json',\\r\\n    },\\r\\n  };\\r\\n\\r\\n  const response = await fetch('/api/auths/login', options);\\r\\n\\r\\n  if (!response.ok) throw new Error(`fetch error : ${response.status} : ${response.statusText}`);\\r\\n\\r\\n  const authenticatedUser = await response.json();\\r\\n\\r\\n  console.log('Authenticated user : ', authenticatedUser);\\r\\n\\r\\n  setAuthenticatedUser(authenticatedUser);\\r\\n\\r\\n  Navbar();\\r\\n\\r\\n  Navigate('/');\\r\\n}\\r\\n\\r\\nexport default LoginPage;\\n\")), \"\\n\", React.createElement(_components.p, null, \"Nous souhaitons maintenant faire en sorte que la Navbar affiche des éléments différents si l'utilisateur est authentifié au pas :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"s'il est authentifié : on affiche \", React.createElement(_components.strong, null, \"Home\"), \", \", React.createElement(_components.strong, null, \"Login\"), \", \", React.createElement(_components.strong, null, \"Register\"), \" et le \", React.createElement(_components.strong, null, \"username\"), \" de l'utilisateur connecté.\"), \"\\n\", React.createElement(_components.li, null, \"s'il est anonyme : on affiche \", React.createElement(_components.strong, null, \"Home\"), \", \", React.createElement(_components.strong, null, \"Add a pizza\"), \", \", React.createElement(_components.strong, null, \"Logout\"), \".\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Nous allons mettre à jour la \", React.createElement(_components.strong, null, \"Navbar\"), \" pour s'adapter à l'authentification d'un utilisateur :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"// eslint-disable-next-line no-unused-vars\\r\\nimport { Navbar as BootstrapNavbar } from 'bootstrap';\\r\\nimport { getAuthenticatedUser, isAuthenticated } from '../../utils/auths';\\r\\n\\r\\nconst Navbar = () => {\\r\\n  renderNavbar();\\r\\n};\\r\\n\\r\\nfunction renderNavbar() {\\r\\n  const authenticatedUser = getAuthenticatedUser();\\r\\n\\r\\n  const anonymousUserNavbar = `\\r\\n<nav class=\\\"navbar navbar-expand-lg navbar-light bg-danger\\\">\\r\\n      <div class=\\\"container-fluid\\\">\\r\\n        <a class=\\\"navbar-brand\\\" href=\\\"#\\\">e-Pizzeria</a>\\r\\n        <button\\r\\n          class=\\\"navbar-toggler\\\"\\r\\n          type=\\\"button\\\"\\r\\n          data-bs-toggle=\\\"collapse\\\"\\r\\n          data-bs-target=\\\"#navbarSupportedContent\\\"\\r\\n          aria-controls=\\\"navbarSupportedContent\\\"\\r\\n          aria-expanded=\\\"false\\\"\\r\\n          aria-label=\\\"Toggle navigation\\\"\\r\\n        >\\r\\n          <span class=\\\"navbar-toggler-icon\\\"></span>\\r\\n        </button>\\r\\n        <div class=\\\"collapse navbar-collapse\\\" id=\\\"navbarSupportedContent\\\">\\r\\n          <ul class=\\\"navbar-nav me-auto mb-2 mb-lg-0\\\">\\r\\n            <li class=\\\"nav-item\\\">\\r\\n              <a class=\\\"nav-link active\\\" aria-current=\\\"page\\\" href=\\\"#\\\" data-uri=\\\"/\\\">Home</a>\\r\\n            </li>\\r\\n            <li id=\\\"loginItem\\\" class=\\\"nav-item\\\">\\r\\n              <a class=\\\"nav-link\\\" href=\\\"#\\\" data-uri=\\\"/login\\\">Login</a>\\r\\n            </li>\\r\\n            <li id=\\\"registerItem\\\" class=\\\"nav-item\\\">\\r\\n              <a class=\\\"nav-link\\\" href=\\\"#\\\" data-uri=\\\"/register\\\">Register</a>\\r\\n            </li>            \\r\\n          </ul>\\r\\n        </div>\\r\\n      </div>\\r\\n    </nav>\\r\\n`;\\r\\n\\r\\n  const authenticatedUserNavbar = `\\r\\n<nav class=\\\"navbar navbar-expand-lg navbar-light bg-danger\\\">\\r\\n      <div class=\\\"container-fluid\\\">\\r\\n        <a class=\\\"navbar-brand\\\" href=\\\"#\\\">e-Pizzeria</a>\\r\\n        <button\\r\\n          class=\\\"navbar-toggler\\\"\\r\\n          type=\\\"button\\\"\\r\\n          data-bs-toggle=\\\"collapse\\\"\\r\\n          data-bs-target=\\\"#navbarSupportedContent\\\"\\r\\n          aria-controls=\\\"navbarSupportedContent\\\"\\r\\n          aria-expanded=\\\"false\\\"\\r\\n          aria-label=\\\"Toggle navigation\\\"\\r\\n        >\\r\\n          <span class=\\\"navbar-toggler-icon\\\"></span>\\r\\n        </button>\\r\\n        <div class=\\\"collapse navbar-collapse\\\" id=\\\"navbarSupportedContent\\\">\\r\\n          <ul class=\\\"navbar-nav me-auto mb-2 mb-lg-0\\\">\\r\\n            <li class=\\\"nav-item\\\">\\r\\n              <a class=\\\"nav-link active\\\" aria-current=\\\"page\\\" href=\\\"#\\\" data-uri=\\\"/\\\">Home</a>\\r\\n            </li>          \\r\\n            <li class=\\\"nav-item\\\">\\r\\n              <a class=\\\"nav-link\\\" href=\\\"#\\\" data-uri=\\\"/add-pizza\\\">Add a pizza</a>\\r\\n            </li>\\r\\n            <li class=\\\"nav-item\\\">\\r\\n              <a class=\\\"nav-link\\\" href=\\\"#\\\" data-uri=\\\"/logout\\\">Logout</a>\\r\\n            </li>    \\r\\n            <li class=\\\"nav-item\\\">\\r\\n              <a class=\\\"nav-link disabled\\\" href=\\\"#\\\">${authenticatedUser?.username}</a>\\r\\n            </li>           \\r\\n          </ul>\\r\\n        </div>\\r\\n      </div>\\r\\n    </nav>\\r\\n`;\\r\\n\\r\\n  const navbar = document.querySelector('#navbarWrapper');\\r\\n\\r\\n  navbar.innerHTML = isAuthenticated() ? authenticatedUserNavbar : anonymousUserNavbar;\\r\\n}\\r\\n\\r\\nexport default Navbar;\\n\")), \"\\n\", React.createElement(_components.p, null, \"Ce code est quasi entièrement neuf. On a rajouté l'élément qui permettra de réaliser le logout d'un utilisateur. Avant d'aller plus loin, veuillez tester l'application.\", React.createElement(_components.br), \"\\n\", \"Loguez-vous avec l'utilisateur \", React.createElement(_components.strong, null, \"admin\"), \" (et le password \", React.createElement(_components.strong, null, \"admin\"), \") et vérifier que vous êtes bien redirigé vers la HomePage une fois authentifié, que la Navbar contient bien les éléments attendus, dont le \", React.createElement(_components.strong, null, \"username\"), \".\", React.createElement(_components.br), \"\\n\", \"Veuillez maintenant tester un clic sur l'élément \", React.createElement(_components.strong, null, \"Add a pizza\"), \" de la Navbar. Il ne se passe rien...\", React.createElement(_components.br), \"\\n\", \"💭 Pourquoi les clics ne sont plus pris en compte ?\", React.createElement(_components.br), \"\\n\", \"En fait, regardons le code de notre \", React.createElement(_components.strong, null, \"Router\"), \", pour la gestion des clics sur la \", React.createElement(_components.strong, null, \"Navbar\"), \" :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"function onNavBarClick() {\\r\\n  const navItems = document.querySelectorAll('.nav-link');\\r\\n\\r\\n  navItems.forEach((item) => {\\r\\n    item.addEventListener('click', (e) => {\\r\\n      e.preventDefault();\\r\\n      const uri = e.target?.dataset?.uri;\\r\\n      const componentToRender = routes[uri];\\r\\n      if (!componentToRender) throw Error(`The ${uri} ressource does not exist.`);\\r\\n\\r\\n      componentToRender();\\r\\n      window.history.pushState({}, '', uri);\\r\\n    });\\r\\n  });\\r\\n}\\n\")), \"\\n\", React.createElement(_components.p, null, \"En fait, tant dans \", React.createElement(_components.strong, null, \"LoginPage\"), \" que dans \", React.createElement(_components.strong, null, \"RegisterPage\"), \", nous faisons appel à la fonction \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"Navbar\")), \" qui fait un \\\"rerender\\\" (réaffichage) de la Navbar. Ainsi, tous les éléments de la barre de navigation sont \\\"rerender\\\", et donc comme le \", React.createElement(_components.strong, null, \"Router\"), \" n'est pas réappelé, la fonction \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"onNavBarClick\")), \" n'est pas réexécutée. Ainsi, même si les nouveaux éléments de la Navbar ont la classe CSS \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"nav-link\")), \", leurs écouteurs d'événements de type click n'existent pas.\"), \"\\n\", React.createElement(_components.p, null, \"💭 Comment corriger cela ?\\r\\nOn pourrait se dire qu'il suffit de faire appel à la fonction \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"onNavBarClick\")), \" dans la \", React.createElement(_components.strong, null, \"Navbar\"), \". Cette solution ne fonctionnerait pas car nous aurions des dépendances cycliques, la Navbar devrait faire appel aux routes, qui elles font appel aux pages, les pages faisant appel à la Navbar...\", React.createElement(_components.br), \"\\n\", \"Dès lors, le mieux serait de mettre un écouteur d'événements au niveau du wrapper de la Navbar.\", React.createElement(_components.br), \"\\n\", \"Comme le wrapper n'est jamais réinitialisé, tout sera en ordre.\", React.createElement(_components.br), \"\\n\", \"Veuillez donc mettre à jour la fonction \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"onNavBarClick\")), \" de \", React.createElement(_components.strong, null, \"/src/Components/Router/Router.js\"), \" :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"function onNavBarClick() {\\r\\n  const navbarWrapper = document.querySelector('#navbarWrapper');\\r\\n\\r\\n  navbarWrapper.addEventListener('click', (e) => {\\r\\n    e.preventDefault();\\r\\n    const navBarItemClicked = e.target;\\r\\n    const uri = navBarItemClicked?.dataset?.uri;\\r\\n    if (uri) {\\r\\n      const componentToRender = routes[uri];\\r\\n      if (!componentToRender) throw Error(`The ${uri} ressource does not exist.`);\\r\\n\\r\\n      componentToRender();\\r\\n      window.history.pushState({}, '', uri);\\r\\n    }\\r\\n  });\\r\\n}\\n\")), \"\\n\", React.createElement(_components.p, null, \"Veuillez noter que le \", React.createElement(_components.strong, null, \"navbarWrapper\"), \" est initialisé au sein du composant \", React.createElement(_components.strong, null, \"Header\"), \".\", React.createElement(_components.br), \"\\n\", \"Dans la nouvelle version du code du \", React.createElement(_components.strong, null, \"Router\"), \", le gestionnaire de clic est ajouté au niveau de ce wrapper. Grâce à l'event objet \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"e\")), \", on accède à l'élément sur lequel on a cliqué grâce à la propriété \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"target\")), \". On retrouve donc l'élément de la navbar sur lequel on a cliqué très facilement.\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez tester votre IHM et vérifier qu'une fois logué, vous puissiez bien voyager entre les pages.\"), \"\\n\", React.createElement(_components.p, null, \"Il reste maintenant à créer un composant permettant de faire un logout. On souhaite que ce composant de logout supprime l'utilisateur authentifié, réaffiche la Navbar pour un utilisateur anonyme et redirige l'utilisateur vers la page de login.\"), \"\\n\", React.createElement(_components.p, null, \"Pour ce faire, veuillez créer le dossier et le fichier \", React.createElement(_components.strong, null, \"/src/Components/Logout/Logout.js\"), \" et y ajouter ce code :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"import { clearAuthenticatedUser } from '../../utils/auths';\\r\\nimport Navbar from '../Navbar/Navbar';\\r\\nimport Navigate from '../Router/Navigate';\\r\\n\\r\\nconst Logout = () => {\\r\\n  clearAuthenticatedUser();\\r\\n  Navbar();\\r\\n  Navigate('/login');\\r\\n};\\r\\n\\r\\nexport default Logout;\\n\")), \"\\n\", React.createElement(_components.p, null, \"Attention, même si nous avons mis à jour la \", React.createElement(_components.strong, null, \"Navbar\"), \" et créé le composant \", React.createElement(_components.strong, null, \"Logout\"), \", le boilerplate du frontend impose de rajouter une route au sein du \", React.createElement(_components.strong, null, \"Router\"), \" pour qu'un clic sur l'élément \", React.createElement(_components.strong, null, \"Logout\"), \" de la \", React.createElement(_components.strong, null, \"Navbar\"), \" amène à appeler le composant \", React.createElement(_components.strong, null, \"Logout\"), \".\\r\\nVeuillez donc mettre à jour \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"routes\")), \" au sein de \", React.createElement(_components.strong, null, \"/src/Components/Router/Router.js\"), \" :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"import Logout from '../Logout/Logout';\\r\\nimport AddPizzaPage from '../Pages/AddPizzaPage';\\r\\nimport HomePage from '../Pages/HomePage';\\r\\nimport LoginPage from '../Pages/LoginPage';\\r\\nimport RegisterPage from '../Pages/RegisterPage';\\r\\n\\r\\nconst routes = {\\r\\n  '/': HomePage,\\r\\n  '/login': LoginPage,\\r\\n  '/register': RegisterPage,\\r\\n  '/add-pizza': AddPizzaPage,\\r\\n  '/logout': Logout,\\r\\n};\\n\")), \"\\n\", React.createElement(_components.p, null, \"Veuillez maintenant tester le login et le logout. Tout devrait être fonctionnel !\", React.createElement(_components.br), \"\\n\", \"Il nous reste à faire en sorte que l'on puisse autoriser l'opération de création de pizza.\"), \"\\n\", React.createElement(_components.h2, null, React.createElement(\"a\", {\n    id: \"b2\"\n  }), \"b.2) Autoriser l'appel à une opération protégée\"), \"\\n\", React.createElement(_components.p, null, \"Nous allons maintenant voir comment, à partir d'une IHM, nous pouvons utiliser un token pour accéder à une opération d'une RESTful API.\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez vous assurer que la dernière version de la RESTful API de la pizzeria est bien démarrée. En cas de souci, vous pouvez utiliser ce code-ci :\\r\\n\", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/auths\"\n  }, \"auths\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez vous connecter à l'IHM \", React.createElement(_components.strong, null, \"jwt-fetch\"), \" à l'aide du compte \", React.createElement(_components.strong, null, \"manager\"), \" et tentez d'ajouter une pizza. Cela ne devrait pas fonctionner. Veuillez regarder dans la console : il devrait y avoir une erreur qui s'affiche avec le \\\"status code\\\" \", React.createElement(_components.strong, null, \"401 : Unauthorized\"), \".\", React.createElement(_components.br), \"\\n\", \"En effet, l'API attend un token pour autoriser l'opération de création d'une pizza.\"), \"\\n\", React.createElement(_components.p, null, \"Nous allons donc mettre à jour \", React.createElement(_components.strong, null, \"/src/Components/Pages/AddPizzaPage.js\"), \" pour ajouter le token de l'utilisateur authentifié au sein du header de la requête (il n'y a que trois lignes à rajouter) :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"import { getAuthenticatedUser } from '../../utils/auths';\\r\\nimport { clearPage, renderPageTitle } from '../../utils/render';\\r\\nimport Navigate from '../Router/Navigate';\\r\\n\\r\\nconst AddPizzaPage = () => {\\r\\n  clearPage();\\r\\n  renderPageTitle('Add a pizza to the menu');\\r\\n  renderAddPizzaForm();\\r\\n};\\r\\n\\r\\nfunction renderAddPizzaForm() {\\r\\n  const main = document.querySelector('main');\\r\\n  const form = document.createElement('form');\\r\\n  form.className = 'p-5';\\r\\n  const title = document.createElement('input');\\r\\n  title.type = 'text';\\r\\n  title.id = 'title';\\r\\n  title.placeholder = 'title of your pizza';\\r\\n  title.required = true;\\r\\n  title.className = 'form-control mb-3';\\r\\n  const content = document.createElement('input');\\r\\n  content.type = 'text';\\r\\n  content.id = 'content';\\r\\n  content.required = true;\\r\\n  content.placeholder = 'Content of your pizza';\\r\\n  content.className = 'form-control mb-3';\\r\\n  const submit = document.createElement('input');\\r\\n  submit.value = 'Add pizza to the menu';\\r\\n  submit.type = 'submit';\\r\\n  submit.className = 'btn btn-danger';\\r\\n  form.appendChild(title);\\r\\n  form.appendChild(content);\\r\\n  form.appendChild(submit);\\r\\n  main.appendChild(form);\\r\\n  form.addEventListener('submit', onAddPizza);\\r\\n}\\r\\n\\r\\nasync function onAddPizza(e) {\\r\\n  e.preventDefault();\\r\\n\\r\\n  const title = document.querySelector('#title').value;\\r\\n  const content = document.querySelector('#content').value;\\r\\n\\r\\n  const authenticatedUser = getAuthenticatedUser();\\r\\n\\r\\n  const options = {\\r\\n    method: 'POST',\\r\\n    body: JSON.stringify({\\r\\n      title,\\r\\n      content,\\r\\n    }),\\r\\n    headers: {\\r\\n      'Content-Type': 'application/json',\\r\\n      Authorization: authenticatedUser.token,\\r\\n    },\\r\\n  };\\r\\n\\r\\n  const response = await fetch('/api/pizzas', options);\\r\\n\\r\\n  if (!response.ok) throw new Error(`fetch error : ${response.status} : ${response.statusText}`);\\r\\n\\r\\n  const newPizza = await response.json();\\r\\n\\r\\n  console.log('New pizza added : ', newPizza);\\r\\n\\r\\n  Navigate('/');\\r\\n}\\r\\n\\r\\nexport default AddPizzaPage;\\r\\n\\n\")), \"\\n\", React.createElement(_components.p, null, \"Veuillez vous connecter à l'IHM à l'aide du compte \", React.createElement(_components.strong, null, \"manager\"), \" et tentez d'ajouter une pizza. Cela ne devrait toujours pas fonctionner. Veuillez regarder dans la console : il devrait y avoir une erreur qui s'affiche avec le \\\"status code\\\" \", React.createElement(_components.strong, null, \"403 : Forbidden\"), \".\", React.createElement(_components.br), \"\\n\", \"En effet, l'API attend un token pour autoriser l'opération de création d'une pizza, mais seulement \", React.createElement(_components.strong, null, \"admin\"), \" a le privilège d'ajouter une pizza au menu !\"), \"\\n\", React.createElement(_components.p, null, \"Déconnectez-vous (logout), reconnectez-vous à l'aide du compte \", React.createElement(_components.strong, null, \"admin\"), \", et ajoutez une pizza.\\r\\nVoila ! Le site devrait être entièrement fonctionnel !\"), \"\\n\", React.createElement(_components.p, null, \"Si tout fonctionne bien, faites un \", React.createElement(_components.strong, null, \"commit\"), \" de votre repo (\", React.createElement(_components.strong, null, \"web2\"), \") avec le message\\r\\n\\\"\", React.createElement(_components.strong, null, \"jwt-fetch\"), \"\\\".\"), \"\\n\", React.createElement(_components.p, null, \"En cas de souci, vous pouvez utiliser le code du tutoriel :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"pour le frontend : \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/frontend/frontend-essentials/jwt-fetch\"\n  }, \"jwt-fetch\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"pour l'API : \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/auths\"\n  }, \"auths\"), \".\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"💭 Est-ce que c'est \\\"safe\\\" que notre IHM affiche le menu \\\"Add a pizza\\\" pour un utilisateur qui n'est pas l'admin ?\", React.createElement(_components.br), \"\\n\", \"En fait oui, c'est \\\"safe\\\", vous l'avez testé. L'API ne doit jamais faire confiance aux applications clientes pour appliquer la sécurité. Ainsi, même si le frontend autorise l'accès à des opérations qui ne devraient pas être permises, au regard des autorisations appliquées par l'API, ça n'a pas d'importance point de vue sécurité.\", React.createElement(_components.br), \"\\n\", \"De la même façon, c'est pour ça qu'une API doit aussi toujours valider les paramètres qu'elle reçoit. Elle ne peut pas faire confiance aux applications clientes, comme par exemple à une application web tournant dans un browser, pour valider tous les champs d'un formulaire avant de faire la requête.\", React.createElement(_components.br), \"\\n\", \"La raison est simple, l'API est développée indépendamment des applications clientes, elle ne peut pas supposer que les requêtes seront toujours bien construites.\"), \"\\n\", React.createElement(_components.p, null, \"💭 OK, tout est \\\"safe\\\" si l'API fait toutes les vérifications nécessaires. Néanmoins, n'y a-t-il pas des règles de bonnes pratiques au niveau des IHM, pour ne pas permettre de faire n'importe quelles requêtes vers des API ?\", React.createElement(_components.br), \"\\n\", \"Et bien oui, au niveau des IHM, pour des questions d'\", React.createElement(_components.strong, null, \"ergonomie\"), \", d'expérience utilisateur, on va faire en sorte :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"de ne pas offrir des opérations qui ne seront pas autorisées. Par exemple, dans le cadre de ce tutoriel sur un site permettant de gérer une pizzeria, si l'utilisateur n'est pas \", React.createElement(_components.strong, null, \"admin\"), \", alors il ne faut pas frustrer les utilisateurs en leur faisant croire qu'ils ont accès à l'opération de créer une pizza ! Imaginez-vous, vous créer une nouvelle pizza de 32 ingrédients, et lors de la soumission, vous recevez un message comme quoi vous n'êtes pas l'admin du site et que vous n'avez donc pas le droit de créer une pizza 😲!\"), \"\\n\", React.createElement(_components.li, null, \"de ne pas demander du travail à une API quand l'IHM peut détecter que ce n'est pas utile.\\r\\nAinsi, quand une IHM offre des formulaires, qui amèneront à des requêtes vers des API, on évitera d'autoriser la soumission des données tant que les champs n'ont pas été validés. Tout ce que l'IHM peut valider côté client, elle doit le faire. Le feedback sera plus rapide pour l'utilisateur, et les ressources de l'API seront économisées (pas d'appel inutile).\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"N'hésitez donc pas à mettre à jour ce tutoriel pour faire en sorte de n'afficher \\\"Add a pizza\\\" que si l'utilisateur est \", React.createElement(_components.strong, null, \"admin\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"💭 Ca n'est pas un peu \\\"cheap\\\" que seul l'utilisateur \", React.createElement(_components.strong, null, \"admin\"), \" puisse avoir le privilège d'administrateur du site ?\", React.createElement(_components.br), \"\\n\", \"Hé bien oui, c'est \\\"cheap\\\". Généralement, dans le cadre d'applications plus robustes, nous allons ajouter un ou plusieurs rôles aux utilisateurs. Par exemple, dans le cadre d'applications où les rôles sont simples, qu'il n'y a jamais qu'un seul rôle associé à un utilisateur, il suffirait d'ajouter au niveau de l'API la propriété \", React.createElement(_components.strong, null, \"role\"), \" aux utilisateurs. Par exemple, la majorité des utilisateurs pourrait avoir un rôle dont la valeur serait \", React.createElement(_components.strong, null, \"default\"), \", et une minorité d'utilisateur auraient le rôle d'\", React.createElement(_components.strong, null, \"admin\"), \"...\"), \"\\n\", React.createElement(_components.p, null, \"On n'affiche actuellement \", React.createElement(_components.strong, null, \"pas de message d'erreur\"), \" à l'utilisateur lorsque la réponse d'une API renvoie une erreur. Pour améliorer l'expérience de l'utilisateur, ce serait une amélioration à faire.\"), \"\\n\", React.createElement(_components.p, null, \"Finalement, lorsqu'on ferme le browser et revient sur l'application par la suite, on n'est plus authentifié. Nous allons donc prochainement voir comment nous pourrions sauvegarder des données de session côté-client, dans le browser.\"), \"\\n\", React.createElement(_components.h2, null, React.createElement(\"a\", {\n    id: \"b3\"\n  }), \" b.3) Problèmes de sécurité\"), \"\\n\", React.createElement(_components.p, null, \"Il y a un problème de sécurité majeur actuellement. Nous pourrions être victime d'attaques de type XSS : des injections de JS malicieux sont possibles 😨 !\", React.createElement(_components.br), \"\\n\", \"De plus, si quelqu'un a accès au fichier \", React.createElement(_components.strong, null, \"/data/users.json\"), \" présent sur l'API, il a accès à tous les passwords des utilisateurs en clair 😨 !\"), \"\\n\", React.createElement(_components.p, null, \"Nous allons réaliser un exercice avant de traiter des problèmes de sécurité.\"), \"\\n\", React.createElement(_components.h1, null, React.createElement(\"a\", {\n    id: \"c\"\n  }), \" c) Exercice 7.1 : Authentification & autorisation au sein de myMovies\"), \"\\n\", React.createElement(_components.p, null, \"Lors de l'exercice précédent (Exercice 6.2), vous aviez une application qui permettait normalement de gérer des films, mais qui n'était pas sécurisée.\"), \"\\n\", React.createElement(_components.p, null, \"A cet exercice, veuillez introduire l'authentification d'utilisateur via ces deux nouveaux cas d'utilisation :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"UC5 : un utilisateur doit pouvoir créer un compte (register).\"), \"\\n\", React.createElement(_components.li, null, \"UC6 : un utilisateur doit pouvoir se loguer (login).\"), \"\\n\", React.createElement(_components.li, null, \"UC7 : un utilisateur doit pouvoir se déconnecter (logout).\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Vous allez continuer le développement du frontend de \", React.createElement(_components.strong, null, \"myMovies\"), \" réalisé au module 3 (Exercice 3.1) et de la RESTful API développée au module 5 (Exercice 5.2).\"), \"\\n\", React.createElement(_components.p, null, \"L'application \", React.createElement(_components.strong, null, \"myMovies\"), \" doit maintenant autoriser les opérations suivantes aux utilisateurs authentifiés uniquement :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"UC2 : l'ajout d'une ressource de type films via un formulaire d'ajout d'un film.\"), \"\\n\", React.createElement(_components.li, null, \"UC3 : la suppression d'un film.\"), \"\\n\", React.createElement(_components.li, null, \"UC4 : la mise à jour des données d'un film (à l'exception de l'id associé à un film).\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Comme auparavant, cette opération est permise pour tous les utilisateurs, anonymes ou authentifiés :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"UC1 : l'affichage, sous forme de tableau, de toutes les ressources de type films.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Vous allez devoir mettre à jour tant l'API que le frontend.\"), \"\\n\", React.createElement(_components.p, null, \"Voici les opérations qui doivent être mises à disposition par votre API :\"), \"\\n\", React.createElement(_components.h5, null, \"Opérations sur les ressources de type \\\"auths\\\"\"), \"\\n\", React.createElement(_components.p, null, \"| URI | Méthode HTTP | Auths? | Opération |\\r\\n|---|---|---|---|\\r\\n| \", React.createElement(_components.strong, null, \"auths/register\"), \" | POST | Non | Créer une ressource de type \\\"users\\\" et renvoyer le username et un token JWT |\\r\\n| \", React.createElement(_components.strong, null, \"auths/login\"), \" | POST | Non | Vérifier les credentials d'une ressource de type \\\"users\\\" et renvoyer le username et un token JWT si les credentials sont OK |\"), \"\\n\", React.createElement(\"br\"), \"\\n\", React.createElement(_components.h5, null, \"Opérations sur les ressources de type \\\"films\\\" (ou \\\"movies\\\", selon votre choix)\"), \"\\n\", React.createElement(_components.p, null, \"| URI | Méthode HTTP | Auths? | Opération |\\r\\n|---|---|---|---|\\r\\n| \", React.createElement(_components.strong, null, \"films\"), \" | GET | Non | READ ALL : Lire toutes les ressources de la collection |\\r\\n| \", React.createElement(_components.strong, null, \"films?minimum-duration=value\"), \" | GET | Non | READ ALL FILTERED : Lire toutes les ressources de la collection selon le filtre donné |\\r\\n| \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"films/{id}\")), \" | GET | Non | READ ONE : Lire la ressource identifiée |\\r\\n| \", React.createElement(_components.strong, null, \"films\"), \" | POST | JWT | CREATE ONE : Créer une ressource basée sur les données de la requête |\\r\\n| \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"films/{id}\")), \" | DELETE | JWT | DELETE ONE : Effacer la ressource identifiée |\\r\\n| \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"films/{id}\")), \" | PATCH | JWT | UPDATE ONE : Mettre à jour les propriétés de la ressource par les valeurs données dans la requête, pour une ou plusieurs propriétés |\"), \"\\n\", React.createElement(\"br\"), \"\\n\", React.createElement(_components.p, null, \"Afin de réaliser cet exercice, voici les contraintes d'implémentation :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Commencez par mettre à jour l'API pour ajouter les opérations de register, de login, ainsi que les autorisations pour les fonctions d'écritures sur des ressources de type films. Utilisez le contenu de votre répertoire d'exercices \", React.createElement(_components.strong, null, \"/exercises/module5/5.2\"), \" comme point de départ pour créer, dans votre repository local et votre web repository (normalement appelé \", React.createElement(_components.strong, null, \"web2\"), \"), le répertoire nommé \", React.createElement(_components.strong, null, \"/exercises/module7/7.1/api\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"Veuillez tester votre API via REST Client pour vous assurer que les autorisations JWT fonctionnent correctement. Quand tout est OK, vous pouvez passer au développement de votre frontend.\"), \"\\n\", React.createElement(_components.li, null, \"Pour le frontend, utilisez le contenu de votre répertoire d'exercices \", React.createElement(_components.strong, null, \"/exercises/module6/6.2\"), \" comme point de départ pour créer, dans votre repository local et\\r\\nvotre web repository (normalement appelé \", React.createElement(_components.strong, null, \"web2\"), \"), le répertoire nommé\\r\\n\", React.createElement(_components.strong, null, \"/exercises/module7/7.1/hmi\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"Veuillez utiliser le proxy de votre frontend afin de contourner les problèmes associé à la gestion des CORS.\"), \"\\n\", React.createElement(_components.li, null, \"Veuillez développer de manière incrémentale votre IHM, use case par use case, en vérifiant le bon fonctionnement de chaque cas d'utilisation avant de passer au développement de l'UC suivant.\", React.createElement(_components.br), \"\\n\", \"Nous vous recommandons de commencer par le mécanisme d'authentification en ajoutant l'UC5 et l'UC6. Notez qu'il est facile de démarrer avec l'UC6 pour le login d'admin qui existe déjà au niveau de l'API par défaut.\"), \"\\n\", React.createElement(_components.li, null, \"Pensez à bien mettre à jour votre \", React.createElement(_components.strong, null, \"Navbar\"), \" pour afficher les bons menus :\", \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"si l'utilisateur est anonyme : liens uniquement vers la HomePage, vers l'UC1 (view movies), UC5 (login) & UC6 (register) ;\"), \"\\n\", React.createElement(_components.li, null, \"si l'utilisateur est authentifié : liens uniquement vers la HomePage, vers l'UC1 (view movies) / UC2 (create) / UC3 (delete) / UC4 (update), UC7 (logout).\"), \"\\n\"), \"\\n\"), \"\\n\", React.createElement(_components.li, null, \"Faites attention, il n'est pas autorisé, pour des raisons d'ergonomie, que le frontend offre les fonctionnalités d'écriture de ressources si l'utilisateur n'est pas authentifié : UC2 (create), UC3 (delete) et UC4 (update) sont des opérations invisibles pour un utilisateur anonyme.\"), \"\\n\"), \"\\n\", React.createElement(_components.h4, null, \"🤝 Tips\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Cet exercice est l'application du tutoriel vu dans ce module-ci. N'hésitez pas donc à rejouer les étapes vues dans le tutoriel au niveau de votre API et à copier / coller les fichiers utiles (\", React.createElement(_components.strong, null, \"authorize.js\"), \", \", React.createElement(_components.strong, null, \"users.js\"), \", \", React.createElement(_components.strong, null, \"auths.js\"), \"...) : \", React.createElement(_components.a, {\n    href: \"#a\"\n  }, \"a) Authentification sécurisée et autorisation d'accès aux opérations d'une RESTful API via JWT\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"N'oubliez pas de tester chaque opération. Par exemple, il faut bien vérifier que l'on ne puisse pas créer une pizza sans token via REST Client.\"), \"\\n\", React.createElement(_components.li, null, \"Occupez-vous ensuite du frontend en copiant collant les fichiers utiles trouvés dans le tutoriel associé à cette partie (\", React.createElement(_components.strong, null, \"RegisterPage\"), \", \", React.createElement(_components.strong, null, \"LoginPage\"), \", \", React.createElement(_components.strong, null, \"Logout\"), \", \", React.createElement(_components.strong, null, \"auths\"), \", \", React.createElement(_components.strong, null, \"Navbar\"), \"...) : \", React.createElement(_components.a, {\n    href: \"#b\"\n  }, \"b) Utilisation de JWT au sein d'une IHM\"), \".\", React.createElement(_components.br), \"\\n\", \"Attention à ne pas oublier de mettre à jour votre Router (nouvelles pages pour le register, le login et le logout), la Navbar (différent affichage pour un utilisateur anonyme que pour un utilisateur connecté), d'ajouter les token dans le header de vos requêtes via fetch...\"), \"\\n\", React.createElement(_components.li, null, \"Concernant le Router, il faut mettre à jour \", React.createElement(_components.code, null, \"onNavBarClick\"), \" pour que les gestionnaires d'evénéments restent attachés même quand la Navbar est réaffichée.\"), \"\\n\", React.createElement(_components.li, null, \"💭 Comment rendre invisible les opérations d'écriture de films ?\", React.createElement(_components.br), \"\\n\", \"Par exemple, vous pourriez afficher les boutons \", React.createElement(_components.strong, null, \"Delete\"), \" et \", React.createElement(_components.strong, null, \"Save\"), \" que si l'utilisateur est authentifié.\", React.createElement(_components.br), \"\\n\", \"De même, si l'utilisateur est anonyme, les cellules associées aux films ne devraient pas être éditables.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez faire un \", React.createElement(_components.strong, null, \"commit\"), \" de votre code avec le message suivant :\\r\\n\\\"\", React.createElement(_components.strong, null, \"myMovies : module 7 : auths\"), \"\\\"\\\".\"), \"\\n\", React.createElement(_components.p, null, \"NB : Le code de vos applications se trouve dans votre repository local et\\r\\nvotre web repository (normalement appelé \", React.createElement(_components.strong, null, \"web2\"), \") dans les répertoires nommés\\r\\n\", React.createElement(_components.strong, null, \"/exercises/module7/7.1/api\"), \" et \", React.createElement(_components.strong, null, \"/exercises/module7/7.1/hmi\"), \".\"), \"\\n\", React.createElement(_components.h1, null, React.createElement(\"a\", {\n    id: \"d\"\n  }), \" d) Sécurisation de RESTful API\"), \"\\n\", React.createElement(_components.h2, null, React.createElement(\"a\", {\n    id: \"d1\"\n  }), \" d.1) Introduction\"), \"\\n\", React.createElement(_components.p, null, \"La sécurisation d'API est une problématique complexe. Nous n'allons pas aller dans les détails de cette problématique, juste offrir une solution à deux problématiques simples à traiter.\"), \"\\n\", React.createElement(_components.h2, null, React.createElement(\"a\", {\n    id: \"d2\"\n  }), \" d.2) Protection contre les attaques XSS\"), \"\\n\", React.createElement(_components.h3, null, \"d.2.1) Une attaque XSS, c'est quoi ?\"), \"\\n\", React.createElement(_components.p, null, \"Les attaques \", React.createElement(_components.strong, null, \"XSS\"), \", ou \", React.createElement(_components.strong, null, \"Cross-Site Scripting\"), \", sont un type d'injection de scripts malicieux dans une application web.\"), \"\\n\", React.createElement(_components.p, null, \"Imaginez le forum web d'une banque et ce scénario :\"), \"\\n\", React.createElement(ScrollableImage, {\n    name: \"xss.png\",\n    minWidth: \"500px\",\n    maxWidth: \"700px\"\n  }), \"\\n\", React.createElement(_components.p, null, \"L'API de la banque permet d'enregistrer des messages qui sont associés à des forums sur lesquels leurs clients peuvent poster des messages.\", React.createElement(_components.br), \"\\n\", \"Si l'API de la banque était mal sécurisée et qu'elle permettait d'enregistrer n'importe quels types d'information en tant que \\\"messages\\\" du forum, il serait possible à un attaquant d'injecter du JS malicieux dans l'API.\", React.createElement(_components.br), \"\\n\", \"Plus tard, lors de l'affichage des messages par le forum de la banque (\", React.createElement(_components.code, null, \"https://forum.my-bank.com \"), \"), le JS malicieux pourra s'exécuter dans le browser de n'importe quel utilisateur.\", React.createElement(_components.br), \"\\n\", \"Vous avez vu que via du JS, on peut envoyer de l'information n'importe où, notamment à l'aide de \", React.createElement(_components.strong, null, \"fetch\"), \". Ce qui permettrait donc à un hacker, via son script malicieux, d'envoyer des cookies contenant des infos sensibles à son API malicieuse, en vue de futures attaques encore plus diaboliques, comme notamment vider le compte en banque d'utilisateurs.\"), \"\\n\", React.createElement(_components.p, null, \"La protection contre des attaques XSS se fait à différents niveaux. Ca n'est pas l'objet de ce cours de voir cela en détails, mais nous verrons un technique simple pour éviter certaines attaques XSS.\"), \"\\n\", React.createElement(_components.h3, null, \"d.2.2) Réaliser une attaque XSS\"), \"\\n\", React.createElement(_components.p, null, \"Nous allons maintenant réaliser une attaque XSS sur le site de la pizzeria.\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez lancer le frontend \", React.createElement(_components.strong, null, \"jwt-fetch\"), \" et le backend \", React.createElement(_components.strong, null, \"auths\"), \" du site de la pizzeria. En cas de soucis :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"pour le frontend : \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/frontend/frontend-essentials/jwt-fetch\"\n  }, \"jwt-fetch\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"pour l'API : \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/auths\"\n  }, \"auths\"), \".\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Evidemment, un hackeur, pour tenter l'attaque XSS, doit d'abord trouver un moyen d'usurper la session d'\", React.createElement(_components.strong, null, \"admin\"), \". Nous ne verrons pas dans ce cours le genre d'attaques qui permettrait de le faire. Nous allons considérer que cette première attaque est réussie et nous allons prendre le rôle d'un hackeur pouvant accéder au compte \", React.createElement(_components.strong, null, \"admin\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez vous loguer à l'aide du compte \", React.createElement(_components.strong, null, \"admin\"), \" (et le password \", React.createElement(_components.strong, null, \"admin\"), \").\", React.createElement(_components.br), \"\\n\", \"Veuillez vous rendre sur la page \", React.createElement(_components.strong, null, \"Add a pizza\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Pour le titre de la pizza, vous pouvez ajouter n'importe quoi.\\r\\nDans le contenu de la pizza, veuillez ajouter cela et soumettre :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-text\"\n  }, \"<img src=\\\"#\\\" onerror=\\\"alert('You have been hacked !')\\\">\\n\")), \"\\n\", React.createElement(_components.p, null, \"En fait, nous avons ajouté une balise \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"img\")), \" contenant du inline JS. \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"oneerror\")), \" est un gestionnaire d'événements qui sera d'office appelé car la source (\", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"src=\\\"#\\\"\")), \" ) donné à \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"img\")), \" n'est pas une image.\"), \"\\n\", React.createElement(_components.p, null, \"Maintenant, tout utilisateur connecté ou pas qui se loguera sur le site va exécuter ce script \\\"malicieux\\\". Il verra le pop-up apparaître avec le message \\\"You have been hacked !\\\".\", React.createElement(_components.br), \"\\n\", \"En effet, le menu des pizzas, tel qu'il est construit, est basé sur toutes les ressources de type \\\"pizzas\\\" renvoyées par l'API, dont une des pizzas contient le JS malicieux qui est exécuté dans une cellule de la table via ce code de la \", React.createElement(_components.strong, null, \"HomePage\"), \" de l'IHM :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"function getAllTableLinesAsString(menu) {\\r\\n  let pizzaTableLines = '';\\r\\n\\r\\n  menu?.forEach((pizza) => {\\r\\n    pizzaTableLines += `<tr>\\r\\n      <td>${pizza.title}</td>\\r\\n      <td>${pizza.content}</td>\\r\\n    </tr>`;\\r\\n  });\\r\\n\\r\\n  return pizzaTableLines;\\r\\n}\\n\")), \"\\n\", React.createElement(_components.h3, null, \"d.2.3) Empêcher les attaques XSS\"), \"\\n\", React.createElement(_components.p, null, \"Par rapport à l'attaque précédente, le plus simple pour protéger de l'attaque pourrait être de faire en sorte que l'application cliente n'interprète pas d'HTML / JS / CSS envoyé par l'API.\"), \"\\n\", React.createElement(_components.p, null, \"Ici, dans la \", React.createElement(_components.strong, null, \"HomePage\"), \", on utilise la propriété \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"innerHTML\")), \" d'une \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"td\")), \". Ainsi, l'HTML et l'inline JS associé est exécuté. Si l'on utilisais la propriété \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"innerText\")), \" des \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"td\")), \", alors, ni l'HTML et le JS serait interprété par le browser, et donc pas de possibilité de script malicieux au niveau de la \", React.createElement(_components.strong, null, \"HomePage\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Oui, mais si nous allions vers cette solution, cela serait problématique si nous souhaitions réellement développer plusieurs applications clientes, il faudrait toujours faire attention à cette contrainte.\"), \"\\n\", React.createElement(_components.p, null, \"Dès lors, nous allons préférer la solution où nous sécurisons l'API. Ainsi, peu importe l'application cliente développée, il devrait y avoir moins d'angles d'attaques.\"), \"\\n\", React.createElement(_components.p, null, \"Au niveau de l'API, nous allons échapper les caractères dangereux, principalement \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"\\\"\")), \", \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"'\")), \", \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"&\")), \", \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"<\")), \", \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \">\")), \".\"), \"\\n\", React.createElement(_components.p, null, \"Nous allons utiliser la librairie \", React.createElement(_components.strong, null, React.createElement(_components.a, {\n    href: \"https://www.npmjs.com/package/escape-html\"\n  }, \"escape-html\")), \" sous Node.js échappant les string pour une utilisation des string transformées en HTML.\"), \"\\n\", React.createElement(_components.p, null, \"Nous allons maintenant continuer le développement de l'API \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/auths\"\n  }, \"auths\"), \" et la sécuriser.\"), \"\\n\", React.createElement(_components.p, null, \"Au sein de votre repo \", React.createElement(_components.strong, null, \"web2\"), \", veuillez créer le projet nommé \", React.createElement(_components.strong, null, \"/web2/tutorials/pizzeria/api/safe\"), \" sur base d'un copié collé de \", React.createElement(_components.strong, null, \"/web2/tutorials/pizzeria/api/auths\"), \" (ou \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/auths\"\n  }, \"auths\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Pour la suite du tutoriel, nous considérons que tous les chemins absolus démarrent du répertoire\\r\\n\", React.createElement(_components.strong, null, \"/web2/tutorials/pizzeria/api/safe\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez installer la librairie \", React.createElement(_components.strong, null, \"escape-html\"), \" au sein de votre projet \", React.createElement(_components.strong, null, \"safe\"), \" :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-bash\"\n  }, \"npm i escape-html\\n\")), \"\\n\", React.createElement(_components.p, null, \"Nous allons supprimer, s'il existe, le fichier reprenant le code malicieux introduit précédemment : veuillez supprimer le fichier \", React.createElement(_components.strong, null, \"/data/pizzas.json\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Nous allons à présent mettre à jour le modèle de pizzas pour échapper les caractères dangereux.\\r\\nVeuillez modifier \", React.createElement(_components.strong, null, \"/models/pizzas.js\"), \" :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"const escape = require('escape-html');\\r\\n// other bits of code\\r\\n\\r\\nfunction createOnePizza(title, content) {\\r\\n  const pizzas = parse(jsonDbPath, defaultPizzas);\\r\\n\\r\\n  const createdPizza = {\\r\\n    id: getNextId(),\\r\\n    title: escape(title),\\r\\n    content: escape(content),\\r\\n  };\\r\\n\\r\\n  pizzas.push(createdPizza);\\r\\n\\r\\n  serialize(jsonDbPath, pizzas);\\r\\n\\r\\n  return createdPizza;\\r\\n}\\n\")), \"\\n\", React.createElement(_components.p, null, \"Nous allons maintenant tester si tout est réglé au niveau de l'attaque XSS.\", React.createElement(_components.br), \"\\n\", \"Veuillez vous loguer à l'aide du compte \", React.createElement(_components.strong, null, \"admin\"), \" (et le password \", React.createElement(_components.strong, null, \"admin\"), \").\", React.createElement(_components.br), \"\\n\", \"Veuillez vous rendre sur la page \", React.createElement(_components.strong, null, \"Add a pizza\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Comme précédemment :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Pour le titre de la pizza, vous pouvez ajouter n'importe quoi.\"), \"\\n\", React.createElement(_components.li, null, \"Dans le contenu de la pizza, veuillez ajouter cela et soumettre :\"), \"\\n\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-text\"\n  }, \"<img src=\\\"#\\\" onerror=\\\"alert('You have been hacked !')\\\">\\n\")), \"\\n\", React.createElement(_components.p, null, \"Maintenant, tout utilisateur connecté verra simplement apparaître, quand il affiche la \", React.createElement(_components.strong, null, \"HomePage\"), \", le menu des pizzas avec :\"), \"\\n\", React.createElement(ScrollableImage, {\n    name: \"hacked.png\",\n    minWidth: \"500px\",\n    maxWidth: \"744px\"\n  }), \"\\n\", React.createElement(_components.p, null, \"Il n'y a plus de code JavaScript malicieux qui peut s'exécuter côté client 🎉 !\"), \"\\n\", React.createElement(_components.p, null, \"Nous allons maintenant régler les problèmes de passwords mis en clair dans un fichier de l'API.\"), \"\\n\", React.createElement(_components.h2, null, React.createElement(\"a\", {\n    id: \"d3\"\n  }), \" d.3) Sécurisation des passwords\"), \"\\n\", React.createElement(_components.p, null, \"Nous souhaitons maintenant assurer que les passwords enregistrés dans un support de données (un fichier ou une base de données) ne puissent pas être récupérés.\"), \"\\n\", React.createElement(_components.p, null, \"👍 Pour ce faire, il est recommandé d'hacher les passwords avant de les enregistrer au niveau d'une API.\"), \"\\n\", React.createElement(_components.p, null, \"Afin de se protéger contre les \\\"hash attacks\\\", on utilise du \", React.createElement(_components.strong, null, \"salt\"), \" :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"un \", React.createElement(_components.strong, null, \"salt\"), \" : c'est une donnée aléatoire qui est utilisé en entrée d'une fonction qui hache des données. Ainsi, si un hackeur utilise une base de données de passwords hachés, il devra en plus trouver le bon \", React.createElement(_components.strong, null, \"salt\"), \" pour que son attaque puisse fonctionner.\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"salt round\"), \" : nombre de fois que l'opération de hachage est faite, rendant les attaques de force brute plus lente et donc difficile ; une valeur de \", React.createElement(_components.strong, null, \"10\"), \" semble être généralement raisonnable et recommendée.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Pour hacher sous Node.js, nous utiliserons la librairie \", React.createElement(_components.a, {\n    href: \"https://www.npmjs.com/package/bcrypt\"\n  }, \"bcrypt\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez installer la librairie \", React.createElement(_components.strong, null, \"bcrypt\"), \" au sein de votre nouveau projet \", React.createElement(_components.strong, null, \"safe\"), \" :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-bash\"\n  }, \"npm i bcrypt\\n\")), \"\\n\", React.createElement(_components.p, null, \"En résumé, nous allons utiliser :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"la fonction asynchrone \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"hash\")), \" de \", React.createElement(_components.strong, null, \"bcrypt\"), \" pour hacher un password ;\"), \"\\n\", React.createElement(_components.li, null, \"la fonction asynchrone \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"compare\")), \" de \", React.createElement(_components.strong, null, \"bcrypt\"), \" pour comparer un password en clair à un password haché ; si le résultat est positif, cela signifie que le password fournit pour un utilisateur correspond au password initial.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Nous préférons utiliser les librairies asynchrone afin de laisser l'API plus disponible à gérer des requêtes clientes et pas bloquer celles-ci jusqu'à la fin d'une opération de \", React.createElement(_components.strong, null, \"bcrypt\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez effacer le fichier \", React.createElement(_components.strong, null, \"/data/users.json\"), \" contenant les credentials d'utilisateurs où les passwords ne sont pas hachés.\"), \"\\n\", React.createElement(_components.p, null, \"Nous allons maintenant mettre à jour le modèle de \\\"users\\\" pour utiliser \", React.createElement(_components.strong, null, \"bcrypt\"), \". Veuillez modifier \", React.createElement(_components.strong, null, \"/models/users.js\"), \" :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"const jwt = require('jsonwebtoken');\\r\\nconst bcrypt = require('bcrypt');\\r\\nconst path = require('node:path');\\r\\nconst { parse, serialize } = require('../utils/json');\\r\\n\\r\\nconst jwtSecret = 'ilovemypizza!';\\r\\nconst lifetimeJwt = 24 * 60 * 60 * 1000; // in ms : 24 * 60 * 60 * 1000 = 24h\\r\\n\\r\\nconst saltRounds = 10;\\r\\n\\r\\nconst jsonDbPath = path.join(__dirname, '/../data/users.json');\\r\\n\\r\\nconst defaultUsers = [\\r\\n  {\\r\\n    id: 1,\\r\\n    username: 'admin',\\r\\n    password: bcrypt.hashSync('admin', saltRounds),\\r\\n  },\\r\\n];\\r\\n\\r\\nasync function login(username, password) {\\r\\n  const userFound = readOneUserFromUsername(username);\\r\\n  if (!userFound) return undefined;\\r\\n\\r\\n  const passwordMatch = await bcrypt.compare(password, userFound.password);\\r\\n  if (!passwordMatch) return undefined;\\r\\n\\r\\n  const token = jwt.sign(\\r\\n    { username }, // session data added to the payload (payload : part 2 of a JWT)\\r\\n    jwtSecret, // secret used for the signature (signature part 3 of a JWT)\\r\\n    { expiresIn: lifetimeJwt }, // lifetime of the JWT (added to the JWT payload)\\r\\n  );\\r\\n\\r\\n  const authenticatedUser = {\\r\\n    username,\\r\\n    token,\\r\\n  };\\r\\n\\r\\n  return authenticatedUser;\\r\\n}\\r\\n\\r\\nasync function register(username, password) {\\r\\n  const userFound = readOneUserFromUsername(username);\\r\\n  if (userFound) return undefined;\\r\\n\\r\\n  await createOneUser(username, password);\\r\\n\\r\\n  const token = jwt.sign(\\r\\n    { username }, // session data added to the payload (payload : part 2 of a JWT)\\r\\n    jwtSecret, // secret used for the signature (signature part 3 of a JWT)\\r\\n    { expiresIn: lifetimeJwt }, // lifetime of the JWT (added to the JWT payload)\\r\\n  );\\r\\n\\r\\n  const authenticatedUser = {\\r\\n    username,\\r\\n    token,\\r\\n  };\\r\\n\\r\\n  return authenticatedUser;\\r\\n}\\r\\n\\r\\nfunction readOneUserFromUsername(username) {\\r\\n  const users = parse(jsonDbPath, defaultUsers);\\r\\n  const indexOfUserFound = users.findIndex((user) => user.username === username);\\r\\n  if (indexOfUserFound < 0) return undefined;\\r\\n\\r\\n  return users[indexOfUserFound];\\r\\n}\\r\\n\\r\\nasync function createOneUser(username, password) {\\r\\n  const users = parse(jsonDbPath, defaultUsers);\\r\\n\\r\\n  const hashedPassword = await bcrypt.hash(password, saltRounds);\\r\\n\\r\\n  const createdUser = {\\r\\n    id: getNextId(),\\r\\n    username,\\r\\n    password: hashedPassword,\\r\\n  };\\r\\n\\r\\n  users.push(createdUser);\\r\\n\\r\\n  serialize(jsonDbPath, users);\\r\\n\\r\\n  return createdUser;\\r\\n}\\r\\n\\r\\nfunction getNextId() {\\r\\n  const users = parse(jsonDbPath, defaultUsers);\\r\\n  const lastItemIndex = users?.length !== 0 ? users.length - 1 : undefined;\\r\\n  if (lastItemIndex === undefined) return 1;\\r\\n  const lastId = users[lastItemIndex]?.id;\\r\\n  const nextId = lastId + 1;\\r\\n  return nextId;\\r\\n}\\r\\n\\r\\nmodule.exports = {\\r\\n  login,\\r\\n  register,\\r\\n  readOneUserFromUsername,\\r\\n};\\n\")), \"\\n\", React.createElement(_components.p, null, \"Voici les modifications apportées :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"pour créer un password hashé : on utilise la fonction asynchrone \", React.createElement(_components.code, null, \"hash\"), \" pour créer le password haché. Dès lors, \", React.createElement(_components.code, null, \"createOneUser\"), \" devient asynchrone. De plus, comme \", React.createElement(_components.code, null, \"createOneUser\"), \" est devenue asynchrone, dans \", React.createElement(_components.code, null, \"register\"), \", pour chaîner le traitement de création du token, on met un \", React.createElement(_components.strong, null, \"await\"), \" à l'appel de \", React.createElement(_components.code, null, \"createOneUser\"), \". Et comme un \", React.createElement(_components.strong, null, \"await\"), \" est ajouté au sein de \", React.createElement(_components.code, null, \"register\"), \", il faut mettre un \", React.createElement(_components.strong, null, \"async\"), \" à la méthode \", React.createElement(_components.code, null, \"register\"), \". Attention, du coup, comme \", React.createElement(_components.code, null, \"register\"), \" est devenue asynchrone, il faudra faire attention à bien chaîner les traitements là où \", React.createElement(_components.code, null, \"register\"), \" est appelé, dans le router \", React.createElement(_components.strong, null, \"auths\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"pour vérifier qu'un password match à un password haché : on utilise la fonction asynchrone \", React.createElement(_components.code, null, \"compare\"), \" que l'on chaîne à la création du token à l'aide de \", React.createElement(_components.strong, null, \"await\"), \". Dès lors, la fonction \", React.createElement(_components.code, null, \"login\"), \" doit elle aussi être déclarée \", React.createElement(_components.strong, null, \"async\"), \". Attention, du coup, comme \", React.createElement(_components.code, null, \"login\"), \" est devenue asynchrone, il faudra faire attention à bien chaîner les traitements là où \", React.createElement(_components.code, null, \"login\"), \" est appelé, dans le router \", React.createElement(_components.strong, null, \"auths\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"pour créer l'utilisateur \", React.createElement(_components.strong, null, \"admin\"), \" se trouvant dans les \", React.createElement(_components.strong, null, \"defaultUsers\"), \", on souhaite indiquer comme \", React.createElement(_components.strong, null, \"password\"), \" le password haché correspondant au password \\\"admin\\\". Pour se simplifier la vie, on appelle la fonction synchrone \", React.createElement(_components.code, null, \"hashSync\"), \" (voir ligne 16). Bien évidemment, dans une application plus robuste, on évitera d'hardcoder ce genre de secrets dans les sources de notre application.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Afin de traiter des deux fonctions du modèle \", React.createElement(_components.strong, null, \"users\"), \" qui sont devenues asynchrones, \", React.createElement(_components.code, null, \"login\"), \" et \", React.createElement(_components.code, null, \"register\"), \", nous allons modifier le router \", React.createElement(_components.strong, null, \"/routes/auths\"), \" :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"const express = require('express');\\r\\nconst { register, login } = require('../models/users');\\r\\n\\r\\nconst router = express.Router();\\r\\n\\r\\n/* Register a user */\\r\\nrouter.post('/register', async (req, res) => {\\r\\n  const username = req?.body?.username?.length !== 0 ? req.body.username : undefined;\\r\\n  const password = req?.body?.password?.length !== 0 ? req.body.password : undefined;\\r\\n\\r\\n  if (!username || !password) return res.sendStatus(400); // 400 Bad Request\\r\\n\\r\\n  const authenticatedUser = await register(username, password);\\r\\n\\r\\n  if (!authenticatedUser) return res.sendStatus(409); // 409 Conflict\\r\\n\\r\\n  return res.json(authenticatedUser);\\r\\n});\\r\\n\\r\\n/* Login a user */\\r\\nrouter.post('/login', async (req, res) => {\\r\\n  const username = req?.body?.username?.length !== 0 ? req.body.username : undefined;\\r\\n  const password = req?.body?.password?.length !== 0 ? req.body.password : undefined;\\r\\n\\r\\n  if (!username || !password) return res.sendStatus(400); // 400 Bad Reques\\r\\n\\r\\n  const authenticatedUser = await login(username, password);\\r\\n\\r\\n  if (!authenticatedUser) return res.sendStatus(401); // 401 Unauthorized\\r\\n\\r\\n  return res.json(authenticatedUser);\\r\\n});\\r\\n\\r\\nmodule.exports = router;\\n\")), \"\\n\", React.createElement(_components.p, null, \"Nous avons simplement chaîné les réponses à faire au client seulement une fois les opération \", React.createElement(_components.code, null, \"register\"), \" et \", React.createElement(_components.code, null, \"login\"), \" terminées. Pour ce faire, nous avons précédé le nom de ces méthodes par \", React.createElement(_components.strong, null, \"await\"), \". Nous avons donc du ajouter \", React.createElement(_components.strong, null, \"async\"), \" aux fonctions middleware s'occupant des routes \", React.createElement(_components.strong, null, \"POST /auths/register\"), \" et \", React.createElement(_components.strong, null, \"POST /auths/login\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez vérifier que votre application fonctionne correctement.\", React.createElement(_components.br), \"\\n\", \"Via l'IHM, veuillez faire un register d'un nouvel utilisateur.\", React.createElement(_components.br), \"\\n\", \"Au niveau de l'API, allez voir le contenu du nouveau fichier \", React.createElement(_components.strong, null, \"/data/users.json\"), \". Les passwords devraient maintenant être hachés, comme par exemple :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-json\"\n  }, \"[\\r\\n  {\\r\\n    \\\"id\\\": 1,\\r\\n    \\\"username\\\": \\\"admin\\\",\\r\\n    \\\"password\\\": \\\"$2b$10$RioLKlPFyYFEhv/46gR7dufDkke07eDpWH9tBt/A4Z9tJh0oJnnf2\\\"\\r\\n  },\\r\\n  {\\r\\n    \\\"id\\\": 2,\\r\\n    \\\"username\\\": \\\"manager\\\",\\r\\n    \\\"password\\\": \\\"$2b$10$NZZ1zxOPdby6gl4Dw8K0Q.v4ZRWTbh1Ta7qcYzH5G4SrO5z71H0kO\\\"\\r\\n  }\\r\\n]\\n\")), \"\\n\", React.createElement(_components.p, null, \"Si tout fonctionne bien, faites un \", React.createElement(_components.strong, null, \"commit\"), \" de votre repo (\", React.createElement(_components.strong, null, \"web2\"), \") avec le message\\r\\n\\\"\", React.createElement(_components.strong, null, \"api-safe\"), \"\\\".\"), \"\\n\", React.createElement(_components.p, null, \"En cas de souci, vous pouvez utiliser le code du tutoriel :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"pour le frontend : \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/frontend/frontend-essentials/jwt-fetch\"\n  }, \"jwt-fetch\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"pour l'API : \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/safe\"\n  }, \"safe\"), \".\"), \"\\n\"), \"\\n\", React.createElement(_components.h1, null, React.createElement(\"a\", {\n    id: \"e\"\n  }), \" e) Exercice 7.2 : Sécurisation de l'API de myMovies\"), \"\\n\", React.createElement(_components.p, null, \"A l'exercice précédent (Exercice 7.1), vous avez développé le mécanisme d'authentification et d'autorisation d'accès à des opérations de votre RESTful API gérant des films.\"), \"\\n\", React.createElement(_components.p, null, \"Néanmoins, cette API n'est pas encore sécurisée. Les passwords sont disponibles en clair dans un fichier JSON et il est possible de faire des attaques XSS.\"), \"\\n\", React.createElement(_components.p, null, \"Commencez par hacker votre site en faisant une injection de Javascript. Ce script \\\"malicieux\\\" affichera un pop-up à chaque utilisateur affichant la liste des films ; ce pop-up sera suffisamment explicite pour que vos utilisateurs sachent qu'ils ont été piratés.\"), \"\\n\", React.createElement(_components.p, null, \"Ensuite, veuillez sécuriser l'API pour échapper les caractères dangereux et pour hacher les password.\"), \"\\n\", React.createElement(_components.p, null, \"Afin de réaliser cet exercice, voici les contraintes d'implémentation :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Pour le frontend, il n'y a rien à développer, veuillez exécuter  le contenu de votre répertoire d'exercices \", React.createElement(_components.strong, null, \"/exercises/module7/7.1/hmi\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"Pour l'API, utilisez le contenu de votre répertoire d'exercices \", React.createElement(_components.strong, null, \"/exercises/module7/7.1/api\"), \" comme point de départ pour créer, dans votre repository local et\\r\\nvotre web repository (normalement appelé \", React.createElement(_components.strong, null, \"web2\"), \"), le répertoire nommé\\r\\n\", React.createElement(_components.strong, null, \"/exercises/module7/7.2/api\"), \".\"), \"\\n\"), \"\\n\", React.createElement(_components.h4, null, \"🤝 Tips\"), \"\\n\", React.createElement(_components.p, null, \"Cet exercice est l'application du tutoriel vu dans ce module-ci. N'hésitez pas donc à rejouer les étapes vues dans le tutoriel au niveau de votre API : \", React.createElement(_components.a, {\n    href: \"#d\"\n  }, \"d) Sécurisation de RESTful API\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"⚡ N'oubliez pas que vos méthodes de login et de register deviennent asynchrones, cela impose de bien chaîner les traitements dans le router, sinon vous risquez de renvoyer des objets vides en réponses aux requêtes.\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez faire un \", React.createElement(_components.strong, null, \"commit\"), \" de votre code avec le message suivant :\\r\\n\\\"\", React.createElement(_components.strong, null, \"myMovies : module 7 : safe api\"), \"\\\"\\\".\"), \"\\n\", React.createElement(_components.p, null, \"NB : Le code de vos applications se trouve dans votre repository local et\\r\\nvotre web repository (normalement appelé \", React.createElement(_components.strong, null, \"web2\"), \") dans le répertoire nommé\\r\\n\", React.createElement(_components.strong, null, \"/exercises/module7/7.2/api\"), \".\"), \"\\n\", React.createElement(_components.h1, null, React.createElement(\"a\", {\n    id: \"f\"\n  }), \" f) 🍬 Exercice 7.3 : Auto-refresh de myMovies\"), \"\\n\", React.createElement(_components.p, null, \"S'il vous reste du temps, il serait vraiment intéressant de faire en sorte que cycliquement, tous les 5 secondes par exemple, l'affichage de la liste de films se mette automatiquement à jour.\"), \"\\n\", React.createElement(_components.p, null, \"Ainsi, si d'autres utilisateurs ajoutent un film, vous les verrez directement apparaître dans votre fenêtre.\"), \"\\n\", React.createElement(_components.p, null, \"⚡ Attention que si le composant d'affichage des films est utilisé pour permettre de directement mettre à jour un film, celui-ci ne doit pas se réafficher si un utilisateur est en train de mettre à jour un film.\"), \"\\n\", React.createElement(_components.h4, null, \"🤝 Tips\"), \"\\n\", React.createElement(_components.p, null, \"Pensez à la fonction \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"setInterval\")), \".\"), \"\\n\", React.createElement(_components.p, null, \"Vous pouvez faire un \", React.createElement(_components.strong, null, \"commit\"), \" de votre code avec le message suivant :\\r\\n\\\"\", React.createElement(_components.strong, null, \"myMovies : module 7 : auto-refresh\"), \"\\\"\\\".\"), \"\\n\", React.createElement(_components.p, null, \"NB : Le code de vos applications se trouverait dans votre repository local et\\r\\nvotre web repository (normalement appelé \", React.createElement(_components.strong, null, \"web2\"), \") dans le répertoire nommé\\r\\n\", React.createElement(_components.strong, null, \"/exercises/module7/7.3/hmi\"), \".\"), \"\\n\", React.createElement(_components.h1, null, React.createElement(\"a\", {\n    id: \"g\"\n  }), \" g) 🍬 Exercice 7.4 : Gestion de la navigation lors de l'auto-refresh de myMovies\"), \"\\n\", React.createElement(_components.p, null, \"💭 Que peut-il se passer de désagréable si un utilisateur passe rapidement de la page listant les informations d'un film vers la page d'ajout d'un film ?\"), \"\\n\", React.createElement(_components.p, null, \"Comme le render de tous les films et une action asynchrone, il est possible que celui-ci soit réalisé après que l'utilisateur ait quitté la page d'affichage des films. Cela peut être gênant, car si vous êtes sur le composant pour ajouter un film, vous ne souhaitez pas que votre formulaire d'ajout d'un film soit remplacé, de manière erronée, par la liste des films !\"), \"\\n\", React.createElement(_components.p, null, \"Nous vous proposons d'implémenter ces deux fonctions :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Stopper les futurs appels de \", React.createElement(_components.strong, null, \"fetch\"), \", les appels automatiques vers vos APIs (\", React.createElement(_components.strong, null, \"setInterval\"), \" et \", React.createElement(_components.strong, null, \"clearInterval\"), \") quand il y a un clic sur un lien ;\"), \"\\n\", React.createElement(_components.li, null, \"Stopper les appels de \", React.createElement(_components.strong, null, \"fetch\"), \" en cours vers vos APIs quand il y a un clic sur un lien. En effet, si votre API doit renvoyer beaucoup de données, notamment quand il y a des images à communiquer, il est possible que cela prenne plusieurs secondes avant que l'API vous réponde.\"), \"\\n\"), \"\\n\", React.createElement(_components.h4, null, \"🤝 Tips\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Pensez aux fonctions \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"setInterval\")), \" et \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"clearInterval\")), \".\"), \"\\n\", React.createElement(_components.li, null, \"Pour stopper un fetch en cours, vous pouvez utiliser un \", React.createElement(_components.strong, null, \"AbortControlller\"), \". Toute l'info est disponible sur la \", React.createElement(_components.a, {\n    href: \"https://developer.mozilla.org/en-US/docs/Web/API/AbortController\"\n  }, \"Documentation MDN\"), \".\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Vous pouvez faire un \", React.createElement(_components.strong, null, \"commit\"), \" de votre code avec le message suivant :\\r\\n\\\"\", React.createElement(_components.strong, null, \"myMovies : module 7 : auto-refresh improved\"), \"\\\"\\\".\"), \"\\n\", React.createElement(_components.p, null, \"NB : Le code de vos applications se trouverait dans votre repository local et\\r\\nvotre web repository (normalement appelé \", React.createElement(_components.strong, null, \"web2\"), \") dans le répertoire nommé\\r\\n\", React.createElement(_components.strong, null, \"/exercises/module7/7.4/hmi\"), \".\"));\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? React.createElement(MDXLayout, props, React.createElement(_createMdxContent, props)) : _createMdxContent(props);\n}\nexport default MDXContent;\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","import GATSBY_COMPILED_MDX from \"D:/Vinci/code/web2/js-course/frontend/src/mdx-pages/modules/7.fr.mdx\";\nimport React from 'react';\nimport {graphql} from 'gatsby';\nimport {MDXProvider} from '@mdx-js/react';\nimport {Link} from 'gatsby';\nimport MainLayout from '../components/main-layout.js';\nimport Image from '../components/image.js';\nimport Section from '../components/section.js';\nimport Content from '../components/content.js';\nimport Background from '../components/background.js';\nimport SectionHeader from '../components/section-header.js';\nimport SectionFooter from '../components/section-footer.js';\nimport PageHeader from '../components/page-header.js';\nimport {withFrontmatter} from '../components/hoc/hoc.js';\nimport CodeBlock from '../components/codeblock/codeblock.js';\nimport LinkFile from '../components/file/link-file.js';\nimport ScrollableImage from '../components/image/scrollable-image';\nimport PublicProjectsView from '../components/public-projects/public-projects-view';\nimport {AuthenticatedTemplate, UnauthenticatedTemplate} from '@azure/msal-react';\nimport AuthenticatedBlock from '../components/auth/authenticated-block.js';\nimport UnAuthenticatedBlock from '../components/auth/unauthenticated-block.js';\nimport NestedMdxBlock from '../components/mdx/nested-mdx-block.js';\nimport YoutubeImage from '../components/image/youtube-image.js';\nimport InternalPageMenu from '../components/internal-page-menu/internal-page-menu.js';\nimport InternalPageMenuItem from '../components/internal-page-menu/internal-page-menu-item.js';\nimport InternalPageTitle from '../components/internal-page-menu/menu-title.js';\nimport {PathViewer, PathViewerItem} from '../components/path-viewer/path-viewer.js';\nconst shortcodes = {\n  Link,\n  Image,\n  Section,\n  Content,\n  Background,\n  SectionHeader,\n  SectionFooter,\n  PageHeader,\n  CodeBlock,\n  LinkFile,\n  ScrollableImage,\n  PublicProjectsView,\n  AuthenticatedBlock,\n  UnAuthenticatedBlock,\n  NestedMdxBlock,\n  YoutubeImage,\n  InternalPageMenu,\n  InternalPageMenuItem,\n  InternalPageTitle,\n  PathViewer,\n  PathViewerItem\n};\nfunction PageTemplate({data: {mdx, allImages}, children}) {\n  shortcodes.PageHeader = withFrontmatter(PageHeader, mdx?.frontmatter);\n  return React.createElement(MainLayout, Object.assign({}, mdx?.frontmatter ? {\n    frontmatter: mdx.frontmatter\n  } : {}, mdx?.frontmatter?.navbarExtraStyles ? {\n    navbarExtraStyles: mdx.frontmatter.navbarExtraStyles\n  } : {}, mdx?.frontmatter?.headerImage ? {\n    headerImage: mdx.frontmatter.headerImage\n  } : {}, mdx?.frontmatter?.featuredImage ? {\n    featuredImage: mdx.frontmatter.featuredImage\n  } : {}, mdx?.frontmatter?.title ? {\n    pageTitle: mdx.frontmatter.title\n  } : {}, allImages && allImages.length > 0 ? {\n    allImages: allImages\n  } : {}), React.createElement(MDXProvider, {\n    components: shortcodes\n  }, React.createElement(\"div\", {\n    className: mdx?.frontmatter?.autoMargin ? 'page page--auto-margin' : 'page'\n  }, children)));\n}\nexport default function GatsbyMDXWrapper(props) {\n  return React.createElement(PageTemplate, props, React.createElement(GATSBY_COMPILED_MDX, props));\n}\nexport const pageQuery = graphql`\n  query pagesAndImages($slug: String) {\n    mdx(fields: { slug: { eq: $slug } }) {\n      id\n      body\n      fields {\n        slug\n      }\n\n      frontmatter {\n        title\n        date\n        navbarExtraStyles\n        headerImage\n        featuredImage\n        description\n        autoMargin\n      }\n    }\n    allImages: allFile(\n      filter: {\n        sourceInstanceName: { eq: \"images\" }\n        extension: { nin: [\"ico\", \"svg\"] }\n      }\n    ) {\n      edges {\n        node {\n          childImageSharp {\n            gatsbyImageData(\n              quality: 90\n              layout: FULL_WIDTH\n              placeholder: TRACED_SVG\n              tracedSVGOptions: { color: \"green\", background: \"grey\" }\n            )\n          }\n          base\n        }\n      }\n    }\n  }\n`;\n"],"names":["_createMdxContent","props","_components","Object","assign","h1","p","br","ul","li","a","h2","h3","strong","h4","code","pre","h5","_provideComponents","components","ScrollableImage","id","component","Error","_missingMdxReference","React","href","className","name","minWidth","maxWidth","wrapper","MDXLayout","shortcodes","Link","Image","Section","Content","Background","SectionHeader","SectionFooter","PageHeader","CodeBlock","LinkFile","PublicProjectsView","AuthenticatedBlock","UnAuthenticatedBlock","NestedMdxBlock","YoutubeImage","InternalPageMenu","InternalPageMenuItem","InternalPageTitle","PathViewer","PathViewerItem","PageTemplate","data","mdx","allImages","children","withFrontmatter","frontmatter","MainLayout","navbarExtraStyles","headerImage","featuredImage","title","pageTitle","length","MDXProvider","autoMargin","GatsbyMDXWrapper","GATSBY_COMPILED_MDX"],"sourceRoot":""}