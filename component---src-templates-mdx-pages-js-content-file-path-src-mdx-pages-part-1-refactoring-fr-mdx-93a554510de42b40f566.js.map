{"version":3,"file":"component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-1-refactoring-fr-mdx-93a554510de42b40f566.js","mappings":"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","sources":["webpack://myjscourse/./src/mdx-pages/part1/refactoring.fr.mdx","webpack://myjscourse/./src/templates/mdx-pages.js"],"sourcesContent":["/*@jsxRuntime classic @jsx React.createElement @jsxFrag React.Fragment*/\nimport {useMDXComponents as _provideComponents} from \"@mdx-js/react\";\nimport React from \"react\";\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h1: \"h1\",\n    p: \"p\",\n    a: \"a\",\n    br: \"br\",\n    ul: \"ul\",\n    li: \"li\",\n    strong: \"strong\",\n    ol: \"ol\",\n    pre: \"pre\",\n    code: \"code\"\n  }, _provideComponents(), props.components), {PathViewer, PathViewerItem, InternalPageMenu, InternalPageMenuItem, InternalPageTitle, ScrollableImage} = _components;\n  if (!InternalPageMenu) _missingMdxReference(\"InternalPageMenu\", true);\n  if (!InternalPageMenuItem) _missingMdxReference(\"InternalPageMenuItem\", true);\n  if (!InternalPageTitle) _missingMdxReference(\"InternalPageTitle\", true);\n  if (!PathViewer) _missingMdxReference(\"PathViewer\", true);\n  if (!PathViewerItem) _missingMdxReference(\"PathViewerItem\", true);\n  if (!ScrollableImage) _missingMdxReference(\"ScrollableImage\", true);\n  return React.createElement(React.Fragment, null, React.createElement(PathViewer, null, React.createElement(PathViewerItem, {\n    to: \"/\"\n  }, \" web2course \"), React.createElement(PathViewerItem, {\n    to: \"/part1\"\n  }, \" Partie 1)\"), React.createElement(PathViewerItem, {\n    selected: true\n  }, \" e) Refactoring \")), \"\\n\", React.createElement(_components.h1, null, \"e) Refactoring à l'aide d'un \\\"fat model\\\"\"), \"\\n\", React.createElement(InternalPageMenu, null, React.createElement(InternalPageMenuItem, null, \" Architectures possibles ? \"), React.createElement(InternalPageMenuItem, null, \" Architecture Express & \\\"fat model\\\" \"), React.createElement(InternalPageMenuItem, null, \" Exercice 1.4 : Refactoring de la RESTfull API pour myMovies \")), \"\\n\", React.createElement(_components.h1, null, React.createElement(InternalPageTitle, null, \" Architectures possibles ? \")), \"\\n\", React.createElement(_components.p, null, \"Si nous reprenons le code actuel du tutoriel de l'API gérant des pizzas (\", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/persistence\"\n  }, \"api-persistence\"), \"), nous pouvons détecter que celui-ci pourrait être plus propre.\"), \"\\n\", React.createElement(_components.p, null, \"Par exemple, le routeur de \\\"pizzas\\\" s'occupe tant de gérer les requêtes des clients que d'accéder directement aux données.\", React.createElement(_components.br), \"\\n\", \"Généralement, nous préférons séparer le code gérant les accès aux données du code gérant la présentation du résultat des opérations.\"), \"\\n\", React.createElement(_components.p, null, \"On peut donc se demander comment séparer le code traitant de sujets différents, où ayant des responsabilités fort différentes. Il existe une multitude d'architectures possibles, voici par exemple certains des plus grands noms :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"Architecture MVC (Model View Controller)\"), \" ; au niveau backend, ce genre d'architecture est généralement très utile quand on fait des MPA (ou Multi-Page Applications) via du Server-Side Rendering. Les \", React.createElement(_components.strong, null, \"Views\"), \" permettent de générer le frontend à l'aide d'un moteur de templating ; le \", React.createElement(_components.strong, null, \"Controller\"), \" s'occupe de traiter les requêtes en appelant le \", React.createElement(_components.strong, null, \"Model\"), \" pour l'accès aux opérations sur les données et en renvoyant les \", React.createElement(_components.strong, null, \"Views\"), \" adéquates. Pour une API, cette architecture n'est pas la plus adaptée.\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"Architecture classique \\\"three-tiers\\\"\"), \" ; au nivau backend, quand on développe une architecture trois tiers, cela signifie que l'on découpe notre API en trois couches :\", \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"couche de présentation\"), \" : cette couche est responsable de présenter les ressources aux clients et d'interpréter les représentations des ressources données dans les requêtes ;\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"couche business\"), \" : cette couche s'occupe de toute la logique de l'API, elle fait l'intermédiaire entre la couche de présentation et la couche de données ;\"), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.strong, null, \"couche de données\"), \" : cette couche s'occupe des accès aux données et permet notamment la persistance des ressources au sein de bases de données.\", React.createElement(_components.br), \"\\n\", \"Le modèle trois tiers est fort intéressant, mais il demande un peu trop d'écriture de codes sans grande valeur ajoutée quand nous utilisons le framework Express.\"), \"\\n\"), \"\\n\"), \"\\n\", React.createElement(_components.li, null, \"...\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Finalement, parmi les architectures classiques, il n'y a pas réellement une architecture qui colle parfaitement à ce qui est offert par le framework Express, sans devoir écrire du code sans valeur ajoutée.\"), \"\\n\", React.createElement(_components.p, null, \"Ainsi, nous allons simplement créer notre propre architecture \\\"maison\\\", sur base de ces points :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"On souhaite pouvoir facilement remplacer la couche d'accès aux données sans changer la représentation des ressources ; en effet, dans un premier temps, nous sauvegarderons des données dans des fichiers JSON. Plus tard, si l'on venait à sauvegarder les données dans un système de gestion de base de données, on ne veut pas devoir mettre à jour le code prenant en compte les requêtes des clients et présentant la réponse à ces requêtes ; en gros, on souhaite que le code de nos routers, au sein d'Express, soit indépendant de l'implémentation des accès aux données.\"), \"\\n\", React.createElement(_components.li, null, \"Nous n'avons pas vraiment de contraintes pour l'aspect \\\"business\\\" de nos APIs : la logique de l'application peut soit s'associer à la couche de données, soit à la couche présentation. Néanmoins, nous allons préférer associer un maximum de la logique de notre application à ce que nous allons appeler un \", React.createElement(_components.strong, null, \"fat model\"), \". Le \", React.createElement(_components.strong, null, \"fat model\"), \" contiendra toutes les opérations possibles sur les ressources, ainsi que les accès aux données.\"), \"\\n\", React.createElement(_components.li, null, \"Le \", React.createElement(_components.strong, null, \"fat model\"), \" peut être soit écrit en orienté objet, soit simplement être un module fournissant des fonctions. Dans le cadre de ce cours, nous choisissons de présenter un maximum de programmation fonctionnelle plutôt que de l'orienté objet.\", React.createElement(_components.br), \"\\n\", \"Néanmoins, n'hésitez pas à écrire des classes si cela vous tient à coeur 😉.\"), \"\\n\"), \"\\n\", React.createElement(_components.h1, null, React.createElement(InternalPageTitle, null, \" Architecture Express & \\\"fat model\\\" \")), \"\\n\", React.createElement(_components.p, null, \"Voici l'architecture que nous allons appliquer dans nos prochaines API :\"), \"\\n\", React.createElement(ScrollableImage, {\n    name: \"architecture.png\",\n    minWidth: \"859px\",\n    maxWidth: \"859px\"\n  }), \"\\n\", React.createElement(\"figcaption\", null, \"Architecture recommandée pour ce cours\"), \"\\n\", React.createElement(_components.p, null, \"Voici quelques explications sur ce diagramme que nous allons appliquer dans le prochain tutoriel :\"), \"\\n\", React.createElement(_components.ol, null, \"\\n\", React.createElement(_components.li, null, \"Un client fait la requête à l'API demandant de lire toutes les pizzas.\"), \"\\n\", React.createElement(_components.li, null, \"Le router de \\\"pizzas\\\" prend le rôle de \\\"Controller\\\". Il s'occupe de traiter de la requête et d'appeler une opération du \", React.createElement(_components.strong, null, \"fat model\"), \" pour accéder aux ressources.\"), \"\\n\", React.createElement(_components.li, null, \"Le \", React.createElement(_components.strong, null, \"fat model\"), \" s'occupe d'accéder aux données, qui se trouvent au sein d'un fichier JSON, et de les lire.\"), \"\\n\", React.createElement(_components.li, null, \"Le \", React.createElement(_components.strong, null, \"fat model\"), \" retourne des données sous forme d'un objet JS au router de \\\"pizzas\\\".\"), \"\\n\", React.createElement(_components.li, null, \"Le router de \\\"pizzas\\\" renvoient une représentation JSON de l'objet JS, un array de pizzas, au client.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Nous allons maintenant faire un refactor de notre API de gestion des pizzas en créant et utilisant un \\\"fat model\\\".\"), \"\\n\", React.createElement(_components.p, null, \"Au sein de votre repo \", React.createElement(_components.strong, null, \"web2\"), \", à l'aide du boilerplate du cours \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/basic-api-boilerplate\"\n  }, \"basic-api-boilerplate\"), \", veuillez créer le projet nommé \", React.createElement(_components.strong, null, \"/web2/tutorials/pizzeria/api/fat-model\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Si vous ne voyez pas comment utiliser le boilerplate, tout est expliqué dans le \", React.createElement(_components.strong, null, \"README\"), \" associé au repository du boilerplate.\", React.createElement(_components.br), \"\\n\", \"N'hésitez pas à le lire ; )\"), \"\\n\", React.createElement(_components.p, null, \"Pour la suite du tutoriel, nous considérons que tous les chemins absolus démarrent du répertoire\\r\\n\", React.createElement(_components.strong, null, \"/web2/tutorials/pizzeria/api/fat-model\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Nous allons commencer par créer le \", React.createElement(_components.strong, null, \"fat model\"), \" offrant les opérations sur les pizzas.\", React.createElement(_components.br), \"\\n\", \"Veuillez créer le fichier \", React.createElement(_components.strong, null, \"/models/pizzas.js\"), \".\", React.createElement(_components.br), \"\\n\", \"Au sein de ce fichier, veuillez ajouter le code s'occupant des opérations sur les ressources de type \\\"pizzas\\\" :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"const path = require('node:path');\\r\\nconst { parse, serialize } = require('../utils/json');\\r\\n\\r\\nconst jsonDbPath = path.join(__dirname, '/../data/pizzas.json');\\r\\n\\r\\nconst defaultPizzas = [\\r\\n  {\\r\\n    id: 1,\\r\\n    title: '4 fromages',\\r\\n    content: 'Gruyère, Sérac, Appenzel, Gorgonzola, Tomates',\\r\\n  },\\r\\n  {\\r\\n    id: 2,\\r\\n    title: 'Vegan',\\r\\n    content: 'Tomates, Courgettes, Oignons, Aubergines, Poivrons',\\r\\n  },\\r\\n  {\\r\\n    id: 3,\\r\\n    title: 'Vegetarian',\\r\\n    content: 'Mozarella, Tomates, Oignons, Poivrons, Champignons, Olives',\\r\\n  },\\r\\n  {\\r\\n    id: 4,\\r\\n    title: 'Alpage',\\r\\n    content: 'Gruyère, Mozarella, Lardons, Tomates',\\r\\n  },\\r\\n  {\\r\\n    id: 5,\\r\\n    title: 'Diable',\\r\\n    content: 'Tomates, Mozarella, Chorizo piquant, Jalapenos',\\r\\n  },\\r\\n];\\r\\n\\r\\nfunction readAllPizzas(orderBy) {\\r\\n  const orderByTitle = orderBy?.includes('title') ? orderBy : undefined;\\r\\n  let orderedMenu;\\r\\n  const pizzas = parse(jsonDbPath, defaultPizzas);\\r\\n  if (orderByTitle)\\r\\n    orderedMenu = [...pizzas].sort((a, b) => a.title.localeCompare(b.title));\\r\\n  if (orderByTitle === '-title') orderedMenu = orderedMenu.reverse();\\r\\n\\r\\n  const allPizzasPotentiallyOrderd = orderedMenu ?? pizzas;\\r\\n  return allPizzasPotentiallyOrderd;\\r\\n}\\r\\n\\r\\nfunction readOnePizza(id) {\\r\\n  const idNumber = parseInt(id, 10);\\r\\n  const pizzas = parse(jsonDbPath, defaultPizzas);\\r\\n  const indexOfPizzaFound = pizzas.findIndex((pizza) => pizza.id === idNumber);\\r\\n  if (indexOfPizzaFound < 0) return undefined;\\r\\n\\r\\n  return pizzas[indexOfPizzaFound];\\r\\n}\\r\\n\\r\\nfunction createOnePizza(title, content) {\\r\\n  const pizzas = parse(jsonDbPath, defaultPizzas);\\r\\n\\r\\n  const createdPizza = {\\r\\n    id: getNextId(),\\r\\n    title,\\r\\n    content,\\r\\n  };\\r\\n\\r\\n  pizzas.push(createdPizza);\\r\\n\\r\\n  serialize(jsonDbPath, pizzas);\\r\\n\\r\\n  return createdPizza;\\r\\n}\\r\\n\\r\\nfunction getNextId() {\\r\\n  const pizzas = parse(jsonDbPath, defaultPizzas);\\r\\n  const lastItemIndex = pizzas?.length !== 0 ? pizzas.length - 1 : undefined;\\r\\n  if (lastItemIndex === undefined) return 1;\\r\\n  const lastId = pizzas[lastItemIndex]?.id;\\r\\n  const nextId = lastId + 1;\\r\\n  return nextId;\\r\\n}\\r\\n\\r\\nfunction deleteOnePizza(id) {\\r\\n  const idNumber = parseInt(id, 10);\\r\\n  const pizzas = parse(jsonDbPath, defaultPizzas);\\r\\n  const foundIndex = pizzas.findIndex((pizza) => pizza.id === idNumber);\\r\\n  if (foundIndex < 0) return undefined;\\r\\n  const deletedPizzas = pizzas.splice(foundIndex, 1);\\r\\n  const deletedPizza = deletedPizzas[0];\\r\\n  serialize(jsonDbPath, pizzas);\\r\\n\\r\\n  return deletedPizza;\\r\\n}\\r\\n\\r\\nfunction updateOnePizza(id, propertiesToUpdate) {\\r\\n  const idNumber = parseInt(id, 10);\\r\\n  const pizzas = parse(jsonDbPath, defaultPizzas);\\r\\n  const foundIndex = pizzas.findIndex((pizza) => pizza.id === idNumber);\\r\\n  if (foundIndex < 0) return undefined;\\r\\n\\r\\n  const updatedPizza = { ...pizzas[foundIndex], ...propertiesToUpdate };\\r\\n\\r\\n  pizzas[foundIndex] = updatedPizza;\\r\\n\\r\\n  serialize(jsonDbPath, pizzas);\\r\\n\\r\\n  return updatedPizza;\\r\\n}\\r\\n\\r\\nmodule.exports = {\\r\\n  readAllPizzas,\\r\\n  readOnePizza,\\r\\n  createOnePizza,\\r\\n  deleteOnePizza,\\r\\n  updateOnePizza,\\r\\n};\\n\")), \"\\n\", React.createElement(_components.p, null, \"Maintenant, il ne reste plus qu'à mettre à jour le router \", React.createElement(_components.strong, null, \"/routes/pizzas.js\"), \" afin de faire les appels aux fonctions offertes par le modèle :\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-js\"\n  }, \"const express = require('express');\\r\\nconst {\\r\\n  readAllPizzas,\\r\\n  readOnePizza,\\r\\n  createOnePizza,\\r\\n  deleteOnePizza,\\r\\n  updateOnePizza,\\r\\n} = require('../models/pizzas');\\r\\n\\r\\nconst router = express.Router();\\r\\n\\r\\n/* Read all the pizzas from the menu\\r\\n   GET /pizzas?order=title : ascending order by title\\r\\n   GET /pizzas?order=-title : descending order by title\\r\\n*/\\r\\nrouter.get('/', (req, res) => {\\r\\n  const allPizzasPotentiallyOrdered = readAllPizzas(req?.query?.order);\\r\\n\\r\\n  return res.json(allPizzasPotentiallyOrdered);\\r\\n});\\r\\n\\r\\n// Read the pizza identified by an id in the menu\\r\\nrouter.get('/:id', (req, res) => {\\r\\n  const foundPizza = readOnePizza(req.params.id);\\r\\n\\r\\n  if (!foundPizza) return res.sendStatus(404);\\r\\n\\r\\n  return res.json(foundPizza);\\r\\n});\\r\\n\\r\\n// Create a pizza to be added to the menu.\\r\\nrouter.post('/', (req, res) => {\\r\\n  const title = req?.body?.title?.length !== 0 ? req.body.title : undefined;\\r\\n  const content =\\r\\n    req?.body?.content?.length !== 0 ? req.body.content : undefined;\\r\\n\\r\\n  if (!title || !content) return res.sendStatus(400); // error code '400 Bad request'\\r\\n\\r\\n  const createdPizza = createOnePizza(title, content);\\r\\n\\r\\n  return res.json(createdPizza);\\r\\n});\\r\\n\\r\\n// Delete a pizza from the menu based on its id\\r\\nrouter.delete('/:id', (req, res) => {\\r\\n  const deletedPizza = deleteOnePizza(req.params.id);\\r\\n\\r\\n  if (!deletedPizza) return res.sendStatus(404);\\r\\n\\r\\n  return res.json(deletedPizza);\\r\\n});\\r\\n\\r\\n// Update a pizza based on its id and new values for its parameters\\r\\nrouter.patch('/:id', (req, res) => {\\r\\n  const title = req?.body?.title;\\r\\n  const content = req?.body?.content;\\r\\n\\r\\n  if ((!title && !content) || title?.length === 0 || content?.length === 0) {\\r\\n    return res.sendStatus(400);\\r\\n  }\\r\\n\\r\\n  const updatedPizza = updateOnePizza(req.params.id, { title, content });\\r\\n\\r\\n  if (!updatedPizza) return res.sendStatus(404);\\r\\n\\r\\n  return res.json(updatedPizza);\\r\\n});\\r\\n\\r\\nmodule.exports = router;\\n\")), \"\\n\", React.createElement(_components.p, null, \"Lancer votre API soit via le debugger, soit via la commande \", React.createElement(_components.strong, null, React.createElement(_components.code, null, \"npm run dev\")), \".\", React.createElement(_components.br), \"\\n\", \"Veuillez ensuite tester que tout fonctionne bien en exécutant les requêtes HTTP déjà présentes dans le répertoire \", React.createElement(_components.strong, null, \"REST Client\"), \" du boilerplate.\"), \"\\n\", React.createElement(_components.p, null, \"Si tout fonctionne bien, faites un \", React.createElement(_components.strong, null, \"commit\"), \" de votre repo (\", React.createElement(_components.strong, null, \"web2\"), \") avec le message \\\"\", React.createElement(_components.strong, null, \"fat-model\"), \"\\\".\"), \"\\n\", React.createElement(_components.p, null, \"En cas de souci, vous pouvez accéder au code du tutoriel ici :\\r\\n\", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/fat-model\"\n  }, \"fat-model\"), \".\"), \"\\n\", React.createElement(_components.h1, null, React.createElement(InternalPageTitle, null, \" Exercice 1.4 : Refactoring de la RESTfull API pour myMovies \")), \"\\n\", React.createElement(_components.p, null, \"Vous allez faire un nouveau refactor de la RESTful API de \", React.createElement(_components.strong, null, \"myMovies\"), \", afin de restructurer l'architecture de l'application selon l'architecture recommandée, en utilisant un \\\"fat model\\\" pour gérer les opérations sur les films.\"), \"\\n\", React.createElement(_components.p, null, \"Afin de réaliser cet exercice, voici les contraintes d'implémentation :\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, \"Veuillez créer un nouveau projet dans votre repository local et votre web repository (normalement appelé \", React.createElement(_components.strong, null, \"web2\"), \") nommé \", React.createElement(_components.strong, null, \"/exercises/module5/5.2\"), \" sur base d'une copie de votre Exercice 5.1 ou sur base du boilerplate : \", React.createElement(_components.a, {\n    href: \"https://github.com/e-vinci/basic-api-boilerplate\"\n  }, \"basic-api-boilerplate\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"Faites un refactor de votre API gérant les films afin que tout ce qui traite des opérations sur les ressources soit fait au sein du modèle \", React.createElement(_components.strong, null, \"/models/films.json\"), \" ou \", React.createElement(_components.strong, null, \"/models/movies.json\"), \".\"), \"\\n\", React.createElement(_components.li, null, \"Veuillez tester toutes les fonctions de la RESTful API pour la collection de films à l'aide du REST Client en copiant les requêtes développées pour l'Exercice 4.1 (fichier \", React.createElement(_components.strong, null, \"films.http\"), \" du répertoire \", React.createElement(_components.strong, null, \"REST Client\"), \"). Normalement, il n'y a pas de nouvelles requêtes à écrire, il suffit juste de les exécuter.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"Le code de votre application web doit donc se trouver dans votre repository local et votre web repository (normalement appelé \", React.createElement(_components.strong, null, \"web2\"), \") dans le répertoire nommé \", React.createElement(_components.strong, null, \"/exercises/module5/5.2\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"Veuillez faire un \", React.createElement(_components.strong, null, \"commit\"), \" de votre code avec le message suivant : \\\"\", React.createElement(_components.strong, null, \"myMovies : module 5 : API with fat-model\"), \"\\\".\"));\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? React.createElement(MDXLayout, props, React.createElement(_createMdxContent, props)) : _createMdxContent(props);\n}\nexport default MDXContent;\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","import GATSBY_COMPILED_MDX from \"D:/Vinci/code/web2/js-course/frontend/src/mdx-pages/part1/refactoring.fr.mdx\";\nimport React from 'react';\nimport {graphql} from 'gatsby';\nimport {MDXProvider} from '@mdx-js/react';\nimport {Link} from 'gatsby';\nimport MainLayout from '../components/main-layout.js';\nimport Image from '../components/image.js';\nimport Section from '../components/section.js';\nimport Content from '../components/content.js';\nimport Background from '../components/background.js';\nimport SectionHeader from '../components/section-header.js';\nimport SectionFooter from '../components/section-footer.js';\nimport PageHeader from '../components/page-header.js';\nimport {withFrontmatter} from '../components/hoc/hoc.js';\nimport CodeBlock from '../components/codeblock/codeblock.js';\nimport LinkFile from '../components/file/link-file.js';\nimport ScrollableImage from '../components/image/scrollable-image';\nimport PublicProjectsView from '../components/public-projects/public-projects-view';\nimport {AuthenticatedTemplate, UnauthenticatedTemplate} from '@azure/msal-react';\nimport AuthenticatedBlock from '../components/auth/authenticated-block.js';\nimport UnAuthenticatedBlock from '../components/auth/unauthenticated-block.js';\nimport NestedMdxBlock from '../components/mdx/nested-mdx-block.js';\nimport YoutubeImage from '../components/image/youtube-image.js';\nimport InternalPageMenu from '../components/internal-page-menu/internal-page-menu.js';\nimport InternalPageMenuItem from '../components/internal-page-menu/internal-page-menu-item.js';\nimport InternalPageTitle from '../components/internal-page-menu/menu-title.js';\nimport {PathViewer, PathViewerItem} from '../components/path-viewer/path-viewer.js';\nconst shortcodes = {\n  Link,\n  Image,\n  Section,\n  Content,\n  Background,\n  SectionHeader,\n  SectionFooter,\n  PageHeader,\n  CodeBlock,\n  LinkFile,\n  ScrollableImage,\n  PublicProjectsView,\n  AuthenticatedBlock,\n  UnAuthenticatedBlock,\n  NestedMdxBlock,\n  YoutubeImage,\n  InternalPageMenu,\n  InternalPageMenuItem,\n  InternalPageTitle,\n  PathViewer,\n  PathViewerItem\n};\nfunction PageTemplate({data: {mdx, allImages}, children}) {\n  shortcodes.PageHeader = withFrontmatter(PageHeader, mdx?.frontmatter);\n  return React.createElement(MainLayout, Object.assign({}, mdx?.frontmatter ? {\n    frontmatter: mdx.frontmatter\n  } : {}, mdx?.frontmatter?.navbarExtraStyles ? {\n    navbarExtraStyles: mdx.frontmatter.navbarExtraStyles\n  } : {}, mdx?.frontmatter?.headerImage ? {\n    headerImage: mdx.frontmatter.headerImage\n  } : {}, mdx?.frontmatter?.featuredImage ? {\n    featuredImage: mdx.frontmatter.featuredImage\n  } : {}, mdx?.frontmatter?.title ? {\n    pageTitle: mdx.frontmatter.title\n  } : {}, allImages && allImages.length > 0 ? {\n    allImages: allImages\n  } : {}), React.createElement(MDXProvider, {\n    components: shortcodes\n  }, React.createElement(\"div\", {\n    className: mdx?.frontmatter?.autoMargin ? 'page page--auto-margin' : 'page'\n  }, children)));\n}\nexport default function GatsbyMDXWrapper(props) {\n  return React.createElement(PageTemplate, props, React.createElement(GATSBY_COMPILED_MDX, props));\n}\nexport const pageQuery = graphql`\n  query pagesAndImages($slug: String) {\n    mdx(fields: { slug: { eq: $slug } }) {\n      id\n      body\n      fields {\n        slug\n      }\n\n      frontmatter {\n        title\n        date\n        navbarExtraStyles\n        headerImage\n        featuredImage\n        description\n        autoMargin\n      }\n    }\n    allImages: allFile(\n      filter: {\n        sourceInstanceName: { eq: \"images\" }\n        extension: { nin: [\"ico\", \"svg\"] }\n      }\n    ) {\n      edges {\n        node {\n          childImageSharp {\n            gatsbyImageData(\n              quality: 90\n              layout: FULL_WIDTH\n              placeholder: TRACED_SVG\n              tracedSVGOptions: { color: \"green\", background: \"grey\" }\n            )\n          }\n          base\n        }\n      }\n    }\n  }\n`;\n"],"names":["_createMdxContent","props","_components","Object","assign","h1","p","a","br","ul","li","strong","ol","pre","code","_provideComponents","components","PathViewer","PathViewerItem","InternalPageMenu","InternalPageMenuItem","InternalPageTitle","ScrollableImage","_missingMdxReference","React","to","selected","href","name","minWidth","maxWidth","className","wrapper","MDXLayout","id","component","Error","shortcodes","Link","Image","Section","Content","Background","SectionHeader","SectionFooter","PageHeader","CodeBlock","LinkFile","PublicProjectsView","AuthenticatedBlock","UnAuthenticatedBlock","NestedMdxBlock","YoutubeImage","PageTemplate","data","mdx","allImages","children","withFrontmatter","frontmatter","MainLayout","navbarExtraStyles","headerImage","featuredImage","title","pageTitle","length","MDXProvider","autoMargin","GatsbyMDXWrapper","GATSBY_COMPILED_MDX"],"sourceRoot":""}