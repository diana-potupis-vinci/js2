"use strict";(self.webpackChunkmyjscourse=self.webpackChunkmyjscourse||[]).push([[8355],{9802:function(e,t,n){var r=n(7294),a=n(6492),c=n.n(a);t.Z=function(e){var t,n,a=e.className,o=e.isBeingEdited,s=e.onChange,i=e.startContent,u=e.id,d=e.isInline,l=e.children;return o?t=i?c().decode(i):"":l?t=l:i&&(t=i?c().decode(i):""),n=a||"",o&&(n+=" index__card__content__description--is-being-edited"),d&&(n+=" index__card__content__description--is-inline"),r.createElement("div",{className:n,contentEditable:!!o,onInput:function(e){var t={};t[u]=e.currentTarget.textContent,s(t)},suppressContentEditableWarning:!0},t)}},3290:function(e,t,n){n.d(t,{X:function(){return p},a:function(){return l}});var r=n(5861),a=n(4687),c=n.n(a),o=n(7294),s=n(693),i=n(5258),u=n(144),d=o.createContext([{},function(){},{},function(){},{},function(){},{},function(){}]),l=function(e){var t=e.children,n=(0,o.useState)(void 0),r=n[0],a=n[1],c=(0,o.useState)(void 0),s=c[0],i=c[1],u=(0,o.useState)(void 0),l=u[0],p=u[1],m=(0,o.useState)(!1),f=m[0],_=m[1];return o.createElement(d.Provider,{value:[r,a,s,i,l,p,f,_]},t)},p=function(){var e=(0,i.Fp)(),t=e.instance,n=e.accounts,a=(0,o.useContext)(d),l=a[0],p=a[1],m=a[2],f=a[3],_=a[4],v=a[5],x=a[6],h=a[7],E=function(){var e=(0,r.Z)(c().mark((function e(r){var a,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.t)(n,t);case 3:return a=e.sent,e.next=6,(0,s.Z)("projectgroups/"+r,"get",a,void 0);case 6:return o=e.sent,p(o),e.abrupt("return",o);case 11:e.prev=11,e.t0=e.catch(0),console.error("useProjectData:error:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=(0,r.Z)(c().mark((function e(r){var a,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.t)(n,t);case 3:return a=e.sent,e.next=6,(0,s.Z)("users/role/?projectgroupname="+r,"get",a,void 0);case 6:return o=e.sent,f(o),e.abrupt("return",o);case 11:e.prev=11,e.t0=e.catch(0),console.error("useProjectData:updateUserData:error:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=(0,r.Z)(c().mark((function e(r){var a,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.t)(n,t);case 3:return a=e.sent,h(!1),e.next=7,(0,s.Z)("projects/projectgroups/"+r,"get",a,void 0);case 7:return o=e.sent,v(o),h(!0),e.abrupt("return",o);case 13:e.prev=13,e.t0=e.catch(0),console.error("useProjectData:updateProjectDataerror:",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=(0,r.Z)(c().mark((function e(r){var a,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.t)(n,t);case 3:return a=e.sent,e.next=6,(0,s.Z)("projects","post",a,{projectGroupName:r});case 6:return o=e.sent,e.abrupt("return",o);case 10:e.prev=10,e.t0=e.catch(0),console.error("useProjectData:addOneProject:error:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=(0,r.Z)(c().mark((function e(r){var a,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.t)(n,t);case 3:return a=e.sent,e.next=6,(0,s.Z)("projects/"+r._id,"DELETE",a,void 0);case 6:return o=e.sent,e.abrupt("return",o);case 10:e.prev=10,e.t0=e.catch(0),console.error("useProjectData:deleteOneProject:error:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=(0,r.Z)(c().mark((function e(r){var a,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.t)(n,t);case 3:return a=e.sent,e.next=6,(0,s.Z)("projects/"+r._id+"/member","POST",a,void 0);case 6:return o=e.sent,e.abrupt("return",o);case 10:e.prev=10,e.t0=e.catch(0),console.error("useProjectData:addMemberToProject:error:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=(0,r.Z)(c().mark((function e(r){var a,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.t)(n,t);case 3:return a=e.sent,e.next=6,(0,s.Z)("projects/"+r._id+"/member","DELETE",a,void 0);case 6:return o=e.sent,e.abrupt("return",o);case 10:e.prev=10,e.t0=e.catch(0),console.error("useProjectData:deleteMemberFromProject:error:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=(0,r.Z)(c().mark((function e(r,a){var o,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.t)(n,t);case 3:return o=e.sent,e.next=6,(0,s.Z)("projects/"+a,"PATCH",o,r);case 6:return i=e.sent,e.abrupt("return",i);case 10:e.prev=10,e.t0=e.catch(0),console.error("useProjectData:updateProject:error:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}();return Object.assign({},{projectGroupData:l,updateProjectGroupData:E,userData:m,updateUserData:j,projectData:_,updateProjectData:b,addOneProject:g,deleteOneProject:k,addMemberToProject:C,deleteMemberFromProject:w,updateProject:N,isLoaded:x,setIsLoaded:h})}},7008:function(e,t,n){var r=n(3366),a=n(7294),c=n(4854),o=["children","name"];t.Z=function(e){var t=e.children,n=e.name,s=(0,r.Z)(e,o),i=(0,c.useStaticQuery)("3028011774");if(n&&n.toLowerCase().includes("http://")||n&&n.toLowerCase().includes("https://"))return a.createElement("a",Object.assign({href:n},s),t);var u=i.allFile.edges.find((function(e){return e.node.base===n}));return u?a.createElement("a",Object.assign({href:u.node.publicURL},s),t):a.createElement("div",null,a.createElement("h3",{style:{color:"red"}},"The file ",n," does not exist !"),t)}},9896:function(e,t,n){var r=n(7294),a=n(7814),c=n(1436);t.Z=function(){return r.createElement("div",{className:"spinner"},r.createElement("div",{className:"spinner__overlay"}),r.createElement("div",{className:"spinner__animation"},r.createElement(a.G,{icon:c.LM3,className:"fa-3x fa-spin"})))}},8329:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var r=n(7294),a=n(4854),c=n(5583),o=n(5772),s=n(3290),i=n(5861),u=n(4687),d=n.n(u),l=n(9256),p=(n(6492),n(7814)),m=n(1436),f=n(3405),_=n(9802),v=function(e){var t=e.project,n=e.setFilteredContents,a=(0,r.useState)(!1),c=a[0],o=a[1],u=(0,r.useState)(t.isPublic),v=u[0],x=u[1],h=(0,r.useState)({}),E=h[0],j=h[1],b=(0,s.X)(),g=b.deleteOneProject,k=b.updateProjectData,C=b.addMemberToProject,w=b.deleteMemberFromProject,N=b.updateProject,P=b.userData,Z=b.projectGroupData,D=b.projectData,y=function(){var e=(0,i.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t);case 2:return e.next=4,k(t.projectGroupName);case 4:n(void 0);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=(0,i.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(t);case 2:if(e.sent,!k){e.next=7;break}return e.next=6,k(t.projectGroupName);case 6:n(void 0);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=(0,i.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(t);case 2:if(e.sent,!k){e.next=7;break}return e.next=6,k(t.projectGroupName);case 6:n(void 0);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=(0,i.Z)(d().mark((function e(){var r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!E){e.next=10;break}return e.next=3,N(E,t._id);case 3:if(r=e.sent,j({}),o(!1),!r){e.next=10;break}return e.next=9,k(t.projectGroupName);case 9:n(void 0);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(e){j((function(t){return Object.assign({},t,e)}))};return t?r.createElement("div",{className:"index__card"+(c?" index__card--is-being-edited":""),key:t.shortId,id:t.shortId},r.createElement("div",{className:"index__card__header"},r.createElement("span",null,"Projet N° "+t.shortId+" : "),r.createElement(_.Z,{isBeingEdited:c,id:"name",onChange:M,startContent:t.name,isInline:!0})),r.createElement("div",{className:"index__card__description"},P.isAdmin&&r.createElement(p.G,{icon:m.I7k,onClick:y}),(P.isAdmin||t.projectMembers.includes(P.userName)&&"end"!==Z.status)&&!c?r.createElement(p.G,{icon:m.Xcf,onClick:function(){o(!0)}}):"","init"===Z.status&&!D.find((function(e){return e.projectMembers.includes(P.userName)}))&&t.projectMembers.length<Z.maximumProjectMembers&&r.createElement(p.G,{icon:m.FKd,onClick:F}),"init"===Z.status&&t.projectMembers.includes(P.userName)&&r.createElement(p.G,{icon:m.iC0,onClick:G}),c&&r.createElement(p.G,{icon:m.r6l,onClick:O}),c&&r.createElement(p.G,{icon:m.NBC,onClick:function(){o(!1),j({})}})),r.createElement("div",{className:"index__card__content"},void 0!==t.description?r.createElement(r.Fragment,null,r.createElement("div",{className:"index__card__content__title"},"Description"),r.createElement(_.Z,{className:"index__card__content__description",isBeingEdited:c,id:"description",startContent:t.description,onChange:M})):""),r.createElement("div",{className:"index__card__content"},void 0!==t.presentationUrl?r.createElement(r.Fragment,null,r.createElement("div",{className:"index__card__content__title"},"Vidéo de présentation"),r.createElement(_.Z,{className:"index__card__content__description",isBeingEdited:c,id:"presentationUrl",startContent:t.presentationUrl,onChange:M},r.createElement(l.Z,{src:t.presentationUrl}))):""),r.createElement("div",{className:"index__card__content"},void 0!==t.frontendProductionUrl?r.createElement(r.Fragment,null,r.createElement("div",{className:"index__card__content__title"},"URL du site"),r.createElement(_.Z,{className:"index__card__content__description",isBeingEdited:c,id:"frontendProductionUrl",startContent:t.frontendProductionUrl,onChange:M},r.createElement("a",{href:t.frontendProductionUrl,target:"_blank"},t.frontendProductionUrl))):""),r.createElement("div",{className:"index__card__content"},void 0!==t.frontendRepo?r.createElement(r.Fragment,null,r.createElement("div",{className:"index__card__content__title"},"Repo frontend"),r.createElement(_.Z,{className:"index__card__content__description",isBeingEdited:c,id:"frontendRepo",startContent:t.frontendRepo,onChange:M},r.createElement("a",{href:t.frontendRepo,target:"_blank"},t.frontendRepo))):""),r.createElement("div",{className:"index__card__content"},void 0!==t.backendRepo?r.createElement(r.Fragment,null,r.createElement("div",{className:"index__card__content__title"},"Repo backend"),r.createElement(_.Z,{className:"index__card__content__description",isBeingEdited:c,id:"backendRepo",startContent:t.backendRepo,onChange:M},r.createElement("a",{href:t.backendRepo,target:"_blank"},t.backendRepo))):""),r.createElement("div",{className:"index__card__content"},void 0!==t.projectMembers&&t.projectMembers.length>0?r.createElement(r.Fragment,null,r.createElement("div",{className:"index__card__content__title"},"Membres du projet"),r.createElement("div",{className:"index__card__content__description"},t.projectMembers.map((function(e){return(0,f.w)(e)})).join(", "))):""),r.createElement("div",{className:"index__card__content"},void 0!==t.isPublic?r.createElement(r.Fragment,null,r.createElement("div",{className:"index__card__content__title"},"Public ?"),r.createElement("div",{className:"index__card__content__description"},r.createElement("input",{type:"checkbox",checked:v,disabled:!c,onClick:function(e){x(!v),j(Object.assign({},E,{isPublic:!v}))}}))):"")):null},x=function(e){var t=e.projects,n=e.setFilteredContents;return!t||t.length<=0?null:r.createElement(r.Fragment,null,t.map((function(e){return r.createElement(v,{project:e,setFilteredContents:n})})))},h=n(9896),E=n(7008),j=function(e){var t=e.associatedProjectGroupName,n=e.projectDocument,a=(0,s.X)(),c=a.projectGroupData,o=a.updateProjectGroupData,u=a.userData,l=a.updateUserData,p=a.isLoaded,m=a.projectData,f=a.addOneProject,_=a.updateProjectData,v=(0,r.useState)(void 0),j=v[0],b=v[1],g=(0,r.useState)(""),k=(g[0],g[1]),C=function(){var e=(0,i.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(c._id);case 2:return e.next=4,_(c._id);case 4:e.sent,b(void 0);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,r.useEffect)((function(){w()}),[]);var w=function(){var e=(0,i.Z)(d().mark((function e(){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o(t);case 3:return n=e.sent,e.next=6,l(t);case 6:return e.sent,e.next=9,_(n._id);case 9:e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("getData:error",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return r.createElement(r.Fragment,null,!p&&r.createElement(h.Z,null),void 0===c?"":r.createElement("div",{className:"pl-3 pt-3 pb-3 pr-3"},r.createElement("h3",{className:""},"Projets des groupes de ",null==c?void 0:c._id),n&&r.createElement(E.Z,{name:n},"Consignes & template du projet"),r.createElement("div",{className:"index"},r.createElement("input",{type:"text","aria-label":"Search",placeholder:"Filtrez les contenus...",onChange:function(e){var t=e.target.value;k(e.target.value);var n=m.filter((function(e){var n=e.shortId,r=e.name,a=e.description;return r.toLowerCase().includes(t.toLowerCase())||a.toLowerCase().includes(t.toLowerCase())||t.length>0&&parseInt(t)===n}));n&&n.length>0?b(n):b(void 0)},className:"index__search"}),j&&j.length>0?r.createElement(x,{projects:j,setFilteredContents:b}):r.createElement(x,{projects:m,setFilteredContents:b})),void 0!==u&&u.isAdmin?r.createElement("button",{className:"index__button",onClick:C},"Ajouter projet"):""))},b=(0,o.O)((function(){var e=(0,a.useStaticQuery)("641954533"),t=null==e?void 0:e.site.siteMetadata,n=t.defaultAssociatedProjectGroupName,o=t.projectDocument;return r.createElement(s.a,null,r.createElement(c.Z,null,r.createElement(j,{associatedProjectGroupName:n,projectDocument:o})))}))},693:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(5861),a=n(4687),c=n.n(a);function o(e,t,n,r){return s.apply(this,arguments)}function s(){return(s=(0,r.Z)(c().mark((function e(t,n,r,a){var o,s,i,u,d,l,p;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n="get"),o=new Headers,(s={}).method=n,r&&(i="Bearer "+r,o.append("Authorization",i)),a&&(s.body=JSON.stringify(a)),"post"!==n.toLowerCase()&&"patch"!==n.toLowerCase()&&"put"!==n.toLowerCase()||o.append("Content-Type","application/json"),s.headers=o,u="https://e-vinci-course-api.azurewebsites.net/api/"+t,e.prev=9,e.next=12,fetch(u,s);case 12:if((d=e.sent).ok){e.next=22;break}return l=" Error code : "+d.status+" : "+d.statusText+"/nMessage : ",e.next=17,d.text();case 17:throw p=e.sent,l+=p,console.error("fetch() error",l),l.search("expired"),new Error(l);case 22:return e.next=24,d.json();case 24:return e.abrupt("return",e.sent);case 27:throw e.prev=27,e.t0=e.catch(9),e.t0;case 30:case"end":return e.stop()}}),e,null,[[9,27]])})))).apply(this,arguments)}},144:function(e,t,n){n.d(t,{t:function(){return s}});var r=n(5861),a=n(4687),c=n.n(a),o=n(3927);function s(e,t){return i.apply(this,arguments)}function i(){return(i=(0,r.Z)(c().mark((function e(t,n){var r,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=16;break}return r={scopes:["openid"],account:t[0]},e.prev=2,e.next=5,n.acquireTokenSilent(r);case 5:return a=e.sent,e.abrupt("return",a.idToken);case 9:if(e.prev=9,e.t0=e.catch(2),!(e.t0 instanceof o.Yo)){e.next=16;break}return e.next=14,n.acquireTokenRedirect(r);case 14:return s=e.sent,e.abrupt("return",s.idToken);case 16:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}},3405:function(e,t,n){n.d(t,{w:function(){return r}});var r=function(e){var t=e.substring(0,e.indexOf("@")),n=t.substring(0,t.indexOf(".")),r=t.substring(t.indexOf(".")+1);return n=n.charAt(0).toUpperCase()+n.slice(1),(r=r.charAt(0).toUpperCase()+r.slice(1)).indexOf(".")>=0&&(r=(r=r.substring(r.indexOf(".")+1)).charAt(0).toUpperCase()+r.slice(1)),n+" "+r}}}]);
//# sourceMappingURL=component---src-pages-project-page-js-600d4bb5881ff48e9ce7.js.map