"use strict";(self.webpackChunkmyjscourse=self.webpackChunkmyjscourse||[]).push([[993],{2350:function(e,n,t){t.r(n),t.d(n,{default:function(){return R}});var r=t(3905),l=t(7294);function o(e){const n=Object.assign({h1:"h1",p:"p",br:"br",ul:"ul",li:"li",strong:"strong",h2:"h2",a:"a",h3:"h3",pre:"pre",code:"code",ol:"ol",em:"em",h4:"h4"},(0,r.ah)(),e.components),{PathViewer:t,PathViewerItem:o,InternalPageMenu:a,InternalPageMenuItem:s,InternalPageTitle:i,ScrollableImage:c}=n;return a||u("InternalPageMenu",!0),s||u("InternalPageMenuItem",!0),i||u("InternalPageTitle",!0),t||u("PathViewer",!0),o||u("PathViewerItem",!0),c||u("ScrollableImage",!0),l.createElement(l.Fragment,null,l.createElement(t,null,l.createElement(o,{to:"/"}," web2course "),l.createElement(o,{selected:!0}," Partie 3 ")),"\n",l.createElement(n.h1,null,"Partie 3 : D√©ploiement d'applications web"),"\n",l.createElement(a,null,l.createElement(s,null," Comment d√©ployer une application sur le web ? "),l.createElement(s,null," D√©ploiement du frontend sur GitHub Pages "),l.createElement(s,null," D√©ploiement d'une API sur Azure "),l.createElement(s,null," D√©ploiement d'une API sur Heroku "),l.createElement(s,null," D√©ploiement d'une API sur d'autres providers gratuits "),l.createElement(s,null," D√©ploiement d'une base de donn√©es "),l.createElement(s,null," Exercice 3.1 : D√©ploiement de myMovies sur le cloud ")),"\n",l.createElement(n.h1,null,l.createElement(i,null," Comment d√©ployer une application sur le web ? ")),"\n",l.createElement(n.p,null,"Il existe √©norm√©ment de possibilit√©s pour d√©ployer une application web, pour la rendre disponible sur le web.",l.createElement(n.br),"\n","Pour certains, comme des administrateurs r√©seaux ou des responsables de l'infrastructure informatique, il s'agit d'un m√©tier √† part enti√®re.",l.createElement(n.br),"\n","Mais de plus en plus, avec l'avanc√©e des services sur le cloud, les d√©veloppeurs prennent un r√¥le important dans le d√©ploiement des applications."),"\n",l.createElement(n.p,null,"Voici un diagramme qui exprime bien les diff√©rentes fa√ßons de d√©ployer une applications :"),"\n",l.createElement(c,{name:"deployment.png",minWidth:"600px",maxWidth:"881x"}),"\n",l.createElement("figcaption",null,"Diff√©rents types de d√©ploiement d'application [R.65]"),"\n",l.createElement(n.p,null,"Sur ce diagramme, tout √† gauche, nous sommes enti√®rement responsable de la mise √† disposition de l'infrastructure. Il faut donc d'√©normes connaissances r√©seaux, au niveau OS, afin de mettre √† disposition des serveurs, les s√©curiser,..."),"\n",l.createElement(n.p,null,"Lorsqu'on va vers la droite du diagramme, on passe vers la d√©mat√©rialisation des services, vers le cloud, qui offre principalement trois types de services :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,l.createElement(n.strong,null,"IaaS")," ou ",l.createElement(n.strong,null,"Infrastructure as a Service")," : nous recevons toute l'infrastructure, nous devons encore nous occuper du reste, la gestion d'un OS (Linux, Windows...), les bases de donn√©es, les applications et leurs donn√©es ; Amazon Web Services, Microsoft Azure, Google Cloud, OVHcloud offrent ce genre de services..."),"\n",l.createElement(n.li,null,l.createElement(n.strong,null,"PaaS")," ou ",l.createElement(n.strong,null,"Platform as a Service")," : nous recevons tout ce qu'il faut pour simplement d√©velopper des applications ; heroku, Amazon Web Services, Microsoft Azure, Google Cloud, OVHcloud offrent ce genre de services..."),"\n",l.createElement(n.li,null,l.createElement(n.strong,null,"SaaS")," ou ",l.createElement(n.strong,null,"Software as a Service")," : nous recevons des applications pr√™tes √† √™tre utilis√©es ; office 365 est un exemple, Github en est un autre."),"\n"),"\n",l.createElement(n.p,null,"Lorsque nous allons d√©ployer nos RESTful API, nous allons donc tr√®s souvent utiliser un ",l.createElement(n.strong,null,"PaaS"),". En effet, voici les √©tapes principales pour le d√©ploiement :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"cr√©er et configurer le type d'application que nous allons d√©ployer avec les outils offerts par le provider : indiquer que nous souhaitons d√©velopper une application ",l.createElement(n.strong,null,"Node.js")," ;"),"\n",l.createElement(n.li,null,"cr√©er un git repository pour chaque projet et faire un push des sources de notre application via les outils offerts par le provider ;"),"\n",l.createElement(n.li,null,"build et d√©ploiement automatique de l'application seront faits en utilisant les outils du provider, via un service accessible par une URL de d√©veloppement offerte par le provider."),"\n"),"\n",l.createElement(n.p,null,"Chaque provider va fournir une recette de cuisine pour pouvoir d√©ployer une application. Il est donc important de trouver la bonne documentation d√©crivant toutes les √©tapes."),"\n",l.createElement(n.p,null,"Pour d√©ployer le frontend d'une SPA, les √©tapes principales sont similaires au d√©ploiement d'une RESTful API. N√©anmoins, il existe des outils qui permettent de faciliter le d√©ploiement du frontend d'une SPA car ce sont juste des assets √† partager sur le web, il n'y a pas d'intelligence √† fournir c√¥t√© serveur pour g√©n√©rer du contenu.",l.createElement(n.br),"\n","Du coup, on peut utiliser des CDN (Content Delivery Network), des groupes de serveur qui travaillent ensemble pour fournir nos assets de mani√®re extra rapide sur Internet.",l.createElement(n.br),"\n","Comme Github offre ce service via ",l.createElement(n.strong,null,"Github Pages"),", que c'est gratuit si vous acceptez que votre code source soit publique, c'est un service id√©al pour notre frontend.",l.createElement(n.br),"\n","Il faut juste faire attention que votre frontend n'utilise pas de proxy pour contacter votre RESTful API, il doit le faire directement. L'API devra donc g√©rer les CORS pour autoriser l'URL associ√©e √† votre frontend !"),"\n",l.createElement(n.p,null,"Pour d√©ployer nos RESTful API, le facteur principal que nous souhaitons mettre en avant dans ce cours, c'est de b√©n√©ficier d'un service gratuit. Comme nous √©tudions le JS, nous consid√©rons que nous n'avons pas encore besoin d'un h√©bergement offrant de grandes performances. Nous souhaitons juste quelque chose qui nous permette de tester sur le web nos applications et de les partager avec quelques dizaines de personnes. Pour le frontend, via ",l.createElement(n.strong,null,"Github Pages"),", nous avons trouv√© un service de qualit√©, partageable avec des milliers de personnes. Par contre, pour h√©berger une API, les services gratuits tendent √† dispara√Ætre.",l.createElement(n.br),"\n","Avant l'automne 2022, ",l.createElement(n.strong,null,"Heroku"),' fournissait un service gratuit qui √©tait parfait pour nos API. Mais ce service va dispara√Ætre. Il y a un petit espoir qu\'Heroku mette un "Student Program" en place, mais rien de s√ªr.'),"\n",l.createElement(n.p,null,"Du coup, pour construire une API, il semblerait qu'il ne reste plus que des services qui soient que temporairement gratuits. Le souci avec ce genre de services, c'est que m√™me si c'est gratuit, on vous demande souvent votre carte de cr√©dit, afin de \"v√©rifier que vous n'√™tes pas un robot\" ü§ñ !"),"\n",l.createElement(n.p,null,"Nous avons donc tent√© de s√©lectionner un service gratuit, temporaire, qui ne demande pas de carte de cr√©dit."),"\n",l.createElement(n.h1,null,l.createElement(i,null," D√©ploiement du frontend sur GitHub Pages ")),"\n",l.createElement(n.h2,null,"Informations g√©n√©rales"),"\n",l.createElement(n.p,null,"Si vous n'utilisez pas de proxy dans votre frontend mais que vous faites des requ√™tes vers votre RESTful API en utilisant directement son nom de domaine, il est possible d'utiliser ",l.createElement(n.strong,null,"Github Pages"),"."),"\n",l.createElement(n.p,null,"Votre RESTful API doit donc elle aussi √™tre d√©ploy√©e et vous devez utiliser son URL pour tous les fetch que vous faites."),"\n",l.createElement(n.p,null,"Vous trouverez une recette de cuisine pour d√©ployer un frontend sur ",l.createElement(n.a,{href:"https://pages.github.com/"},"GitHub Pages"),". N√©anmoins, cette recette est tr√®s minimaliste et ne donne pas d'explication sur toutes les choses qu'il y a √† faire pour d√©ployer une SPA qui contient un router."),"\n",l.createElement(n.h2,null,"D√©ploiment d'un frontend bas√© sur Webpack sur GitHub Pages"),"\n",l.createElement(n.p,null,"Comme √ßa n'est pas quelque chose de si simple, nous vous offrons la recette de cuisine pour d√©ployer un frontend qui suit l'architecture propos√©e dans ce cours."),"\n",l.createElement(n.h3,null,"1. Cr√©ation d'un web repo"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Dans un premier temps, vous devez d√©cider si vous souhaitez d√©ployer votre page en tant que :","\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,l.createElement(n.strong,null,"user")," ou ",l.createElement(n.strong,null,"organization site")," : votre nom de repo doit √™tre votre ",l.createElement(n.strong,null,"username")," ou le ",l.createElement(n.strong,null,"nom de votre organisation")," sur GitHub. L'URL de votre frontend sur GitHub Pages sera : \"",l.createElement(n.strong,null,"https://[username ou orgnanization-name].github.io"),"\". Dans ce cas-l√†, vous ne pouvez avoir qu'un seul site d√©ploy√© sur ce nom de domaine."),"\n",l.createElement(n.li,null,l.createElement(n.strong,null,"project site")," : vous pouvez donner le nom que vous souhaitez √† votre repo (autre que votre ",l.createElement(n.strong,null,"username")," ou le ",l.createElement(n.strong,null,"nom de votre organisation"),"). L'URL de votre frontend sera : \"",l.createElement(n.strong,null,"https://[username ou orgnanization-name].github.io/repo-name-for-your-frontend"),'".'),"\n"),"\n"),"\n",l.createElement(n.li,null,"Cr√©ez un nouveau web repo ",l.createElement(n.strong,null,"vide")," et ",l.createElement(n.strong,null,"publique")," sur GitHub Pages en lui donnant le nom que vous avez choisi.",l.createElement(n.br),"\n","‚ö° Attention √† ne pas cr√©er de fichier README √† la cr√©ation de votre web repo !"),"\n"),"\n",l.createElement(n.h3,null,"2. Cr√©ation de votre repo local pour votre frontend"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Votre frontend doit avoir √©t√© initialis√© sur base du boilerplate ",l.createElement(n.a,{href:"https://github.com/e-vinci/js-frontend-boilerplate"},"js-frontend-boilerplate")," ou ",l.createElement(n.a,{href:"https://github.com/e-vinci/js-frontend-boilerplate"},"js-phaser-boilerplate"),".\r\nAttention √† ne pas mettre votre frontend au sein d'un repo git existant. N'h√©sitez pas √† cr√©er une copie de votre frontend √† un autre endroit si celui-ci est d√©j√† contenu dans un web repo."),"\n",l.createElement(n.li,null,"Effacez le r√©pertoire ",l.createElement(n.strong,null,".git")," si vous avez cl√¥n√© le boilerplate."),"\n",l.createElement(n.li,null,"Tapez ces commandes pour initialiser votre repo local et le synchroniser avec votre web repo :","\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-shell"},'git init\r\ngit add .\r\ngit commit -m "init"\r\ngit remote add origin https://url-to-your-web-repo.git\r\ngit branch -M main\r\ngit push -u origin main\n')),"\n"),"\n"),"\n",l.createElement(n.h3,null,"3. Configuration du pr√©fixe en cas de project site"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Si vous avez choisi de cr√©er un ",l.createElement(n.strong,null,"user")," ou un ",l.createElement(n.strong,null,"organization site"),", vous pouvez passer au point suivant, √† la configuration de l'URL de l'API."),"\n",l.createElement(n.li,null,"Si vous avez choisi de cr√©er un ",l.createElement(n.strong,null,"project site")," sur GitHub (plut√¥t qu'un ",l.createElement(n.strong,null,"user")," ou ",l.createElement(n.strong,null,"organization site"),'), vous devez configurer le pr√©fixe qui sera √† prendre en compte lors du d√©ploiement du frontend. Par exemple, si votre web repo se nomme "',l.createElement(n.strong,null,"my-super-frontend"),'", vous devez indiquer ce pr√©fixe au sein de ',l.createElement(n.strong,null,"webpack.config")," :"),"\n"),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-js"},"const PRODUCTION_PATH_PREFIX = '/my-super-frontend/';\n")),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"NB : Apr√®s cette configuration, tous les appels √† votre site d√©ploy√© sur le cloud seront fonctionnels, le router fera le travail d'offrir la bonne page. Ainsi, m√™me si l'utilisateur acc√®de √† ",l.createElement(n.strong,null,"https://[username].github.io/my-super-frontend/login"),", le router ira chercher la route correspondant au chemin ",l.createElement(n.strong,null,"/login")," et non pas √† la route ",l.createElement(n.strong,null,"/my-super-frontend/login")," (qui n'existe pas et ne devrait pas √™tre configur√©e ; en effet il devrait y avoir une route pour ",l.createElement(n.strong,null,"/login")," dans ",l.createElement(n.strong,null,"/src/Components/Router/routes.js"),") !"),"\n"),"\n",l.createElement(n.h3,null,"4. Configuration de l'URL de base vers votre API et utilisation de cette URL"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Cette partie n'est pas directement li√©e √† GitHub Pages. N√©anmoins, elle doit √™tre r√©alis√©e si l'on souhaite que le frontend puisse interroger les op√©rations d'une RESTful API d√©velopp√©e par nos soins."),"\n",l.createElement(n.li,null,"Dans ",l.createElement(n.strong,null,"webpack.config"),", veuillez configurer l'URL de votre API en fonction du ",l.createElement(n.strong,null,"build mode")," :","\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,l.createElement(n.strong,null,l.createElement(n.code,null,"DEVELOPMENT_API_BASE_URL"))," pour un build de d√©veloppement : laissez ",l.createElement(n.strong,null,"'/api'")," si vous souhaitez utiliser le proxy pour appeler votre api ou ",l.createElement(n.strong,null,l.createElement(n.a,{href:"http://localhost:3000"},"http://localhost:3000"))," si vous pr√©f√©rez appeler directement l'API. Dans ce dernier cas, vous devez avoir autoris√© l'origine de votre frontend (",l.createElement(n.strong,null,l.createElement(n.a,{href:"http://localhost:8080"},"http://localhost:8080")),") via les CORS."),"\n",l.createElement(n.li,null,l.createElement(n.strong,null,l.createElement(n.code,null,"PRODUCTION_API_BASE_URL"))," pour un build de production : donnez l'URL o√π votre application sera d√©ploy√©e, comme par exemple : ",l.createElement(n.strong,null,"'",l.createElement(n.a,{href:"https://your-app-name.azurewebsites.net"},"https://your-app-name.azurewebsites.net"),"'"),"."),"\n"),"\n"),"\n",l.createElement(n.li,null,"Lors du build de votre application par Webpack, en fonction des valeurs que vous avez donn√©es √† ",l.createElement(n.strong,null,l.createElement(n.code,null,"DEVELOPMENT_API_BASE_URL"))," et ",l.createElement(n.strong,null,l.createElement(n.code,null,"PRODUCTION_API_BASE_URL")),", ",l.createElement(n.strong,null,l.createElement(n.code,null,"process.env.API_BASE_URL"))," sera remplac√©e par l'URL de base vers votre API gr√¢ce au code du boilerplate !"),"\n",l.createElement(n.li,null,"Ainsi, pour faire vos appels vers vos API, utilisez la variable globale ",l.createElement(n.strong,null,l.createElement(n.code,null,"process.env.API_BASE_URL"))," au sein de vos ",l.createElement(n.strong,null,"fetch"),". Par exemple :","\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-js"},"fetch(`${process.env.API_BASE_URL}/auths/login`, options);\n")),"\n"),"\n",l.createElement(n.li,null,"NB : Lorsque vous lancerez la commande ",l.createElement(n.strong,null,"npm start"),", c'est ",l.createElement(n.strong,null,l.createElement(n.code,null,"DEVELOPMENT_API_BASE_URL"))," qui sera utilis√©e pour appeler votre API gr√¢ce √† la variable globale ",l.createElement(n.strong,null,l.createElement(n.code,null,"process.env.API_BASE_URL")),".",l.createElement(n.br),"\n","Lorsque vous lancerez la commande ",l.createElement(n.strong,null,"npm run deploy"),", c'est ",l.createElement(n.strong,null,l.createElement(n.code,null,"DEVELOPMENT_API_BASE_URL"))," qui sera utilis√©e pour appeler votre API gr√¢ce √† la variable globale ",l.createElement(n.strong,null,l.createElement(n.code,null,"process.env.API_BASE_URL")),"."),"\n"),"\n",l.createElement(n.h3,null,"5. D√©ploiement du frontend sur GitHub Pages"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Une fois que tout est configur√© au niveau de votre repo local (et donc du code de votre frontend), il ne reste plus qu'√† lancer le build de production du frontend et le d√©ploiement. Tout cela est offert par le boilerplate en tapant la commande :"),"\n"),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-shell"},"npm run deploy\n")),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"La librairie ",l.createElement(n.strong,null,"gh-pages")," permet de faire un ",l.createElement(n.strong,null,"push")," d'un snapshot du contenu du build de production (se trouvant dans ",l.createElement(n.strong,null,"/dist/"),") vers la branche ",l.createElement(n.strong,null,"gh-pages")," de votre web repo."),"\n",l.createElement(n.li,null,'Si GitHub Pages est configur√© correctement au niveau de votre web repo, quelques secondes ou minutes apr√®s que "',l.createElement(n.strong,null,"Published"),"\" ait √©t√© affich√© dans votre terminal, votre frontend sera disponible sur le cloud via l'URL : ",l.createElement(n.strong,null,"https://[username].github.io")," ou ",l.createElement(n.strong,null,"https://[username].github.io/repo-name-for-your-frontend"),"."),"\n"),"\n",l.createElement(n.h3,null,"6. Configuration de GitHub Pages sur votre web repo"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Acc√©dez √† l'URL de votre web repo sur ",l.createElement(n.strong,null,l.createElement(n.a,{href:"https://github.com/"},"https://github.com/")),"."),"\n",l.createElement(n.li,null,"Cliquez sur ",l.createElement(n.strong,null,"Settings"),", puis sur ",l.createElement(n.strong,null,"Pages"),"."),"\n",l.createElement(n.li,null,"Assurez-vous que :","\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"la ",l.createElement(n.strong,null,"Source")," soit : ",l.createElement(n.strong,null,"Deploy from a branch"),"."),"\n",l.createElement(n.li,null,"la ",l.createElement(n.strong,null,"Branch")," soit : ",l.createElement(n.strong,null,"gh-pages"),"."),"\n"),"\n"),"\n",l.createElement(n.li,null,"Via ",l.createElement(n.strong,null,"Settings"),", puis ",l.createElement(n.strong,null,"Pages"),", vous avez l'URL de votre frontend qui vous est donn√©e et vous pouvez cliquer sur ",l.createElement(n.strong,null,"Visit site")," (pour acc√©der √† votre site)."),"\n",l.createElement(n.li,null,"√† la racine de votre web repo, vous pouvez visualiser tous les builds qui ont √©t√© tent√©s sur GitHub Pages ; √† droite de la page, il y √† une section ",l.createElement(n.strong,null,"Environments")," et un lien ",l.createElement(n.strong,null,"github-pages")," : cliquez sur ce lien et vous verrez l'historique des d√©ploiements de votre frontend sur GitHub Pages."),"\n"),"\n",l.createElement(n.h3,null,"Que se passe-t-il en cas de refresh d'une page offerte par GitHub Pages ?"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Imaginez que l'utilisateur fasse un refresh √† l'URL ",l.createElement(n.strong,null,"https://[username].github.io/my-super-frontend/login"),". GitHub Pages est juste un CDN, un serveur de fichiers statiques. Il n'y a pas de fichier qui correspond √† cette URL ! D√®s lors, sans ce boilerplate, vous recevriez une ",l.createElement(n.strong,null,"erreur 404")," üò® !"),"\n",l.createElement(n.li,null,"Lors du build, le boilerplate du cours (",l.createElement(n.a,{href:"https://github.com/e-vinci/js-frontend-boilerplate"},"js-frontend-boilerplate")," ou ",l.createElement(n.a,{href:"https://github.com/e-vinci/js-frontend-boilerplate"},"js-phaser-boilerplate"),") cr√©e un fichier ",l.createElement(n.strong,null,"404.html")," qui est identique √† ",l.createElement(n.strong,null,"index.html"),". Ainsi, lorsqu'une ressource n'existe pas au niveau du CDN, GitHub Page renverra le contenu de ",l.createElement(n.strong,null,"404.html"),", et notre SPA sera enti√®rement fonctionnelle, m√™me en cas de refresh for√ßant au serveur de nous renvoyer une page üòÖ !",l.createElement(n.br),"\n","Car dans le cadre d'une SPA, c'est le JS, via le router, qui permet d'afficher la page associ√©e √† ",l.createElement(n.strong,null,"/login"),", une fois que tout le frontend a √©t√© charg√© suite √† l'appel d'",l.createElement(n.strong,null,"index.html"),". Il n'y a pas de page ",l.createElement(n.strong,null,"Login.html")," qui existe au niveau du serveur !"),"\n"),"\n",l.createElement(n.h1,null,l.createElement(i,null," D√©ploiement d'une API sur Azure ")),"\n",l.createElement(n.h2,null,"Informations g√©n√©rales"),"\n",l.createElement(n.p,null,l.createElement(n.strong,null,"Azure App Service")," offre un ",l.createElement(n.strong,null,"PaaS"),". Il est ais√© d'y d√©ployer une application Node.js."),"\n",l.createElement(n.p,null,"Voici la documentation pour cr√©er une app : ",l.createElement(n.a,{href:"https://docs.microsoft.com/en-us/azure/app-service/quickstart-nodejs?tabs=linux&pivots=development-environment-vscode"},"Create a Node.js web app in Azure"),"."),"\n",l.createElement(n.p,null,"Vous aurez le droit √† 60 minutes de processing gratuites par jour, apr√®s quoi votre app renvoie un status code 403. Votre app n'est pas toujours active, mais il est pas √©vident d'estimer si vous tiendrez toute une journ√©e sans erreur 403."),"\n",l.createElement(n.p,null,"Actuellement, si vous √™tes √©tudiant, vous pouvez b√©n√©ficier de 100$ de cr√©dit par an et vous n'avez pas besoin de carte de cr√©dit ! En suivant le tutoriel propos√© par Microsoft, vous vous rendrez sur ",l.createElement(n.a,{href:"https://azure.microsoft.com/en-in/free/students/"},"free with Azure for Student")," et utiliserez par la suite ",l.createElement(n.strong,null,"Azure App Service"),"."),"\n",l.createElement(n.p,null,"Si vous n'√™tes plus √©tudiant, vous pouvez b√©n√©ficier de services gratuits, certains toujours gratuits, d'autres pendant 12 mois, avec 200$ de cr√©dit pendant 30 jours. Malheureusement il faut une carte de cr√©dit pour vous faire autoriser..."),"\n",l.createElement(n.p,null,"N'h√©sitez pas √† consulter la ",l.createElement(n.a,{href:"https://docs.microsoft.com/en-us/azure/app-service/"},"documentation d'App Service")," et de jeter un oeil aux formules tarifaires : ",l.createElement(n.a,{href:"https://azure.microsoft.com/en-us/pricing/details/app-service/linux/"},"App Service pricing"),"."),"\n",l.createElement(n.h2,null,"En r√©sum√© pour d√©ployer votre API via VS Code"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"N'oubliez pas que votre API va se trouver sur un serveur externe accessible via une URL. Votre frontend lui se trouvera sur une autre URL, probablement que vous l'installerez sur ",l.createElement(n.strong,null,"GitHub Pages")," pour obtenir un tr√®s bon service gratuit. Dans ce cas-ci, pour que votre Frontend puisse dialoguer avec votre API, comme ",l.createElement(n.strong,null,"GitHub Pages")," n'offre pas de proxy, il vous faudra autoriser des origines au niveau de votre API. Comme vu au Module 4 de ce cours, pensez donc √† utiliser le middleware cors au niveau de votre API et autoriser au moins deux origines :","\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"l'URL de votre frontend lors du d√©veloppement. Par exemple : \"",l.createElement(n.strong,null,l.createElement(n.a,{href:"http://localhost:8080"},"http://localhost:8080")),'";'),"\n",l.createElement(n.li,null,"l'URL de votre frontend lors de sa mise en production, son URL sur le cloud. Par exemple si le frontend sera d√©ploy√© sur ",l.createElement(n.strong,null,"GitHub Pages"),' : "',l.createElement(n.strong,null,"https://[username ou orgnanization-name].github.io"),'" (pour un user ou organization site) ou "',l.createElement(n.strong,null,"https://[username ou orgnanization-name].github.io/repo-name-for-your-frontend"),'" (pour un project site).'),"\n"),"\n"),"\n",l.createElement(n.li,null,"Il est important d'ouvrir VS Code sur la racine du projet que vous souhaitez d√©ployer : ",l.createElement(n.strong,null,"File"),", ",l.createElement(n.strong,null,"Open Folder...")," et de s√©lectionner le dossier racine de votre API (le dossier contenant ",l.createElement(n.strong,null,"package.json"),")."),"\n",l.createElement(n.li,null,"Apr√®s avoir s√©lectionn√© ",l.createElement(n.strong,null,"Azure")," dans VS Code (clic sur le logo d'Azure), clic droit sur ",l.createElement(n.strong,null,"App Services"),", ",l.createElement(n.strong,null,"Create New Web App..."),"."),"\n",l.createElement(n.li,null,"Attention de choisir la formule gratuite lorsque vous suivrez la proc√©dure, en indiquant le tarif ",l.createElement(n.strong,null,"F1"),"."),"\n",l.createElement(n.li,null,"Choisissez aussi une version de Node inf√©rieure √† 18 : ",l.createElement(n.strong,null,"Node 16 LTS")," est tr√®s bien."),"\n",l.createElement(n.li,null,"Donnez un nom qui n'existe pas √† votre API."),"\n",l.createElement(n.li,null,"Pour d√©ployer votre API, clic droit sur l'app qui a √©t√© cr√©√©e et qui porte le nom que vous lui avez donn√© : ",l.createElement(n.strong,null,"Deploy to Web App..."),", s√©lection du folder √† d√©ployer (par d√©faut c'est OK si vous avez bien ouvert VS Code √† la racine du code de votre API), puis clic sur ",l.createElement(n.strong,null,"Deploy")),"\n",l.createElement(n.li,null,'Acceptez la question "Always deploy the workspace "nom-du-folder-de-votre-api" to "nom-de-votre-app-pour-votre-api" : ',l.createElement(n.strong,null,"Yes"),"."),"\n",l.createElement(n.li,null,"Une fois d√©ploy√©, pour acc√©der √† votre API via le browser : clic droit sur le nom de votre app dans VS Code (en dessous de App Services), ",l.createElement(n.strong,null,"Browse Website"),"."),"\n",l.createElement(n.li,null,"L'URL de votre API est : ",l.createElement(n.strong,null,"https://[nom-de-votre-app-pour-votre-api].azurewebsites.net")),"\n"),"\n",l.createElement(n.h1,null,l.createElement(i,null," D√©ploiement d'une API sur Heroku ")),"\n",l.createElement(n.h2,null,"Introduction"),"\n",l.createElement(n.p,null,'D√®s le 28 novembre 2022, les "free Heroku Dynos" ne seront plus disponibles.',l.createElement(n.br),"\n","Il y a malgr√© tout un espoir que pour les √©tudiants, un programme soit mis √† disposition. L'info sera rendue disponible en fin septembre : ",l.createElement(n.a,{href:"https://blog.heroku.com/next-chapter"},'Heroku"s Next Chapter'),"."),"\n",l.createElement(n.h2,null,'Proc√©dure "maison"'),"\n",l.createElement(n.p,null,"Sur le site d'Heroku, il existe beaucoup de documentation pour apprendre √† d√©ployer √† l'aide de leurs outils."),"\n",l.createElement(n.p,null,"Comme il n'est pas si facile de s'y retrouver, voici ci-dessous un r√©sum√© des √©tapes importantes via une proc√©dure \"maison\"."),"\n",l.createElement(n.p,null,l.createElement(n.strong,null,"Pr√©paration de votre application")),"\n",l.createElement(n.ol,null,"\n",l.createElement(n.li,null,"Utilisez les bonnes variables d'environnement dans Node.js en v√©rifiant que ",l.createElement(n.strong,null,l.createElement(n.code,null,"process.env.PORT"))," est bien √©crit dans ",l.createElement(n.code,null,"/bin/www"),".",l.createElement(n.br),"\n",l.createElement(n.em,null,"La variable d'environnement ",l.createElement(n.code,null,"PORT"),", accessible sous Node via ",l.createElement(n.code,null,"process.env.PORT")," , est allou√© par Heroku lors du d√©marrage de l'application. Pour ",l.createElement(n.code,null,"HOST"),", le plus simple est de ne pas en avoir : votre serveur √©coute sur toutes les IP. C'est ce qui est fait par d√©faut lorsqu'une application Express est g√©n√©r√©e.")),"\n",l.createElement(n.li,null,"V√©rifiez ",l.createElement(n.strong,null,l.createElement(n.code,null,"package.json")),' : Le script "start" sera ce que heroku lance en 1er.',l.createElement(n.br),"\n",l.createElement(n.em,null,"Il n'y a normalement rien √† faire, ",l.createElement(n.code,null,"package.json"),' doit contenir pour "start" :')),"\n"),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-json"},'"scripts": {\r\n"start": "node ./bin/www" },\n')),"\n",l.createElement(n.ol,{start:"3"},"\n",l.createElement(n.li,null,"Cr√©ez un nouvelle app sur Heroku en vous rendant sur ",l.createElement(n.a,{href:"https://www.heroku.com/"},"HEROKU"),", ",l.createElement(n.strong,null,"Sign up"),' puis via le "Heroku dashboard" : ',l.createElement(n.strong,null,"New"),", ",l.createElement(n.strong,null,"Create"),", ",l.createElement(n.strong,null,"New app"),".",l.createElement(n.br),"\n",l.createElement(n.em,null,"Donnez un nom √† votre Heroku app qui soit associ√© √† votre API.")),"\n",l.createElement(n.li,null,'Installez le heroku buildpack pour node ; via le "Heroku dashboard", ',l.createElement(n.strong,null,"Settings"),", ",l.createElement(n.strong,null,"Add buildpacks"),", ",l.createElement(n.strong,null,"nodejs"),".",l.createElement(n.br),"\n",l.createElement(n.em,null,'L\'URL g√©n√©r√©e pour le buildpack est "heroku/nodejs".')),"\n",l.createElement(n.li,null,"Configurez vos variables d'environnement au sein d'Heroku.",l.createElement(n.br),"\n",l.createElement(n.em,null,"Si vous n'avez pas de secrets au niveau de votre API, pas de base de donn√©es ou autres services, vous n'avez rien √† faire √† cette √©tape-ci. Sinon, voici la documentation : ",l.createElement(n.a,{href:"https://devcenter.heroku.com/articles/config-vars"},"Configuration and Config Vars"),".")),"\n"),"\n",l.createElement(n.p,null,l.createElement(n.strong,null,"Push de votre application sur Heroku √† l'aide de votre git local")),"\n",l.createElement(n.ol,null,"\n",l.createElement(n.li,null,"Allez dans le repo de votre application"),"\n",l.createElement(n.li,null,"Ajoutez une remote vers le repo de votre Heroku app :"),"\n"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Option a) avec heroku CLI :"),"\n"),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-bash"},"npm install -g heroku\r\nheroku login\r\nheroku git:remote -a [your_app_name]\n")),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Option b) sans heroku CLI, directement avec Git :"),"\n"),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-bash"},"git remote add heroku https://git.heroku.com/[your_app_name].git\n")),"\n",l.createElement(n.ol,{start:"3"},"\n",l.createElement(n.li,null,"Faites un push de la branche en cours vers le master sur Heroku :"),"\n"),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-bash"},"git push heroku master\n")),"\n",l.createElement(n.p,null,l.createElement(n.em,null,"Si votre branche en cours n'est pas le master :")),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-bash"},"git push heroku [branche_en_cours]:master [-f]\n")),"\n",l.createElement(n.p,null,l.createElement(n.em,null,"-f si la branche locale est fort diff√©rente du contenu sur Heroku.")),"\n",l.createElement(n.p,null,l.createElement(n.strong,null,"Acc√®s √† votre API via le browser")),"\n",l.createElement(n.p,null,"Soit ",l.createElement(n.strong,null,"Open app"),' via "Heroku dashboard", soit vous pouvez directement taper dans le browser : ',l.createElement(n.strong,null,"[your_app_name.herokuapp.com"),"."),"\n",l.createElement(n.h2,null,"Syst√®me de fichiers"),"\n",l.createElement(n.p,null,"‚ö° Sur Heroku, si vous utilisez des fichiers ",l.createElement(n.strong,null,".json"),' pour assurer une certaine "persistance" des ressources associ√©es √† vos API, ces fichiers seront probablement r√©initialis√©s environ une fois par jour.'),"\n",l.createElement(n.p,null,"En effet, Heroku utilise un syst√®me de fichiers √©ph√©m√®res, √† chaque fois qu'une dyno est red√©marr√©e, elle utilise une copie du d√©ploiement le plus r√©cent, c'est-√†-dire les fichiers qui ont √©t√© \"push\" sur heroku pour lancer le build."),"\n",l.createElement(n.p,null,"Si vous souhaitez faire persister de l'information sur Heroku pendant plus longtemps qu'une journ√©e, il faudra donc passer soit par une base de donn√©es, soit par des API offrant des op√©rations sur des fichiers (comme Amazon S3 par exemple)."),"\n",l.createElement(n.h1,null,l.createElement(i,null," D√©ploiement d'une API sur d'autres providers gratuits ")),"\n",l.createElement(n.p,null,"Voici une liste d'autres providers qui pourraient √™tre int√©ressants pour vos d√©ploiements :"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,l.createElement(n.a,{href:"https://platform.sh/pricing/"},"platform.sh")," : service gratuit pendant 30 jours, pas besoin de carte de cr√©dit."),"\n",l.createElement(n.li,null,l.createElement(n.a,{href:"https://cloud.google.com/pricing"},"Google Cloud")," : service offrant 300$ de cr√©dit, pendant 90 jours, il faut une carte de cr√©dit üò®, mais pas de charges sauf si upgrade manuel vers un compte payant."),"\n"),"\n",l.createElement(n.h1,null,l.createElement(i,null," D√©ploiement d'une base de donn√©es ")),"\n",l.createElement(n.h2,null,"Bases de donn√©es relationnelles"),"\n",l.createElement(n.p,null,"Si vous souhaitez utiliser une base de donn√©es relationnelle, n'h√©sitez pas √† utiliser un serveur Postgres."),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://www.elephantsql.com/"},"https://www.elephantsql.com/")," offre un service OK pour une base de donn√©es gratuite sur le cloud."),"\n",l.createElement(n.p,null,"Heroku offrait un servir Postgres int√©ressant, mais celui-ci ne sera plus, ou n'est plus, gratuit √† partir de novembre 2022 : ",l.createElement(n.a,{href:"https://www.heroku.com/postgres"},"https://www.heroku.com/postgres"),"."),"\n",l.createElement(n.h2,null,"Bases de donn√©es NoSQL"),"\n",l.createElement(n.p,null,"Si vous souhaitez faire du NoSQL, MongoDB Atlas fournit un service gratuit tr√®s int√©ressant sur le cloud : ",l.createElement(n.a,{href:"https://www.mongodb.com/"},"https://www.mongodb.com/"),", offrant 500 MB de stockage."),"\n",l.createElement(n.p,null,"Il existe un site extr√™mement bien fait, ",l.createElement(n.strong,null,"Full Stack open"),", qui vous explique comment utilser ce serveur : ",l.createElement(n.a,{href:"https://fullstackopen.com/en/part3"},"Fullstack Part 3"),"."),"\n",l.createElement(n.p,null,"‚ö° Attention, si vous avez des donn√©es qui sont fort connect√©es, faire le lien entre des documents et moins √©vident qu'avec du SQL (voir la notion d'",l.createElement(n.strong,null,"Aggregate")," sous Mongodb).\r\nSi vous utilisez une base de donn√©es, vous devriez prot√©ger vos secrets. Nous vous recommandons d'utiliser la librairie ",l.createElement(n.strong,null,"dotenv")," pour le faire.",l.createElement(n.br),"\n","Cela est expliqu√© sur le site de ",l.createElement(n.strong,null,"Fulls Stack open")," : ",l.createElement(n.a,{href:"https://fullstackopen.com/en/part3/saving_data_to_mongo_db"},"Saving data to MongoDB"),"."),"\n",l.createElement(n.h1,null,l.createElement(i,null," Exercice 3.1 : D√©ploiement de myMovies sur le cloud ")),"\n",l.createElement(n.p,null,"Tout est dit dans le titre üòâ."),"\n",l.createElement(n.p,null,"Pour le frontend, veuillez utiliser GitHub Pages."),"\n",l.createElement(n.p,null,"Pour le backend, si vous √™tres √©tudiant, inscrivez-vous sur Azure en tant que ",l.createElement(n.strong,null,"student")," pour obtenir vos 100$ de cr√©dit, sans carte de cr√©dit."),"\n",l.createElement(n.h4,null,"ü§ù Tips"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"Suivez bien les proc√©dures offertes dans ce cours."),"\n",l.createElement(n.li,null,"Pour votre frontend, celui-ci doit avoir √©t√© initialis√© sur base du boilerplate ",l.createElement(n.a,{href:"https://github.com/e-vinci/js-frontend-boilerplate"},"js-frontend-boilerplate"),".",l.createElement(n.br),"\n","Nous vous conseillons :","\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"de cr√©er un nouveau repo local en dehors de votre repo ",l.createElement(n.strong,null,"web2")," (pour √©viter d'avoir un Git dans le Git) en cl√¥nant ",l.createElement(n.a,{href:"https://github.com/e-vinci/js-frontend-boilerplate"},"js-frontend-boilerplate")," et en lui ajoutant tous les scripts que vous avez d√©velopp√© √† l'",l.createElement(n.strong,null,"Exercice 8.1"),"."),"\n",l.createElement(n.li,null,"de bien suivre la proc√©dure : ",l.createElement(n.a,{href:"#c2"},"c.2)  D√©ploiement d'un frontend sur GitHub Pages"),"."),"\n"),"\n"),"\n",l.createElement(n.li,null,"Pour votre API, n'oubliez pas d'ouvrir VS Code au niveau du code de votre API et suivez bien la proc√©dure : ",l.createElement(n.a,{href:"#c4"},"c.4) D√©ploiement d'une API sur Azure"),"."),"\n"))}var a=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,r.ah)(),e.components);return n?l.createElement(n,e,l.createElement(o,e)):o(e)};function u(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}var s=t(4854),i=t(5583),c=t(5679),m=t(307),p=t(7410),d=t(9523),E=t(8075),v=t(9063),g=t(1631),f=t(5772),h=t(2770),b=t(7008),P=t(9771),A=t(1218),z=(t(5258),t(9394)),q=t(4579),I=t(9416),S=t(9256),y=t(6488),w=t(5175),k=t(6387),L=t(6044);const j={Link:s.Link,Image:c.Z,Section:m.Z,Content:p.Z,Background:d.Z,SectionHeader:E.Z,SectionFooter:v.Z,PageHeader:g.Z,CodeBlock:h.Z,LinkFile:b.Z,ScrollableImage:P.Z,PublicProjectsView:A.Z,AuthenticatedBlock:z.Z,UnAuthenticatedBlock:q.Z,NestedMdxBlock:I.Z,YoutubeImage:S.Z,InternalPageMenu:y.Z,InternalPageMenuItem:w.Z,InternalPageTitle:k.Z,PathViewer:L.k,PathViewerItem:L.F};function x(e){var n,t,o,a,u;let{data:{mdx:s,allImages:c},children:m}=e;return j.PageHeader=(0,f.u)(g.Z,null==s?void 0:s.frontmatter),l.createElement(i.Z,Object.assign({},null!=s&&s.frontmatter?{frontmatter:s.frontmatter}:{},null!=s&&null!==(n=s.frontmatter)&&void 0!==n&&n.navbarExtraStyles?{navbarExtraStyles:s.frontmatter.navbarExtraStyles}:{},null!=s&&null!==(t=s.frontmatter)&&void 0!==t&&t.headerImage?{headerImage:s.frontmatter.headerImage}:{},null!=s&&null!==(o=s.frontmatter)&&void 0!==o&&o.featuredImage?{featuredImage:s.frontmatter.featuredImage}:{},null!=s&&null!==(a=s.frontmatter)&&void 0!==a&&a.title?{pageTitle:s.frontmatter.title}:{},c&&c.length>0?{allImages:c}:{}),l.createElement(r.Zo,{components:j},l.createElement("div",{className:null!=s&&null!==(u=s.frontmatter)&&void 0!==u&&u.autoMargin?"page page--auto-margin":"page"},m)))}function R(e){return l.createElement(x,e,l.createElement(a,e))}}}]);
//# sourceMappingURL=component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-3-index-fr-mdx-78a27bac07450898b68a.js.map